# Spirit Animal System

> Your Spirit Animal is your digital companion on MuscleMap - a unique creature that grows alongside you, reflects your progress, and showcases your achievements to the community.

## Overview

The Spirit Animal (formerly "mascot companion") is a central part of the MuscleMap experience. It's not just a cute pet - it's a visual representation of your fitness journey, economic status, and personal style. Users should feel pride in their Spirit Animal and want to invest in customizing it.

## Design Principles

1. **Uniqueness**: No two Spirit Animals should look exactly alike. The combination of species, stage, outfit, accessories, and earned cosmetics creates millions of possible combinations.

2. **Progress Reflection**: Your Spirit Animal visually evolves as you advance - both through earned achievements AND purchased customization.

3. **Social Status**: Other users can see your Spirit Animal on your profile, in crews, and in competitions. It communicates your dedication and status at a glance.

4. **Subtle Monetization**: Credits can be earned through workouts OR purchased ($1 = 100 credits). Cosmetics should be desirable but not predatory - no pay-to-win, just pay-to-personalize.

5. **Collectibility**: Limited edition, seasonal, and achievement-locked cosmetics create FOMO and collecting behavior.

## Spirit Animal Anatomy

```
┌─────────────────────────────────────────────────────────┐
│                    SPIRIT ANIMAL                        │
├─────────────────────────────────────────────────────────┤
│  Base Layer:                                            │
│  ├── Species (earned via archetype/journey)            │
│  ├── Stage (1-6, earned via XP)                        │
│  └── Base Color (default per species)                  │
│                                                         │
│  Customization Layers (purchasable):                   │
│  ├── Skin/Coat (recolors, patterns, textures)          │
│  ├── Eyes (colors, expressions, effects)               │
│  ├── Outfit (tops, bottoms, full sets)                 │
│  ├── Headwear (hats, helmets, halos, horns)            │
│  ├── Footwear (shoes, boots, sandals, claws)           │
│  ├── Accessories (necklaces, belts, tattoos)           │
│  ├── Aura (glow effects, particles, trails)            │
│  └── Badge Display (achievement badges, rank insignia) │
│                                                         │
│  Earned Layers (cannot be purchased):                  │
│  ├── Stage Evolution Visual                            │
│  ├── Achievement Trophies                              │
│  ├── Rank Insignia                                     │
│  ├── Wealth Tier Indicator                             │
│  └── Competition Medals                                │
└─────────────────────────────────────────────────────────┘
```

## Species System

Each archetype journey unlocks a different Spirit Animal species. Users can switch species by changing their active journey path (but retain cosmetics that are cross-species compatible).

| Archetype | Spirit Animal Species | Description |
|-----------|----------------------|-------------|
| Warrior | Phoenix | Fire and rebirth, strength through adversity |
| Builder | Golem | Earth and stone, steady construction of power |
| Guardian | Wolf | Pack loyalty, protection, endurance |
| Sage | Owl | Wisdom, precision, mind-body connection |
| Scout | Fox | Agility, speed, quick adaptation |
| Healer | Serpent | Restoration, flexibility, regeneration |
| Champion | Lion | Pride, leadership, competitive spirit |
| Nomad | Raven | Freedom, exploration, versatility |

## Stage Evolution (Earned - NOT Purchasable)

Spirit Animals visually evolve through 6 stages based on XP:

| Stage | XP Required | Visual Change | Abilities Unlocked |
|-------|-------------|---------------|-------------------|
| 1 | 0 | Baby/Cub form | Basic presence |
| 2 | 500 | Juvenile form | Voice unlocked |
| 3 | 2,000 | Adolescent form | Movement animations |
| 4 | 5,000 | Adult form | Full expressions |
| 5 | 10,000 | Mature form | Special effects |
| 6 | 25,000 | Legendary form | All features unlocked |

**Important**: Stage evolution CANNOT be purchased - it must be earned through consistent training.

## Cosmetic Categories

### 1. Skins/Coats (50-500 credits)
Base appearance modifications:
- **Solid Colors**: 50 credits (common colors)
- **Rare Colors**: 100 credits (uncommon hues)
- **Patterns**: 150 credits (stripes, spots, gradients)
- **Textures**: 250 credits (metallic, crystalline, ghostly)
- **Legendary Skins**: 500 credits (animated, particle effects)

### 2. Outfits (100-1000 credits)
Full-body or piece-by-piece customization:
- **Casual Wear**: 100-200 credits
- **Athletic Gear**: 150-300 credits
- **Formal Attire**: 200-400 credits
- **Fantasy Armor**: 300-600 credits
- **Themed Sets**: 500-1000 credits (complete matching outfits)

### 3. Headwear (50-400 credits)
- **Hats**: 50-150 credits
- **Helmets**: 150-300 credits
- **Crowns/Tiaras**: 200-400 credits (wealth status)
- **Halos/Horns**: 300-400 credits

### 4. Footwear (50-300 credits)
- **Sneakers**: 50-100 credits
- **Boots**: 100-200 credits
- **Sandals**: 75-150 credits
- **Special Effects**: 200-300 credits (flame trails, etc.)

### 5. Accessories (25-500 credits)
- **Necklaces**: 25-100 credits
- **Belts/Sashes**: 50-150 credits
- **Wings**: 200-400 credits
- **Capes**: 150-300 credits
- **Tattoos/Markings**: 100-250 credits

### 6. Auras (200-1000 credits)
Visual effects surrounding the Spirit Animal:
- **Glow Effects**: 200-400 credits
- **Particle Systems**: 400-700 credits
- **Animated Auras**: 700-1000 credits

### 7. Emotes/Animations (50-200 credits)
Custom animations and expressions:
- **Basic Emotes**: 50 credits (wave, dance, flex)
- **Complex Emotes**: 100 credits (celebrations, interactions)
- **Victory Poses**: 150 credits (shown after workouts)
- **Idle Animations**: 200 credits (special loops)

## Rarity Tiers

| Tier | Drop Rate | Visual Indicator | Credit Range |
|------|-----------|------------------|--------------|
| Common | 60% | Gray border | 25-100 |
| Uncommon | 25% | Green border | 100-250 |
| Rare | 10% | Blue border | 250-500 |
| Epic | 4% | Purple border | 500-1000 |
| Legendary | 1% | Gold border + sparkle | 1000-2500 |

## Limited Edition & Seasonal

### Seasonal Collections
Released quarterly, available for limited time:
- **Spring Collection**: Floral themes, pastels
- **Summer Collection**: Beach/tropical themes
- **Fall Collection**: Harvest themes, warm colors
- **Winter Collection**: Holiday themes, snow effects

### Event Exclusives
- **New Year**: Special particle effects
- **Valentine's**: Heart accessories
- **Halloween**: Spooky skins/costumes
- **Anniversary**: MuscleMap branded items

### Achievement Exclusives (NOT PURCHASABLE)
Earned through gameplay achievements:
- **1000 Workouts**: Diamond collar
- **Perfect Week**: Gold star badge
- **Rank Master**: Rank-specific insignia
- **Competition Champion**: Trophy accessory
- **Crew Leader**: Leadership crown

## Wealth Tier Integration

Your Spirit Animal automatically displays wealth indicators based on credit balance:

| Credits | Indicator | Visual |
|---------|-----------|--------|
| 0-99 | None | Base appearance |
| 100-999 | Bronze Ring | Subtle bronze glow |
| 1,000-9,999 | Silver Ring | Silver particle outline |
| 10,000-99,999 | Gold Ring | Gold aura effect |
| 100,000-999,999 | Platinum Double Ring | Platinum shimmer |
| 1,000,000+ | Obsidian Crown | Dark flame effects |

## Shop Structure

### Daily Rotating Shop
- 6 items rotate daily
- 1 guaranteed rare+ item
- Discount on 1 random item (20% off)

### Featured Section
- Weekly featured collection
- New releases
- Limited time bundles (15-25% discount on sets)

### Seasonal Shop
- Available during seasonal events
- Exclusive seasonal items
- Year-specific items (e.g., "2026 New Year Hat" - never returns)

### Credit Bundles (Soft Monetization)
Available for purchase:
- 100 credits: $0.99
- 500 credits: $4.49 (10% bonus)
- 1,000 credits: $7.99 (25% bonus)
- 2,500 credits: $17.99 (40% bonus)
- 5,000 credits: $29.99 (65% bonus)

**Note**: Credits are primarily earned through workouts. Purchased credits have the same value as earned credits with no distinction.

## Screenshot & Sharing

### Photo Mode
Users can take screenshots of their Spirit Animal:
- Pose selection (from owned emotes)
- Background selection (unlockable backgrounds)
- Lighting presets
- Caption overlay
- Direct share to social media

### Profile Display
- Spirit Animal appears on user profile
- Visitors see equipped cosmetics
- Hover shows cosmetic item names
- "Inspect" mode shows all equipped items

### Crew Displays
- Spirit Animals appear in crew group photos
- Crew competitions show Spirit Animal line-ups
- Crew banners feature Spirit Animals

## Database Schema

```sql
-- Spirit Animal cosmetic items catalog
CREATE TABLE spirit_animal_cosmetics (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  item_key VARCHAR(100) UNIQUE NOT NULL,
  name VARCHAR(200) NOT NULL,
  description TEXT,
  category VARCHAR(50) NOT NULL, -- skin, outfit, headwear, footwear, accessory, aura, emote
  slot VARCHAR(50), -- specific slot within category
  rarity VARCHAR(20) NOT NULL DEFAULT 'common',
  base_price INTEGER NOT NULL,
  species_locked TEXT[], -- NULL = all species, array = specific species only
  stage_required INTEGER DEFAULT 1,
  is_purchasable BOOLEAN DEFAULT TRUE,
  is_tradeable BOOLEAN DEFAULT FALSE,
  achievement_required TEXT, -- achievement ID if earned-only
  season VARCHAR(50), -- NULL = permanent, or season identifier
  release_date DATE,
  retirement_date DATE, -- NULL = permanent
  preview_url TEXT,
  asset_url TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- User-owned cosmetics
CREATE TABLE user_spirit_cosmetics (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id TEXT NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  cosmetic_id UUID NOT NULL REFERENCES spirit_animal_cosmetics(id),
  acquired_at TIMESTAMPTZ DEFAULT NOW(),
  acquisition_method VARCHAR(50) NOT NULL, -- purchase, achievement, gift, event
  credits_spent INTEGER DEFAULT 0,
  is_favorite BOOLEAN DEFAULT FALSE,
  UNIQUE(user_id, cosmetic_id)
);

-- Currently equipped cosmetics (replaces simple equipped_cosmetics JSONB)
CREATE TABLE user_spirit_loadout (
  user_id TEXT PRIMARY KEY REFERENCES users(id) ON DELETE CASCADE,
  skin_id UUID REFERENCES spirit_animal_cosmetics(id),
  eyes_id UUID REFERENCES spirit_animal_cosmetics(id),
  outfit_id UUID REFERENCES spirit_animal_cosmetics(id),
  headwear_id UUID REFERENCES spirit_animal_cosmetics(id),
  footwear_id UUID REFERENCES spirit_animal_cosmetics(id),
  accessory_1_id UUID REFERENCES spirit_animal_cosmetics(id),
  accessory_2_id UUID REFERENCES spirit_animal_cosmetics(id),
  accessory_3_id UUID REFERENCES spirit_animal_cosmetics(id),
  aura_id UUID REFERENCES spirit_animal_cosmetics(id),
  emote_victory_id UUID REFERENCES spirit_animal_cosmetics(id),
  emote_idle_id UUID REFERENCES spirit_animal_cosmetics(id),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Shop rotation tracking
CREATE TABLE spirit_shop_rotation (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  rotation_date DATE NOT NULL,
  slot_number INTEGER NOT NULL,
  cosmetic_id UUID NOT NULL REFERENCES spirit_animal_cosmetics(id),
  discount_percent INTEGER DEFAULT 0,
  UNIQUE(rotation_date, slot_number)
);

-- Purchase history for analytics
CREATE TABLE spirit_cosmetic_purchases (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id TEXT NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  cosmetic_id UUID NOT NULL REFERENCES spirit_animal_cosmetics(id),
  credits_spent INTEGER NOT NULL,
  was_discounted BOOLEAN DEFAULT FALSE,
  discount_percent INTEGER DEFAULT 0,
  purchased_at TIMESTAMPTZ DEFAULT NOW()
);

-- Saved outfits/presets
CREATE TABLE user_spirit_presets (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id TEXT NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  preset_name VARCHAR(50) NOT NULL,
  loadout JSONB NOT NULL, -- snapshot of equipped items
  created_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(user_id, preset_name)
);

-- Indexes
CREATE INDEX idx_spirit_cosmetics_category ON spirit_animal_cosmetics(category, rarity);
CREATE INDEX idx_spirit_cosmetics_species ON spirit_animal_cosmetics USING GIN(species_locked);
CREATE INDEX idx_user_spirit_cosmetics_user ON user_spirit_cosmetics(user_id);
CREATE INDEX idx_spirit_shop_date ON spirit_shop_rotation(rotation_date);
```

## API Endpoints

```
# Shop & Catalog
GET  /spirit-animal/shop/today          # Get today's rotating shop
GET  /spirit-animal/shop/featured       # Get featured items
GET  /spirit-animal/catalog             # Browse all cosmetics (with filters)
GET  /spirit-animal/catalog/:id         # Get specific cosmetic details

# User's Collection
GET  /spirit-animal/collection          # Get user's owned cosmetics
GET  /spirit-animal/loadout             # Get current equipped items
POST /spirit-animal/loadout             # Update equipped items
GET  /spirit-animal/presets             # Get saved outfit presets
POST /spirit-animal/presets             # Save new preset
DELETE /spirit-animal/presets/:id       # Delete preset

# Purchasing
POST /spirit-animal/purchase/:id        # Purchase a cosmetic
POST /spirit-animal/gift/:userId/:id    # Gift cosmetic to another user

# Social
GET  /spirit-animal/showcase/:userId    # View another user's Spirit Animal
POST /spirit-animal/screenshot          # Generate shareable screenshot
```

## Credit Earning Methods

To maintain the economy and avoid forcing purchases:

| Activity | Credits Earned |
|----------|---------------|
| Complete workout | 5-25 (based on intensity) |
| Daily login | 5 |
| Weekly streak | 50 |
| Monthly streak | 250 |
| Achievement unlocked | 10-100 |
| PR set | 15 |
| Competition win | 50-200 |
| Crew challenge | 25-100 |
| Refer a friend | 500 |
| High-five streak | 5/day max |

Average active user earns: ~500-1000 credits/month through gameplay.

## Implementation Phases

### Phase 1: Foundation
- [ ] Database schema migration
- [ ] Basic cosmetic catalog with 50+ items
- [ ] Purchase/equip functionality
- [ ] API endpoints

### Phase 2: Shop System
- [ ] Daily rotating shop
- [ ] Featured section
- [ ] Purchase flow with credits
- [ ] Gift system

### Phase 3: Social Features
- [ ] Profile Spirit Animal display
- [ ] Screenshot/photo mode
- [ ] Sharing to social media

### Phase 4: Economy Integration
- [ ] Credit bundle purchases (monetization)
- [ ] Seasonal events
- [ ] Limited edition releases

### Phase 5: Advanced Features
- [ ] Trading system (optional)
- [ ] Crew cosmetics
- [ ] Competition rewards
