import{r as a,j as e,L as C}from"./react-vendor-By4WaTeA.js";import{G as k}from"./index-BWXbdiCA.js";import"./leaflet-vendor-BAre9uld.js";import"./three-vendor-BoD47aQL.js";import"./reactflow-vendor-DlchWpwj.js";import"./recharts-vendor-BBD0wQvA.js";import"./apollo-vendor-CCbilRAb.js";function G(){const{token:h}=k(),[o,u]=a.useState("active"),[p,g]=a.useState([]),[y,b]=a.useState([]),[j,x]=a.useState(!0),[N,c]=a.useState(!1),[t,i]=a.useState({name:"",description:"",type:"weekly",goal_tu:100}),r={"Content-Type":"application/json",Authorization:"Bearer "+h};a.useEffect(()=>{d()},[o]);const d=async()=>{x(!0);try{const[s,l]=await Promise.all([fetch("/api/competitions?status="+o,{headers:r}).then(n=>n.json()),fetch("/api/competitions/my-entries",{headers:r}).then(n=>n.json())]);g(s.competitions||[]),b(l.entries||[])}catch{}x(!1)},f=async s=>{await fetch("/api/competitions/"+s+"/join",{method:"POST",headers:r}),d()},v=async()=>{if(!t.name)return alert("Name required");await fetch("/api/competitions",{method:"POST",headers:r,body:JSON.stringify(t)}),c(!1),i({name:"",description:"",type:"weekly",goal_tu:100}),d()},w=s=>({weekly:"ðŸ“…",monthly:"ðŸ—“ï¸",challenge:"âš”ï¸",championship:"ðŸ†"})[s]||"ðŸŽ¯",m=s=>y.some(l=>l.competition_id===s);return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white pb-24",children:[e.jsx("header",{className:"bg-gray-800 p-4 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[e.jsx(C,{to:"/community",className:"text-blue-400",children:"â† Back"}),e.jsx("h1",{className:"text-xl font-bold",children:"ðŸ† Competitions"}),e.jsx("button",{onClick:()=>c(!0),className:"bg-green-600 px-3 py-1 rounded text-sm",children:"+ New"})]})}),e.jsxs("main",{className:"max-w-4xl mx-auto p-4",children:[e.jsx("div",{className:"flex gap-2 mb-6",children:["active","upcoming","completed"].map(s=>e.jsx("button",{onClick:()=>u(s),className:"flex-1 py-2 rounded-full capitalize text-sm "+(o===s?"bg-purple-600":"bg-gray-700"),children:s},s))}),j?e.jsx("div",{className:"text-center py-8 animate-pulse",children:"Loading..."}):p.length===0?e.jsxs("div",{className:"text-center text-gray-400 py-8",children:["No ",o," competitions. Create one!"]}):e.jsx("div",{className:"space-y-4",children:p.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("span",{className:"text-3xl",children:w(s.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold",children:s.name}),e.jsx("div",{className:"text-sm text-gray-400",children:s.description})]}),e.jsx("span",{className:"px-2 py-1 rounded text-xs "+(s.status==="active"?"bg-green-600":"bg-gray-600"),children:s.status})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3 text-center text-sm",children:[e.jsxs("div",{className:"bg-gray-700 p-2 rounded",children:[e.jsx("div",{className:"font-bold",children:s.participant_count||0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Players"})]}),e.jsxs("div",{className:"bg-gray-700 p-2 rounded",children:[e.jsxs("div",{className:"font-bold",children:[s.goal_tu," TU"]}),e.jsx("div",{className:"text-xs text-gray-400",children:"Goal"})]}),e.jsxs("div",{className:"bg-gray-700 p-2 rounded",children:[e.jsx("div",{className:"font-bold capitalize",children:s.type}),e.jsx("div",{className:"text-xs text-gray-400",children:"Type"})]})]}),s.leaderboard?.length>0&&e.jsx("div",{className:"border-t border-gray-700 pt-3 mb-3",children:s.leaderboard.slice(0,3).map((l,n)=>e.jsxs("div",{className:"flex justify-between text-sm py-1",children:[e.jsxs("span",{children:[["ðŸ¥‡","ðŸ¥ˆ","ðŸ¥‰"][n]," ",l.username]}),e.jsxs("span",{className:"text-yellow-400",children:[Math.round(l.tu_earned)," TU"]})]},n))}),e.jsx("button",{onClick:()=>f(s.id),disabled:m(s.id),className:"w-full py-2 rounded-xl font-bold transition-all "+(m(s.id)?"bg-gray-600 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700"),children:m(s.id)?"âœ“ Joined":"âš”ï¸ Join Competition"})]},s.id))})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Create Competition"}),e.jsx("input",{placeholder:"Competition Name",value:t.name,onChange:s=>i({...t,name:s.target.value}),className:"w-full bg-gray-700 p-3 rounded-xl mb-3"}),e.jsx("textarea",{placeholder:"Description",value:t.description,onChange:s=>i({...t,description:s.target.value}),className:"w-full bg-gray-700 p-3 rounded-xl mb-3 h-20"}),e.jsxs("select",{value:t.type,onChange:s=>i({...t,type:s.target.value}),className:"w-full bg-gray-700 p-3 rounded-xl mb-3",children:[e.jsx("option",{value:"weekly",children:"ðŸ“… Weekly"}),e.jsx("option",{value:"monthly",children:"ðŸ—“ï¸ Monthly"}),e.jsx("option",{value:"challenge",children:"âš”ï¸ Challenge"}),e.jsx("option",{value:"championship",children:"ðŸ† Championship"})]}),e.jsx("input",{type:"number",placeholder:"Goal TU",value:t.goal_tu,onChange:s=>i({...t,goal_tu:Number(s.target.value)}),className:"w-full bg-gray-700 p-3 rounded-xl mb-4"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>c(!1),className:"flex-1 bg-gray-600 py-3 rounded-xl",children:"Cancel"}),e.jsx("button",{onClick:v,className:"flex-1 bg-green-600 py-3 rounded-xl font-bold",children:"Create"})]})]})})]})}export{G as default};
