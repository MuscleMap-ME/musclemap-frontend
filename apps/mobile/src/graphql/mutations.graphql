# ============================================================================
# Authentication Mutations
# ============================================================================

mutation Login($input: LoginInput!) {
  login(input: $input) {
    token
    user {
      id
      username
      email
      displayName
      avatar
      level
      xp
      wealthTier {
        tier
        name
        color
        icon
        progressPercent
      }
      createdAt
      roles
    }
  }
}

mutation Register($input: RegisterInput!) {
  register(input: $input) {
    token
    user {
      id
      username
      email
      displayName
      avatar
      level
      xp
      wealthTier {
        tier
        name
        color
        icon
      }
      createdAt
      roles
    }
  }
}

mutation ChangePassword($input: ChangePasswordInput!) {
  changePassword(input: $input) {
    success
    message
  }
}

mutation RequestPasswordReset($email: String!) {
  requestPasswordReset(email: $email) {
    success
    message
  }
}

mutation ResetPassword($input: ResetPasswordInput!) {
  resetPassword(input: $input) {
    success
    message
  }
}

# ============================================================================
# Profile Mutations
# ============================================================================

mutation UpdateProfile($input: ProfileInput!) {
  updateProfile(input: $input) {
    id
    userId
    displayName
    bio
    avatar
    location
    website
    socialLinks
    fitnessGoals
    preferredWorkoutTime
    experienceLevel
    visibility
    wealthTier {
      tier
      name
      color
      icon
    }
    updatedAt
  }
}

mutation UpdateMyFullProfile($input: FullProfileInput!) {
  updateMyFullProfile(input: $input) {
    id
    username
    displayName
    avatarUrl
    avatarId
    xp
    level
    rank
    wealthTier
    age
    gender
    heightCm
    weightKg
    preferredUnits
    ghostMode
    leaderboardOptIn
    aboutMe
    theme
  }
}

# ============================================================================
# Workout Session Mutations (Real-time logging)
# ============================================================================

mutation StartWorkoutSession($input: StartWorkoutSessionInput) {
  startWorkoutSession(input: $input) {
    session {
      id
      userId
      startedAt
      currentExerciseIndex
      currentSetIndex
      sets {
        id
        exerciseId
        exerciseName
        setNumber
        weightKg
        reps
        rpe
        isPRWeight
        isPRReps
        isPR1RM
        performedAt
      }
      totalVolume
      totalReps
      clientVersion
      serverVersion
    }
  }
}

mutation LogSet($input: LogSetInput!) {
  logSet(input: $input) {
    session {
      id
      currentExerciseIndex
      currentSetIndex
      sets {
        id
        exerciseId
        exerciseName
        setNumber
        weightKg
        reps
        rpe
        durationSeconds
        notes
        isPRWeight
        isPRReps
        isPR1RM
        performedAt
      }
      totalVolume
      totalReps
      estimatedCalories
      musclesWorked {
        muscleId
        muscleName
        totalTU
        setCount
      }
      sessionPRs {
        exerciseId
        exerciseName
        prType
        newValue
        previousValue
      }
      clientVersion
      serverVersion
    }
    setLogged {
      id
      exerciseId
      exerciseName
      setNumber
      weightKg
      reps
      rpe
      isPRWeight
      isPRReps
      performedAt
    }
  }
}

mutation UpdateSet($input: UpdateSetInput!) {
  updateSet(input: $input) {
    id
    exerciseId
    exerciseName
    setNumber
    weightKg
    reps
    rpe
    durationSeconds
    notes
    isPRWeight
    isPRReps
    isPR1RM
    performedAt
  }
}

mutation DeleteSet($setId: ID!) {
  deleteSet(setId: $setId)
}

mutation PauseWorkoutSession($sessionId: ID!) {
  pauseWorkoutSession(sessionId: $sessionId) {
    id
    pausedAt
    totalPausedTime
    clientVersion
    serverVersion
  }
}

mutation ResumeWorkoutSession($sessionId: ID!) {
  resumeWorkoutSession(sessionId: $sessionId) {
    id
    pausedAt
    totalPausedTime
    lastActivityAt
    clientVersion
    serverVersion
  }
}

mutation UpdateRestTimer($sessionId: ID!, $remaining: Int!, $total: Int!) {
  updateRestTimer(sessionId: $sessionId, remaining: $remaining, total: $total) {
    id
    restTimerRemaining
    restTimerTotalDuration
    restTimerStartedAt
  }
}

mutation CompleteWorkoutSession($input: CompleteWorkoutSessionInput!) {
  completeWorkoutSession(input: $input) {
    workout {
      id
      userId
      exercises {
        exerciseId
        name
        sets
        reps
        weight
        notes
      }
      duration
      notes
      totalTU
      createdAt
    }
    session {
      id
      totalVolume
      totalReps
      estimatedCalories
    }
    totalTU
    totalVolume
    totalSets
    totalReps
    duration
    muscleBreakdown {
      muscleId
      muscleName
      totalTU
      setCount
    }
    prsAchieved {
      exerciseId
      exerciseName
      prType
      newValue
      previousValue
    }
    creditsCharged
    xpEarned
    levelUp
    achievements {
      id
      name
      description
      icon
      rarity
      unlockedAt
    }
  }
}

mutation AbandonWorkoutSession($sessionId: ID!, $reason: String) {
  abandonWorkoutSession(sessionId: $sessionId, reason: $reason)
}

mutation RecoverWorkoutSession($archivedSessionId: ID!) {
  recoverWorkoutSession(archivedSessionId: $archivedSessionId) {
    id
    userId
    startedAt
    sets {
      id
      exerciseId
      exerciseName
      setNumber
      weightKg
      reps
      rpe
      isPRWeight
      isPRReps
      performedAt
    }
    totalVolume
    totalReps
    clientVersion
    serverVersion
  }
}

# ============================================================================
# Goals Mutations
# ============================================================================

mutation CreateGoal($input: GoalInput!) {
  createGoal(input: $input) {
    id
    userId
    type
    target
    current
    unit
    title
    description
    status
    deadline
    milestones {
      id
      goalId
      title
      target
      achieved
      achievedAt
    }
    createdAt
  }
}

mutation UpdateGoal($id: ID!, $input: GoalInput!) {
  updateGoal(id: $id, input: $input) {
    id
    userId
    type
    target
    current
    unit
    title
    description
    status
    deadline
    milestones {
      id
      goalId
      title
      target
      achieved
      achievedAt
    }
    updatedAt
  }
}

mutation DeleteGoal($id: ID!) {
  deleteGoal(id: $id)
}

mutation RecordGoalProgress($id: ID!, $input: GoalProgressInput!) {
  recordGoalProgress(id: $id, input: $input) {
    id
    current
    status
    milestones {
      id
      achieved
      achievedAt
    }
    updatedAt
  }
}

# ============================================================================
# Archetype & Character Mutations
# ============================================================================

mutation SelectArchetype($archetypeId: ID!) {
  selectArchetype(archetypeId: $archetypeId) {
    success
    archetype {
      id
      name
      description
      icon
    }
    journey {
      userId
      currentLevel
      currentXP
      xpToNextLevel
      totalXP
      completedMilestones
      unlockedAbilities
    }
  }
}

mutation RecalculateStats {
  recalculateStats {
    userId
    level
    xp
    xpToNextLevel
    strength
    endurance
    agility
    flexibility
    balance
    mentalFocus
    totalWorkouts
    totalExercises
    currentStreak
    longestStreak
    lastWorkoutAt
  }
}

# ============================================================================
# Economy Mutations
# ============================================================================

mutation ChargeCredits($input: ChargeInput!) {
  chargeCredits(input: $input) {
    success
    newBalance
    transaction {
      id
      type
      amount
      description
      createdAt
      metadata
    }
  }
}

mutation SendHighFive($input: HighFiveInput!) {
  sendHighFive(input: $input) {
    success
    error
  }
}

# ============================================================================
# Messaging Mutations
# ============================================================================

mutation CreateConversation($type: String!, $participantIds: [ID!]!) {
  createConversation(type: $type, participantIds: $participantIds) {
    id
    type
    name
    participants {
      userId
      username
      displayName
      avatarUrl
      role
    }
    createdAt
    updatedAt
  }
}

mutation SendMessage($conversationId: ID!, $content: String!, $replyToId: ID) {
  sendMessage(conversationId: $conversationId, content: $content, replyToId: $replyToId) {
    id
    conversationId
    senderId
    senderUsername
    senderDisplayName
    content
    contentType
    replyTo {
      id
      content
      senderName
    }
    createdAt
    editedAt
  }
}

mutation MarkConversationRead($conversationId: ID!) {
  markConversationRead(conversationId: $conversationId)
}

# ============================================================================
# Presence Mutations
# ============================================================================

mutation UpdatePresence($status: String!) {
  updatePresence(status: $status) {
    online
    lastSeen
    status
  }
}
