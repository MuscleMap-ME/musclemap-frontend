import{r,j as e}from"./react-vendor-D1NxaRNd.js";import{e as P,i as l,A as $,m as w}from"./index-IJRH5ohh.js";import{G as U,a as m}from"./GlassSurface-BMiMerMg.js";import{G as u}from"./GlassButton-Coh6hkV7.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./apollo-vendor-BMQ75Ycx.js";import"./reactflow-vendor-Dz2P_-Qa.js";import"./d3-vendor-mcDw60ct.js";import"./recharts-vendor-BziRPEEi.js";const n={Swords:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})}),Trophy:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),Search:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),UserPlus:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),Check:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 13l4 4L19 7"})}),X:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})}),TrendingUp:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),TrendingDown:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"})}),Minus:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 12H4"})}),Zap:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 10V3L4 14h7v7l9-11h-7z"})})};function _(){const{user:t}=P(),[f,T]=r.useState([]),[g,A]=r.useState([]),[p,M]=r.useState(null),[R,W]=r.useState(!0),[k,o]=r.useState(null),[j,L]=r.useState(!1),[d,N]=r.useState(""),[y,x]=r.useState([]),[C,S]=r.useState(!1),h=r.useCallback(async()=>{try{o(null);const[s,a,i]=await Promise.all([l.get("/rivals?status=active"),l.get("/rivals/pending"),l.get("/rivals/stats")]),v=s.data?.data||s.data||{},c=a.data?.data||a.data||[],F=i.data?.data||i.data||{};T(v.rivals||[]),A(Array.isArray(c)?c:[]),M(F)}catch(s){o(s.message||"Failed to load rivals data")}finally{W(!1)}},[]);r.useEffect(()=>{h()},[h]);const b=r.useCallback(async s=>{if(s.length<2){x([]);return}S(!0);try{const a=await l.get(`/rivals/search?q=${encodeURIComponent(s)}`),i=a.data?.data||a.data||[];x(Array.isArray(i)?i:[])}catch{}finally{S(!1)}},[]);r.useEffect(()=>{const s=setTimeout(()=>{b(d)},300);return()=>clearTimeout(s)},[d,b]);const B=async s=>{x(a=>Array.isArray(a)?a.filter(i=>i.id!==s):[]);try{await l.post("/rivals/challenge",{opponentId:s}),N(""),x([]),L(!1),h()}catch(a){o(a.message||"Failed to send challenge"),d.length>=2&&b(d)}},z=async s=>{try{await l.post(`/rivals/${s}/accept`),h()}catch(a){o(a.message||"Failed to accept rivalry")}},E=async s=>{try{await l.post(`/rivals/${s}/decline`),h()}catch(a){o(a.message||"Failed to decline rivalry")}},D=async s=>{if(window.confirm("Are you sure you want to end this rivalry?"))try{await l.post(`/rivals/${s}/end`),h()}catch(a){o(a.message||"Failed to end rivalry")}};return R?e.jsx("div",{className:"min-h-screen bg-[#0a0a0f]",children:e.jsx(U,{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-2 border-violet-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white/60",children:"Loading rivals..."})]})})}):e.jsx("div",{className:"min-h-screen bg-[#0a0a0f]",children:e.jsx(U,{className:"min-h-screen p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Rivals"}),e.jsx("p",{className:"text-white/60",children:"1v1 competition to push your limits"})]}),k&&e.jsxs("div",{className:"bg-red-500/20 border border-red-500/50 rounded-xl p-4 text-red-400 flex justify-between items-center",children:[e.jsx("span",{children:k}),e.jsx("button",{onClick:()=>o(null),className:"text-red-400 hover:text-red-300",children:e.jsx(n.X,{className:"w-5 h-5"})})]}),p&&e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex justify-around text-center",children:[e.jsxs("div",{children:[e.jsx(n.Trophy,{className:"w-8 h-8 text-yellow-400 mx-auto mb-2"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:p.wins||0}),e.jsx("div",{className:"text-white/50 text-sm",children:"Wins"})]}),e.jsxs("div",{children:[e.jsx(n.Swords,{className:"w-8 h-8 text-blue-400 mx-auto mb-2"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:p.activeRivals||0}),e.jsx("div",{className:"text-white/50 text-sm",children:"Active"})]}),e.jsxs("div",{children:[e.jsx(n.Zap,{className:"w-8 h-8 text-orange-400 mx-auto mb-2"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:(p.totalTUEarned||0).toLocaleString()}),e.jsx("div",{className:"text-white/50 text-sm",children:"TU Earned"})]})]})}),e.jsxs(m,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Find Rivals"}),e.jsxs(u,{onClick:()=>{L(!j),N(""),x([])},size:"sm",className:"flex items-center gap-2",children:[j?e.jsx(n.X,{className:"w-4 h-4"}):e.jsx(n.Search,{className:"w-4 h-4"}),j?"Close":"Search"]})]}),e.jsx($,{children:j&&e.jsxs(w.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:[e.jsx("input",{type:"text",value:d,onChange:s=>N(s.target.value),placeholder:"Search by username...",className:"w-full bg-white/10 text-white rounded-lg px-4 py-2 border border-white/10 focus:border-violet-500 outline-none mb-4",autoFocus:!0}),C&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"w-6 h-6 border-2 border-violet-500 border-t-transparent rounded-full animate-spin"})}),e.jsxs("div",{className:"space-y-2",children:[(Array.isArray(y)?y:[]).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5 hover:bg-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold",children:s.username?.charAt(0).toUpperCase()||"?"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:s.username}),s.archetype&&e.jsx("div",{className:"text-white/50 text-sm",children:s.archetype})]})]}),e.jsxs(u,{onClick:()=>B(s.id),size:"sm",className:"flex items-center gap-2",children:[e.jsx(n.UserPlus,{className:"w-4 h-4"}),"Challenge"]})]},s.id)),d.length>=2&&y.length===0&&!C&&e.jsx("p",{className:"text-white/50 text-center py-4",children:"No users found"})]})]})})]}),Array.isArray(g)&&g.length>0&&e.jsxs(m,{className:"p-6 border border-yellow-500/30",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Pending Requests"}),e.jsx("div",{className:"space-y-3",children:g.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold",children:s.opponent?.username?.charAt(0).toUpperCase()||"?"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:s.opponent?.username}),e.jsx("div",{className:"text-white/50 text-sm",children:s.isChallenger?"Waiting for response":"Wants to compete"})]})]}),!s.isChallenger&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{onClick:()=>z(s.id),size:"sm",className:"bg-green-500/20 hover:bg-green-500/30 border-green-500/50",children:e.jsx(n.Check,{className:"w-4 h-4"})}),e.jsx(u,{onClick:()=>E(s.id),size:"sm",className:"bg-red-500/20 hover:bg-red-500/30 border-red-500/50",children:e.jsx(n.X,{className:"w-4 h-4"})})]})]},s.id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Active Rivalries"}),!Array.isArray(f)||f.length===0?e.jsxs(m,{className:"p-8 text-center",children:[e.jsx(n.Swords,{className:"w-12 h-12 text-white/30 mx-auto mb-4"}),e.jsxs("p",{className:"text-white/50",children:["No active rivalries yet.",e.jsx("br",{}),"Challenge someone to compete!"]})]}):f.map(s=>{const a=(s.myTU||0)+(s.opponentTU||0),i=a>0?s.myTU/a*100:50,v=s.myTU>s.opponentTU,c=s.myTU-s.opponentTU;return e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsxs(m,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:s.opponent?.username?.charAt(0).toUpperCase()||"?"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-bold text-lg",children:s.opponent?.username}),e.jsx("div",{className:"text-white/50 text-sm",children:"vs You"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[v?e.jsx(n.TrendingUp,{className:"w-5 h-5 text-green-400"}):c<0?e.jsx(n.TrendingDown,{className:"w-5 h-5 text-red-400"}):e.jsx(n.Minus,{className:"w-5 h-5 text-white/50"}),e.jsxs("span",{className:`font-bold text-lg ${v?"text-green-400":c<0?"text-red-400":"text-white/50"}`,children:[c>0?"+":"",c," TU"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsxs("span",{className:"text-blue-400",children:["You: ",(s.myTU||0).toLocaleString()," TU"]}),e.jsxs("span",{className:"text-red-400",children:[s.opponent?.username,": ",(s.opponentTU||0).toLocaleString()," TU"]})]}),e.jsxs("div",{className:"h-3 flex rounded-full overflow-hidden",children:[e.jsx(w.div,{className:"bg-blue-500",initial:{width:"50%"},animate:{width:`${i}%`},transition:{duration:.5}}),e.jsx(w.div,{className:"bg-red-500",initial:{width:"50%"},animate:{width:`${100-i}%`},transition:{duration:.5}})]})]}),e.jsx(u,{onClick:()=>D(s.id),className:"w-full bg-red-500/20 hover:bg-red-500/30 border-red-500/50 text-red-400",children:"End Rivalry"})]})},s.id)})]})]})})})}export{_ as default};
