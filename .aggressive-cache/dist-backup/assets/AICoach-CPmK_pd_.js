import{j as e,r as o}from"./react-vendor-D847gc3Q.js";import{c}from"./recharts-vendor-CxtoZpzE.js";import{m,A as se}from"./index-KAEVVvQC.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./d3-vendor-mcDw60ct.js";import"./apollo-vendor-BNHFeEEc.js";import"./reactflow-vendor-CYb5nRwM.js";function X(){const t=new Date().getHours();return t<5?"late":t<12?"morning":t<17?"afternoon":t<21?"evening":"night"}function J(t="Athlete",s=X()){const r={morning:[`Good morning, ${t}! Ready to crush it today?`,`Rise and grind, ${t}! Early bird gets the gains.`,`Morning, ${t}! Your muscles missed you. Let's wake them up.`],afternoon:[`Good afternoon, ${t}! Perfect time for a workout.`,`Hey ${t}! Taking a break? Let's make it productive.`,`Afternoon, ${t}! The gym is calling your name.`],evening:[`Good evening, ${t}! Time to destress with some lifts?`,`Hey ${t}! Evening workouts hit different.`,`Evening, ${t}! Let's end the day strong.`],night:[`Late night session, ${t}? I respect the dedication.`,`Burning the midnight oil, ${t}? Let's plan tomorrow's gains.`,`Night owl workout? I'm here for it, ${t}.`],late:[`${t}! Burning the late-night oil? Remember, rest is part of the gains.`,`Still up, ${t}? Let's plan an epic workout for when you're rested.`]},a=r[s]||r.afternoon;return a[Math.floor(Math.random()*a.length)]}const $=["The pain you feel today will be the strength you feel tomorrow.","Your body can stand almost anything. It's your mind you have to convince.","Success starts with self-discipline.","Don't count the days, make the days count.","The only bad workout is the one that didn't happen.","You don't have to be great to start, but you have to start to be great.","Every champion was once a contender who refused to give up.","Strive for progress, not perfection.","The harder you work, the luckier you get.","Discipline is choosing between what you want now and what you want most.","Your only limit is you.","Winners train, losers complain.","If it doesn't challenge you, it won't change you.","The difference between try and triumph is a little umph.","Fall seven times, stand up eight.","Success isn't owned. It's rented, and rent is due every day.","Train insane or remain the same.","What seems impossible today will become your warm-up tomorrow.","Sweat is just fat crying.","No excuses. Just results."],K={push:["Bench press: Keep your shoulder blades pinched together and drive through your heels.","Push-ups: Engage your core and keep a straight line from head to heels.","Overhead press: Brace your core tight - think of it as a standing plank.","Dips: Lean slightly forward for chest focus, stay upright for triceps."],pull:["Deadlift: Keep the bar close to your body - it should scrape your shins.","Pull-ups: Initiate with your lats, not your arms. Imagine pulling your elbows down.","Rows: Squeeze your shoulder blades together at the top of each rep.","Lat pulldown: Pull to your chest, not behind your neck."],legs:["Squats: Push your knees out over your toes and keep your chest up.","Lunges: Take big steps - your front knee should track over your ankle.","Romanian deadlifts: Feel the stretch in your hamstrings by pushing your hips back.","Leg press: Don't lock out your knees at the top."],core:["Planks: Don't let your hips sag or pike up. Neutral spine always.","Crunches: Think about bringing your ribs to your hips, not just lifting your head.","Dead bugs: Press your lower back into the floor throughout the movement.","Russian twists: Keep your chest lifted and rotate from your core, not arms."],general:["Breathe out during the effort (concentric), breathe in during the return (eccentric).","Control the weight - if you're bouncing or swinging, it's too heavy.","Full range of motion > heavy weight with partial reps.","Mind-muscle connection: visualize the target muscle working.","Rest 60-90 seconds between sets for hypertrophy, 3-5 minutes for strength."]},q=["Consider adding 5-10 minutes of stretching after your workout for better recovery.","Sleep is when the magic happens - aim for 7-9 hours for optimal muscle recovery.","Foam rolling can help reduce muscle soreness and improve mobility.","Active recovery like walking or light swimming can speed up recovery between sessions.","Stay hydrated! Aim for at least half your body weight (lbs) in ounces of water.","Consider contrast showers (alternating hot/cold) to boost recovery.","Protein within 30-60 minutes post-workout helps maximize muscle protein synthesis.","Taking a rest day isn't weakness - it's when your muscles actually grow.","Stressed out? Cortisol can hurt your gains. Try meditation or deep breathing.","Massage or self-myofascial release can help break up muscle adhesions."],F={morning:["Morning workouts boost metabolism all day. How about some compound movements?","High-energy morning? Perfect for leg day - burn those calories early!","Start your day with some dynamic stretching and a push workout."],afternoon:["Afternoon is peak strength time for most people. Hit those heavy lifts!","Perfect time for a full-body workout to break up your day.","Consider a HIIT session - you've got the energy mid-day."],evening:["Evening workouts help destress. How about a challenging pull session?","Wind down with some moderate intensity training and stretching.","Great time for upper body work - your mobility is at its best."],night:["For late sessions, keep it moderate to not disrupt sleep.","Consider yoga or mobility work to prepare for quality rest.","Light resistance work can help tire you out for better sleep."]},D={thanks:["You're welcome! Now go crush it!","Anytime! That's what I'm here for.","No problem! Remember, consistency is key."],goodbye:["Keep pushing! See you next session.","Rest up and come back stronger!","Later! Remember, every workout counts."],confusion:["I'm not sure I understand. Try asking about workouts, form tips, or motivation!","Hmm, could you rephrase that? I'm best at workout advice and motivation.","I didn't quite catch that. Want a workout suggestion or some motivation?"]},z={push:[{name:"Bench Press",muscles:["Chest","Triceps","Shoulders"],sets:"4x8-10"},{name:"Overhead Press",muscles:["Shoulders","Triceps"],sets:"3x8-12"},{name:"Incline Dumbbell Press",muscles:["Upper Chest","Shoulders"],sets:"3x10-12"},{name:"Tricep Dips",muscles:["Triceps","Chest"],sets:"3x12-15"}],pull:[{name:"Deadlift",muscles:["Back","Hamstrings","Glutes"],sets:"4x5"},{name:"Pull-ups",muscles:["Lats","Biceps","Core"],sets:"4x8-12"},{name:"Barbell Rows",muscles:["Back","Biceps"],sets:"4x8-10"},{name:"Face Pulls",muscles:["Rear Delts","Traps"],sets:"3x15-20"}],legs:[{name:"Squats",muscles:["Quads","Glutes","Core"],sets:"4x6-8"},{name:"Romanian Deadlifts",muscles:["Hamstrings","Glutes"],sets:"3x10-12"},{name:"Leg Press",muscles:["Quads","Glutes"],sets:"4x10-12"},{name:"Walking Lunges",muscles:["Quads","Glutes","Core"],sets:"3x12 each"}]};function ae(t,s={}){const r=t.toLowerCase().trim();if(r.match(/^(hi|hello|hey|sup|yo|good morning|good afternoon|good evening)/))return{type:"text",content:J(s.name)};if(r.match(/(thank|thanks|thx|appreciate)/)){const a=D.thanks;return{type:"text",content:a[Math.floor(Math.random()*a.length)]}}if(r.match(/(bye|goodbye|later|see ya|cya|gotta go)/)){const a=D.goodbye;return{type:"text",content:a[Math.floor(Math.random()*a.length)]}}if(r.match(/(motivat|inspire|pump|encourage|hype)/))return{type:"motivation",content:$[Math.floor(Math.random()*$.length)]};if(r.match(/(form|technique|how to|tip|advice)/)){const a=Y(r),n=K[a]||K.general;return{type:"tip",content:n[Math.floor(Math.random()*n.length)],category:a}}if(r.match(/(recover|rest|sore|tired|fatigue|sleep)/))return{type:"recovery",content:q[Math.floor(Math.random()*q.length)]};if(r.match(/(workout|exercise|train|session|routine|program)/)){const a=X(),n=F[a]||F.afternoon,u=Y(r);return{type:"workout",content:n[Math.floor(Math.random()*n.length)],exercises:z[u]||z.push,category:u}}return r.match(/(progress|stats|how am i|doing|track)/)?{type:"progress",content:ne(s)}:{type:"text",content:D.confusion[Math.floor(Math.random()*D.confusion.length)],showQuickActions:!0}}function Y(t){return t.match(/(push|chest|bench|press|tricep|shoulder|dip)/)?"push":t.match(/(pull|back|row|deadlift|lat|bicep|curl)/)?"pull":t.match(/(leg|squat|lunge|calf|hamstring|glute|quad)/)?"legs":t.match(/(core|ab|plank|crunch)/)?"core":"general"}function ne(t){const{workoutsThisWeek:s=0,streak:r=0,totalWorkouts:a=0}=t,n=[`You've completed ${s} workouts this week. ${s>=3?"Great consistency!":"Let's hit that 3+ goal!"}`,r>0?`${r} day streak! Keep the momentum going!`:"No streak yet - today's a perfect day to start one!",a>0?`${a} total workouts logged. Every rep counts!`:"Ready to log your first workout? I'll be here cheering you on!"];return n[Math.floor(Math.random()*n.length)]}const g={IDLE:"idle",THINKING:"thinking",SPEAKING:"speaking",CELEBRATING:"celebrating"},M={flex:{icon:"ðŸ’ª",name:"Max",title:"Your Strength Coach",gradient:"from-blue-500 to-purple-600",glow:"bg-blue-400",shadow:"shadow-blue-500/30"},spark:{icon:"âš¡",name:"Spark",title:"Your Energy Coach",gradient:"from-yellow-400 to-orange-500",glow:"bg-yellow-400",shadow:"shadow-yellow-500/30"},zen:{icon:"ðŸ§˜",name:"Zen",title:"Your Mindful Coach",gradient:"from-teal-400 to-green-500",glow:"bg-teal-400",shadow:"shadow-teal-500/30"}};function P({state:t=g.IDLE,size:s="md",personality:r="flex",className:a,reducedMotion:n=!1}){const u=M[r]||M.flex,l={sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16",xl:"w-20 h-20"},k={sm:"text-sm",md:"text-xl",lg:"text-2xl",xl:"text-3xl"},b={flex:n?{}:{scale:[1,1.05,1],transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}},spark:n?{}:{scale:[1,1.02,1],opacity:[1,.8,1],transition:{duration:.8,repeat:1/0,ease:"easeInOut"}},zen:n?{}:{scale:[1,1.03,1],transition:{duration:3,repeat:1/0,ease:"easeInOut"}}},v={idle:b[r]||b.flex,thinking:n?{}:{rotate:[0,-5,5,0],transition:{duration:1,repeat:1/0,ease:"easeInOut"}},speaking:n?{}:{scale:[1,1.05,1,1.03,1],transition:{duration:.8,repeat:1/0,ease:"easeInOut"}},celebrating:n?{}:{rotate:[0,-10,10,-10,10,0],scale:[1,1.1,1.1,1.1,1.1,1],transition:{duration:.6,repeat:1/0,repeatDelay:.5}}},f={idle:{opacity:.3,scale:1},thinking:n?{opacity:.5}:{opacity:[.3,.6,.3],scale:[1,1.2,1],transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}},speaking:n?{opacity:.4}:{opacity:[.4,.7,.4],scale:[1,1.1,1],transition:{duration:.5,repeat:1/0,ease:"easeInOut"}},celebrating:n?{opacity:.6}:{opacity:[.5,1,.5],scale:[1,1.3,1],transition:{duration:.4,repeat:1/0}}},C=()=>{switch(t){case g.THINKING:return"ðŸ¤”";case g.SPEAKING:return"ðŸ’¬";case g.CELEBRATING:return"ðŸŽ‰";default:return u.icon}};return e.jsxs(m.div,{className:c("relative flex items-center justify-center rounded-full",`bg-gradient-to-br ${u.gradient}`,l[s],a),variants:v,animate:t,initial:"idle",children:[e.jsx(m.div,{className:c("absolute inset-0 rounded-full blur-md -z-10",u.glow),variants:f,animate:t,initial:"idle"}),e.jsx("div",{className:c("absolute inset-1 rounded-full","bg-gradient-to-br from-blue-400/30 to-purple-500/30","border border-white/20")}),e.jsx("span",{className:c(k[s],"relative z-10"),role:"img","aria-hidden":"true",children:C()}),t===g.THINKING&&!n&&e.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 flex gap-0.5",children:[0,1,2].map(y=>e.jsx(m.div,{className:"w-1 h-1 bg-blue-400 rounded-full",animate:{y:[0,-4,0],opacity:[.5,1,.5]},transition:{duration:.6,repeat:1/0,delay:y*.15}},y))}),t===g.SPEAKING&&!n&&e.jsx(e.Fragment,{children:[0,1,2].map(y=>e.jsx(m.div,{className:"absolute inset-0 rounded-full border-2 border-blue-400",initial:{opacity:0,scale:1},animate:{opacity:[.6,0],scale:[1,1.5]},transition:{duration:1.2,repeat:1/0,delay:y*.4,ease:"easeOut"}},y))}),t===g.CELEBRATING&&!n&&e.jsx(e.Fragment,{children:[...Array(6)].map((y,w)=>e.jsx(m.div,{className:"absolute w-1.5 h-1.5 rounded-full",style:{background:["#FFD700","#FF6B6B","#4ECDC4","#A78BFA","#34D399","#F59E0B"][w]},initial:{x:0,y:0,opacity:0},animate:{x:[0,Math.cos(w*Math.PI/3)*30],y:[0,Math.sin(w*Math.PI/3)*30-10],opacity:[0,1,0]},transition:{duration:.8,repeat:1/0,delay:w*.1}},w))})]})}const I={TEXT:"text",MOTIVATION:"motivation",TIP:"tip",RECOVERY:"recovery",WORKOUT:"workout",PROGRESS:"progress",ACTION:"action"},U=[{id:"workout",label:"Today's workout",icon:"ðŸ’ª",query:"What workout should I do today?"},{id:"motivate",label:"Motivate me",icon:"ðŸ”¥",query:"I need some motivation"},{id:"chest",label:"Chest exercises",icon:"ðŸ¦µ",query:"Give me some chest exercises"},{id:"progress",label:"How's my progress?",icon:"ðŸ“Š",query:"How's my progress?"},{id:"rest",label:"Rest day tips",icon:"ðŸ§˜",query:"Give me some rest day tips"}];function W(){return`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function re(t={}){const{userContext:s={},avatarPersonality:r="flex",typingDelay:a=800}=t,n=o.useMemo(()=>{const i=M[r]||M.flex;return{name:i.name,title:i.title}},[r]),u=o.useCallback(()=>{try{const i=localStorage.getItem("musclemap_ai_coach_history");if(i){const d=JSON.parse(i),p=Date.now()-24*60*60*1e3;return d.filter(V=>new Date(V.timestamp).getTime()>p)}}catch{}return[]},[]),[l,k]=o.useState(u),[b,v]=o.useState(!1),[f,C]=o.useState(!1),[y,w]=o.useState(!1);o.useEffect(()=>{if(l.length>0)try{const i=l.slice(-50);localStorage.setItem("musclemap_ai_coach_history",JSON.stringify(i))}catch{}},[l]);const A=o.useRef(null),N=o.useRef(!1),j=o.useCallback(i=>{const d={id:W(),sender:"coach",timestamp:new Date().toISOString(),coachName:n.name,...i};k(p=>[...p,d]),v(!1),w(p=>f?p:!0)},[f,n.name]),L=o.useRef(l.length>0);o.useEffect(()=>{f&&!N.current&&l.length===0&&!L.current?(N.current=!0,setTimeout(()=>{const i=J(s.name||"Athlete");j({type:I.TEXT,content:i,showQuickActions:!0})},300)):f&&!N.current&&l.length>0&&(N.current=!0)},[f,l.length,s.name,j]),o.useEffect(()=>()=>{A.current&&clearTimeout(A.current)},[]);const H=o.useCallback(i=>{const d={id:W(),sender:"user",type:I.TEXT,content:i,timestamp:new Date().toISOString()};return k(p=>[...p,d]),d},[]),R=o.useCallback(i=>{i.trim()&&(H(i),v(!0),A.current=setTimeout(()=>{const d=ae(i,s);j(d)},a+Math.random()*500))},[H,j,a,s]),T=o.useCallback(i=>{const d=U.find(p=>p.id===i);d&&R(d.query)},[R]),x=o.useCallback(()=>{C(i=>!i),f||w(!1)},[f]),_=o.useCallback(()=>{C(!0),w(!1)},[]),S=o.useCallback(()=>{C(!1)},[]),E=o.useCallback(()=>{k([]),N.current=!1;try{localStorage.removeItem("musclemap_ai_coach_history")}catch{}},[]),G=o.useCallback(i=>{j(i)},[j]);return{messages:l,isTyping:b,isOpen:f,hasUnread:y,coachName:n.name,coachTitle:n.title,sendMessage:R,handleQuickAction:T,toggleChat:x,openChat:_,closeChat:S,clearChat:E,sendProactiveMessage:G,quickActions:U}}function oe({message:t,isLatest:s=!1,onActionClick:r,reducedMotion:a=!1}){const n=t.sender==="coach",u={hidden:{opacity:0,y:10,scale:.95},visible:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:300,damping:25}}},l=k=>new Date(k).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return e.jsxs(m.div,{className:c("flex gap-2 mb-3",n?"flex-row":"flex-row-reverse"),variants:a?{}:u,initial:"hidden",animate:"visible",children:[n&&e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx(P,{state:s?g.SPEAKING:g.IDLE,size:"sm",reducedMotion:a})}),e.jsxs("div",{className:c("flex flex-col max-w-[80%]",n?"items-start":"items-end"),children:[n&&t.coachName&&e.jsx("span",{className:"text-xs text-blue-400 font-medium mb-1 ml-1",children:t.coachName}),e.jsx("div",{className:c("rounded-2xl px-4 py-2.5 break-words",n?"bg-gray-800/80 backdrop-blur-sm border border-gray-700/50 text-white rounded-tl-sm":"bg-blue-600 text-white rounded-tr-sm"),children:ie(t,r)}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 mx-1",children:l(t.timestamp)})]})]})}function ie(t,s){switch(t.type){case I.MOTIVATION:return e.jsx(ce,{content:t.content});case I.TIP:return e.jsx(ue,{content:t.content,category:t.category});case I.RECOVERY:return e.jsx(de,{content:t.content});case I.WORKOUT:return e.jsx(he,{content:t.content,exercises:t.exercises,category:t.category});case I.PROGRESS:return e.jsx(ge,{content:t.content});case I.ACTION:return e.jsx(pe,{content:t.content,actions:t.actions,onActionClick:s});default:return e.jsx(le,{content:t.content})}}function le({content:t}){return e.jsx("p",{className:"text-sm leading-relaxed",children:t})}function ce({content:t}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"ðŸ”¥"}),e.jsx("span",{className:"text-xs font-semibold text-orange-400 uppercase tracking-wide",children:"Motivation"})]}),e.jsxs("blockquote",{className:"text-sm italic border-l-2 border-orange-400/50 pl-3 text-gray-200",children:["â€œ",t,"â€"]})]})}function ue({content:t,category:s}){const r={push:"ðŸ’ª",pull:"ðŸ‹ï¸",legs:"ðŸ¦µ",core:"ðŸŽ¯",general:"ðŸ“"};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:r[s]||"ðŸ’¡"}),e.jsx("span",{className:"text-xs font-semibold text-green-400 uppercase tracking-wide",children:"Form Tip"})]}),e.jsx("p",{className:"text-sm leading-relaxed",children:t})]})}function de({content:t}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"ðŸ§˜"}),e.jsx("span",{className:"text-xs font-semibold text-purple-400 uppercase tracking-wide",children:"Recovery"})]}),e.jsx("p",{className:"text-sm leading-relaxed",children:t})]})}function he({content:t,exercises:s}){return e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm leading-relaxed",children:t}),s&&s.length>0&&e.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-600/50",children:[e.jsx("span",{className:"text-xs font-semibold text-blue-400 uppercase tracking-wide",children:"Suggested Exercises"}),s.slice(0,3).map((r,a)=>e.jsx(me,{exercise:r},a))]})]})}function me({exercise:t}){return e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-700/50 rounded-lg",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center",children:e.jsx("span",{className:"text-lg",children:"ðŸ‹ï¸"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-white truncate",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:[t.muscles.join(", ")," â€¢ ",t.sets]})]})]})}function ge({content:t}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"ðŸ“Š"}),e.jsx("span",{className:"text-xs font-semibold text-cyan-400 uppercase tracking-wide",children:"Your Progress"})]}),e.jsx("p",{className:"text-sm leading-relaxed",children:t})]})}function pe({content:t,actions:s,onActionClick:r}){return e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm leading-relaxed",children:t}),s&&s.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map((a,n)=>e.jsx("button",{onClick:()=>r?.(a.id),className:"px-3 py-1.5 text-xs font-medium bg-blue-500/20 hover:bg-blue-500/30 border border-blue-500/30 rounded-full text-blue-300 transition-colors",children:a.label},n))})]})}function fe({coachName:t,reducedMotion:s=!1}){return e.jsxs(m.div,{className:"flex gap-2 mb-3",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx(P,{state:g.THINKING,size:"sm",reducedMotion:s})}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"text-xs text-blue-400 font-medium mb-1 ml-1",children:t}),e.jsx("div",{className:"rounded-2xl rounded-tl-sm px-4 py-3 bg-gray-800/80 backdrop-blur-sm border border-gray-700/50",children:e.jsx("div",{className:"flex gap-1.5",children:[0,1,2].map(r=>e.jsx(m.div,{className:"w-2 h-2 bg-gray-400 rounded-full",animate:s?{}:{y:[0,-6,0],opacity:[.4,1,.4]},transition:{duration:.8,repeat:1/0,delay:r*.15,ease:"easeInOut"}},r))})})]})]})}function Q({actions:t=[],onAction:s,variant:r="default",reducedMotion:a=!1}){const n={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:a?0:.05}}},u={hidden:{opacity:0,y:10,scale:.9},visible:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:300,damping:20}}};return e.jsx(m.div,{className:c("flex gap-2 overflow-x-auto scrollbar-hide",r==="compact"?"py-1":"py-2"),variants:a?{}:n,initial:"hidden",animate:"visible",children:t.map(l=>e.jsxs(m.button,{variants:a?{}:u,whileHover:a?{}:{scale:1.05},whileTap:a?{}:{scale:.95},onClick:()=>s?.(l.id),className:c("flex-shrink-0 flex items-center gap-1.5","px-3 py-2 rounded-full","bg-gray-800/60 hover:bg-gray-700/80","border border-gray-700/50 hover:border-blue-500/50","text-sm font-medium text-gray-300 hover:text-white","transition-colors cursor-pointer","focus:outline-none focus:ring-2 focus:ring-blue-500/50"),children:[l.icon&&e.jsx("span",{className:"text-base",role:"img","aria-hidden":"true",children:l.icon}),e.jsx("span",{className:"whitespace-nowrap",children:l.label})]},l.id))})}function Se({userContext:t={},reducedMotion:s=!1,position:r="bottom-right",placement:a="floating",avatar:n="flex",collapsed:u,onToggle:l,zIndex:k=50}){const{messages:b,isTyping:v,isOpen:f,hasUnread:C,coachName:y,coachTitle:w,sendMessage:A,handleQuickAction:N,toggleChat:j,closeChat:L,openChat:H,quickActions:R}=re({userContext:t,avatarPersonality:n}),T=u!==void 0,x=T?!u:f,_=o.useCallback(()=>{l&&l(!x),T||j()},[l,x,T,j]),S=o.useCallback(()=>{l&&l(!1),T||L()},[l,T,L]),[E,G]=o.useState(""),i=o.useRef(null),d=o.useRef(null),p=o.useRef(null);o.useEffect(()=>{i.current&&i.current.scrollIntoView({behavior:"smooth"})},[b,v]),o.useEffect(()=>{x&&d.current&&setTimeout(()=>d.current?.focus(),300)},[x]),o.useEffect(()=>{const h=O=>{O.key==="Escape"&&x&&S()};return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[x,S]),o.useEffect(()=>{if(a==="sidebar")return;const h=O=>{x&&p.current&&!p.current.contains(O.target)&&S()};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[x,S,a]);const V=o.useCallback(h=>{h.preventDefault(),E.trim()&&(A(E.trim()),G(""))},[E,A]),B=o.useCallback(h=>{N(h)},[N]),Z=a==="sidebar"?{"bottom-right":"right-0 top-0 h-full","bottom-left":"left-0 top-0 h-full"}:{"bottom-right":"right-4 bottom-4 sm:right-6 sm:bottom-6","bottom-left":"left-4 bottom-4 sm:left-6 sm:bottom-6"},ee=a==="sidebar"?{hidden:{x:r==="bottom-right"?"100%":"-100%",opacity:0},visible:{x:0,opacity:1,transition:{type:"spring",stiffness:300,damping:30}},exit:{x:r==="bottom-right"?"100%":"-100%",opacity:0,transition:{duration:.2}}}:{hidden:{opacity:0,scale:.8,y:20},visible:{opacity:1,scale:1,y:0,transition:{type:"spring",stiffness:300,damping:25}},exit:{opacity:0,scale:.8,y:20,transition:{duration:.2}}},te={idle:{scale:1,rotate:0},hover:{scale:1.1},tap:{scale:.9}};return e.jsx("div",{ref:p,className:c("fixed",Z[r]),style:{zIndex:k},children:e.jsx(se,{mode:"wait",children:x?e.jsxs(m.div,{variants:s?{}:ee,initial:"hidden",animate:"visible",exit:"exit",className:c("flex flex-col","bg-gray-900/95 backdrop-blur-xl","border border-gray-700/50","shadow-2xl shadow-black/50","overflow-hidden",a==="sidebar"?"w-[400px] h-full rounded-none border-r-0":["rounded-2xl","fixed inset-4 sm:inset-auto","sm:relative sm:w-96 sm:h-[500px]"]),role:"dialog","aria-modal":"true","aria-label":"AI Training Partner chat",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-gray-700/50 bg-gradient-to-r from-blue-900/30 to-purple-900/30",children:[e.jsx(P,{state:v?g.THINKING:g.IDLE,size:"md",personality:n,reducedMotion:s}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"font-bold text-white truncate",children:y}),e.jsx("p",{className:"text-xs text-gray-400 truncate",children:w})]}),e.jsx("button",{onClick:S,className:c("w-8 h-8 rounded-full","bg-gray-800/50 hover:bg-gray-700/80","flex items-center justify-center","text-gray-400 hover:text-white","transition-colors","focus:outline-none focus:ring-2 focus:ring-blue-500"),"aria-label":"Close chat",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-1",children:[b.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[e.jsx(P,{state:g.CELEBRATING,size:"xl",personality:n,reducedMotion:s}),e.jsxs("h3",{className:"mt-4 text-lg font-bold text-white",children:["Hey, I'm ",y,"!"]}),e.jsx("p",{className:"mt-2 text-sm text-gray-400 max-w-xs",children:"Your AI Training Partner. Ask me about workouts, form tips, or when you need motivation."}),e.jsx("div",{className:"mt-6 w-full",children:e.jsx(Q,{actions:R,onAction:B,reducedMotion:s})})]}),b.map((h,O)=>e.jsx(oe,{message:h,isLatest:O===b.length-1&&h.sender==="coach",reducedMotion:s},h.id)),v&&e.jsx(fe,{coachName:y,reducedMotion:s}),e.jsx("div",{ref:i})]}),b.length>0&&e.jsx("div",{className:"px-4 py-2 border-t border-gray-700/30",children:e.jsx(Q,{actions:R,onAction:B,variant:"compact",reducedMotion:s})}),e.jsx("form",{onSubmit:V,className:"p-4 border-t border-gray-700/50 bg-gray-800/30",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:d,type:"text",value:E,onChange:h=>G(h.target.value),placeholder:"Ask me anything...",className:c("flex-1 px-4 py-2.5 rounded-xl","bg-gray-800/60 border border-gray-700/50","text-white placeholder-gray-500","focus:outline-none focus:border-blue-500/50 focus:ring-1 focus:ring-blue-500/50","transition-colors"),disabled:v,"aria-label":"Message input"}),e.jsx(m.button,{type:"submit",disabled:!E.trim()||v,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},className:c("px-4 py-2.5 rounded-xl","bg-blue-600 hover:bg-blue-500","disabled:bg-gray-700 disabled:cursor-not-allowed","text-white font-medium","transition-colors","focus:outline-none focus:ring-2 focus:ring-blue-500"),"aria-label":"Send message",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]},"chat-panel"):a==="floating"&&e.jsxs(m.button,{variants:s?{}:te,initial:"idle",whileHover:"hover",whileTap:"tap",onClick:_,className:c("relative","w-14 h-14 rounded-full","bg-gradient-to-br from-blue-500 to-purple-600","shadow-lg shadow-blue-500/30","flex items-center justify-center","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500","transition-shadow hover:shadow-xl hover:shadow-blue-500/40"),"aria-label":"Open AI Coach chat","aria-expanded":x,children:[e.jsx(P,{state:g.IDLE,size:"md",personality:n,className:"bg-transparent",reducedMotion:s}),C&&e.jsx(m.div,{initial:{scale:0},animate:{scale:1},className:c("absolute -top-1 -right-1","w-4 h-4 rounded-full","bg-red-500 border-2 border-gray-900")}),!s&&e.jsx(m.div,{className:"absolute inset-0 rounded-full bg-blue-400",animate:{scale:[1,1.3,1],opacity:[.3,0,.3]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})]},"chat-fab")})})}export{Se as default,re as useAICoach};
