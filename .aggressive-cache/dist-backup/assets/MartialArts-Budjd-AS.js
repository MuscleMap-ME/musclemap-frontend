import{l as $,d as A,r as i,j as e,L as z}from"./react-vendor-D1NxaRNd.js";import{y as O}from"./index-BV5ySY7X.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./apollo-vendor-BMQ75Ycx.js";import"./reactflow-vendor-Dz2P_-Qa.js";import"./d3-vendor-mcDw60ct.js";import"./recharts-vendor-BziRPEEi.js";const C=({difficulty:s})=>e.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(r=>e.jsx("span",{className:r<=s?"text-yellow-400":"text-gray-600",children:"‚òÖ"},r))}),D=({status:s})=>{const r={locked:"bg-gray-700 text-gray-400",available:"bg-blue-600 text-white",learning:"bg-yellow-600 text-white",proficient:"bg-purple-600 text-white",mastered:"bg-green-600 text-white"},a={locked:"üîí Locked",available:"‚ú® Available",learning:"üî• Learning",proficient:"üí™ Proficient",mastered:"üèÜ Mastered"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r[s]||r.locked}`,children:a[s]||s})},L=({proficiency:s})=>e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${s>=80?"bg-green-500":s>=50?"bg-yellow-500":"bg-blue-500"}`,style:{width:`${s}%`}})}),S=({technique:s,onClick:r})=>{const a=s.progress?.status||"locked",x=a==="locked",o=s.progress?.proficiency||0;return e.jsxs("button",{onClick:()=>!x&&r(s),disabled:x,className:`w-full p-4 rounded-xl border-2 transition-all text-left ${x?"bg-gray-800/50 border-gray-700 opacity-60 cursor-not-allowed":a==="mastered"?"bg-gradient-to-br from-green-900/50 to-green-800/30 border-green-600 hover:border-green-500":a==="proficient"?"bg-gradient-to-br from-purple-900/50 to-purple-800/30 border-purple-600 hover:border-purple-500":a==="learning"?"bg-gradient-to-br from-yellow-900/50 to-yellow-800/30 border-yellow-600 hover:border-yellow-500":"bg-gray-800 border-gray-600 hover:border-blue-500 hover:bg-gray-700"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-bold text-white",children:s.name}),e.jsx(D,{status:a})]}),e.jsx("p",{className:"text-sm text-gray-400 mb-3 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(C,{difficulty:s.difficulty}),e.jsx("span",{className:"text-xs text-gray-500 capitalize",children:s.category})]}),a!=="locked"&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[e.jsx("span",{children:"Proficiency"}),e.jsxs("span",{children:[o,"%"]})]}),e.jsx(L,{proficiency:o})]})]})},q=({technique:s,onClose:r,onLogPractice:a,onMaster:x})=>{const[o,m]=i.useState(15),[c,d]=i.useState(""),[n,h]=i.useState(""),[u,w]=i.useState(!1),[b,v]=i.useState(""),[f,g]=i.useState(!1),k=async()=>{g(!0),await a({techniqueId:s.id,durationMinutes:o,repsPerformed:c?parseInt(c):void 0,roundsPerformed:n?parseInt(n):void 0,partnerDrill:u,notes:b||void 0}),g(!1),r()},p=async()=>{g(!0),await x({techniqueId:s.id}),g(!1),r()},y=s.progress?.status||"available",N=s.progress?.proficiency||0;return e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-gray-800 rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:s.name}),e.jsx(D,{status:y})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white text-2xl",children:"√ó"})]}),e.jsx("p",{className:"text-gray-300 mb-4",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Difficulty"}),e.jsx(C,{difficulty:s.difficulty})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Category"}),e.jsx("div",{className:"text-white font-medium capitalize",children:s.category})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"XP Reward"}),e.jsxs("div",{className:"text-green-400 font-medium",children:["+",s.xpReward," XP"]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-gray-400 text-sm",children:"Credit Reward"}),e.jsxs("div",{className:"text-yellow-400 font-medium",children:["+",s.creditReward," üí∞"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-400 mb-1",children:[e.jsx("span",{children:"Proficiency"}),e.jsxs("span",{children:[N,"%"]})]}),e.jsx(L,{proficiency:N}),N>=80&&y!=="mastered"&&e.jsx("div",{className:"text-green-400 text-sm mt-2",children:"Ready to master!"})]}),s.keyPoints?.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Key Points"}),e.jsx("ul",{className:"space-y-2",children:s.keyPoints.map((t,l)=>e.jsxs("li",{className:"flex items-start gap-2 text-gray-300",children:[e.jsx("span",{className:"text-green-400",children:"‚úì"}),t]},l))})]}),s.muscleGroups?.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Muscles Used"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.muscleGroups.map((t,l)=>e.jsx("span",{className:"px-3 py-1 bg-gray-700 rounded-full text-sm text-gray-300 capitalize",children:t},l))})]}),y!=="mastered"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"border-t border-gray-700 pt-4 mt-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Log Practice"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Duration (minutes)"}),e.jsx("input",{type:"number",value:o,onChange:t=>m(parseInt(t.target.value)||0),className:"w-full bg-gray-700 rounded-lg px-4 py-2 text-white",min:"1"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Reps performed"}),e.jsx("input",{type:"number",value:c,onChange:t=>d(t.target.value),className:"w-full bg-gray-700 rounded-lg px-4 py-2 text-white",placeholder:"Optional"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Rounds"}),e.jsx("input",{type:"number",value:n,onChange:t=>h(t.target.value),className:"w-full bg-gray-700 rounded-lg px-4 py-2 text-white",placeholder:"Optional"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"partnerDrill",checked:u,onChange:t=>w(t.target.checked),className:"w-5 h-5 rounded bg-gray-700"}),e.jsx("label",{htmlFor:"partnerDrill",className:"text-gray-300",children:"Partner drill / sparring"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Notes"}),e.jsx("textarea",{value:b,onChange:t=>v(t.target.value),className:"w-full bg-gray-700 rounded-lg px-4 py-2 text-white resize-none",rows:2,placeholder:"How did it go?"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:k,disabled:f||o<1,className:"flex-1 bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-lg disabled:opacity-50",children:f?"Saving...":"Log Practice"}),N>=80&&e.jsx("button",{onClick:p,disabled:f,className:"flex-1 bg-green-600 hover:bg-green-500 text-white font-bold py-3 rounded-lg disabled:opacity-50",children:"üèÜ Mark Mastered!"})]})]})]})}),y==="mastered"&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üèÜ"}),e.jsx("div",{className:"text-green-400 font-bold text-lg",children:"Technique Mastered!"}),s.progress?.masteredAt&&e.jsxs("div",{className:"text-gray-400 text-sm mt-2",children:["Mastered on ",new Date(s.progress.masteredAt).toLocaleDateString()]})]})]})})})},E=({discipline:s,techniques:r,onLogPractice:a,onMaster:x})=>{const[o,m]=i.useState(null),c={};return r.forEach(d=>{const n=d.categoryId||"uncategorized";c[n]||(c[n]=[]),c[n].push(d)}),e.jsxs("div",{children:[e.jsx("div",{className:`rounded-xl p-4 mb-6 bg-gradient-to-r ${s.color||"from-red-500 to-orange-500"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-4xl",children:s.icon}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:s.name}),e.jsx("p",{className:"text-white/80",children:s.description}),s.isMilitary&&e.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-black/30 rounded text-xs text-white/90",children:"Military/Tactical"})]})]})}),s.categories?.map(d=>{const n=c[d.id]||[];return n.length===0?null:e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-300 mb-4 flex items-center gap-2",children:e.jsx("span",{className:"bg-gray-700 px-3 py-1 rounded-full text-sm",children:d.name})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.sort((h,u)=>h.tier-u.tier||h.position-u.position).map(h=>e.jsx(S,{technique:h,onClick:m},h.id))})]},d.id)}),c.uncategorized?.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-300 mb-4",children:"Other Techniques"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.uncategorized.map(d=>e.jsx(S,{technique:d,onClick:m},d.id))})]}),o&&e.jsx(q,{technique:o,onClose:()=>m(null),onLogPractice:a,onMaster:x})]})},T=({summary:s})=>{if(!s)return null;const r=s.totalTechniques>0?Math.round(s.masteredTechniques/s.totalTechniques*100):0;return e.jsxs("div",{className:"bg-gradient-to-br from-red-900/50 to-orange-900/50 rounded-xl p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Your Martial Arts Progress"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-400",children:s.masteredTechniques}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Mastered"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-400",children:s.learningTechniques}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Learning"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-400",children:s.availableTechniques}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Available"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-purple-400",children:[Math.floor((s.totalPracticeMinutes??0)/60),"h"]}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Training Time"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-400 mb-1",children:[e.jsx("span",{children:"Overall Mastery"}),e.jsxs("span",{children:[r,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-red-500 to-orange-400 transition-all",style:{width:`${r}%`}})})]})]})};function K(){const{disciplineId:s}=$(),r=A(),{token:a}=O(),[x,o]=i.useState([]),[m,c]=i.useState(null),[d,n]=i.useState([]),[h,u]=i.useState(null),[w,b]=i.useState(!0),[v,f]=i.useState(null),[g,k]=i.useState(!1),p={Authorization:`Bearer ${a}`};i.useEffect(()=>{fetch(g?"/api/martial-arts/disciplines?military=true":"/api/martial-arts/disciplines").then(l=>l.json()).then(l=>{o(l.disciplines||[])}).catch(l=>f(l.message)).finally(()=>b(!1))},[g]),i.useEffect(()=>{a&&fetch("/api/martial-arts/progress",{headers:p}).then(t=>t.json()).then(u).catch(()=>{})},[a]),i.useEffect(()=>{if(!s){c(null),n([]);return}b(!0),Promise.all([fetch(`/api/martial-arts/disciplines/${s}`).then(t=>t.json()),a?fetch(`/api/martial-arts/disciplines/${s}/progress`,{headers:p}).then(t=>t.json()):fetch(`/api/martial-arts/disciplines/${s}/techniques`).then(t=>t.json())]).then(([t,l])=>{c(t.discipline),n(l.techniques||[])}).catch(t=>f(t.message)).finally(()=>b(!1))},[s,a]);const y=async t=>{if(!a){alert("Please log in to track your progress");return}try{if((await(await fetch("/api/martial-arts/practice",{method:"POST",headers:{...p,"Content-Type":"application/json"},body:JSON.stringify(t)})).json()).practiceLog){const P=await(await fetch(`/api/martial-arts/disciplines/${s}/progress`,{headers:p})).json();n(P.techniques||[]);const M=await fetch("/api/martial-arts/progress",{headers:p});u(await M.json())}}catch{alert("Failed to log practice")}},N=async t=>{if(!a){alert("Please log in to track your progress");return}try{const j=await(await fetch("/api/martial-arts/master",{method:"POST",headers:{...p,"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(j.success){alert(`üèÜ Technique mastered! +${j.creditsAwarded} credits, +${j.xpAwarded} XP`);const P=await(await fetch(`/api/martial-arts/disciplines/${s}/progress`,{headers:p})).json();n(P.techniques||[]);const M=await fetch("/api/martial-arts/progress",{headers:p});u(await M.json())}else alert(j.error||"Failed to master technique")}catch{alert("Failed to master technique")}};return w&&!x.length?e.jsx("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ü•ä"}),e.jsx("div",{children:"Loading martial arts..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white pb-24",children:[e.jsx("header",{className:"bg-gray-800 p-4 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[e.jsxs(z,{to:s?"/martial-arts":"/dashboard",className:"text-blue-400",children:["‚Üê ",s?"All Disciplines":"Back"]}),e.jsx("h1",{className:"text-xl font-bold",children:m?m.name:"Martial Arts"}),e.jsx("div",{className:"w-16"})]})}),e.jsxs("main",{className:"max-w-6xl mx-auto p-4",children:[v&&e.jsx("div",{className:"bg-red-900/50 border border-red-600 rounded-lg p-4 mb-4",children:v}),s?e.jsxs(e.Fragment,{children:[a&&e.jsx(T,{summary:h}),m&&e.jsx(E,{discipline:m,techniques:d,onLogPractice:y,onMaster:N})]}):e.jsxs(e.Fragment,{children:[a&&e.jsx(T,{summary:h}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Disciplines"}),e.jsx("button",{onClick:()=>k(!g),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${g?"bg-green-700 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:g?"ü™ñ Military Only":"All Disciplines"})]}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Learn combat techniques from boxing to BJJ, including military combatives programs like MCMAP and Krav Maga. Track your progress and master each discipline."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map(t=>e.jsxs("button",{onClick:()=>r(`/martial-arts/${t.id}`),className:`p-6 rounded-xl text-left transition-all hover:scale-[1.02] bg-gradient-to-br ${t.color||"from-red-500 to-orange-500"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("span",{className:"text-4xl",children:t.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:t.name}),t.isMilitary&&e.jsx("span",{className:"text-xs bg-black/30 px-2 py-0.5 rounded",children:"Military"})]})]}),e.jsx("p",{className:"text-white/80 text-sm mb-3",children:t.description}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.focusAreas?.map((l,j)=>e.jsx("span",{className:"text-xs bg-black/20 px-2 py-0.5 rounded text-white/70 capitalize",children:l},j))})]},t.id))}),e.jsxs("div",{className:"mt-12 bg-gray-800 rounded-xl p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"How It Works"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl mb-2",children:"ü•ä"}),e.jsx("h4",{className:"font-bold text-white mb-1",children:"Choose a Discipline"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Select from boxing, BJJ, wrestling, and military combatives. Each has unique techniques to master."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl mb-2",children:"üìà"}),e.jsx("h4",{className:"font-bold text-white mb-1",children:"Build Proficiency"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Log your practice sessions to increase proficiency. Partner drills and repetitions all count toward mastery."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl mb-2",children:"üèÜ"}),e.jsx("h4",{className:"font-bold text-white mb-1",children:"Master Techniques"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Reach 80% proficiency to unlock mastery. Earn credits and XP as you progress through each discipline."})]})]})]})]})]})]})}export{K as default};
