import{u as P,k as R,r as n,j as e,L as g}from"./react-vendor-D847gc3Q.js";import{G as z,e as E,A as L,m as $}from"./index-DhiiJXo_.js";import{f as W}from"./date-vendor-C_JWt2cu.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./apollo-vendor-BNHFeEEc.js";import"./reactflow-vendor-5ig9bY2l.js";import"./d3-vendor-DkU_Wy0v.js";import"./recharts-vendor-d8oTApeF.js";const i={Back:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 19l-7-7 7-7"})}),Plus:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 4v16m8-8H4"})}),Search:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Filter:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),ChevronUp:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),Comment:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),Pin:()=>e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M16 12V4h1V2H7v2h1v8l-2 2v2h5.2v6h1.6v-6H18v-2l-2-2z"})}),Lock:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})},j={0:{label:"Bug",color:"bg-red-500/20 text-red-400",icon:"ðŸ›"},1:{label:"Feature",color:"bg-green-500/20 text-green-400",icon:"âœ¨"},2:{label:"Enhancement",color:"bg-blue-500/20 text-blue-400",icon:"ðŸ’¡"},3:{label:"Account",color:"bg-orange-500/20 text-orange-400",icon:"ðŸ‘¤"},4:{label:"Question",color:"bg-pink-500/20 text-pink-400",icon:"â“"},5:{label:"Other",color:"bg-gray-500/20 text-gray-400",icon:"ðŸ“"}},f={0:{label:"Open",color:"bg-green-500/20 text-green-400 border-green-500/30"},1:{label:"In Progress",color:"bg-blue-500/20 text-blue-400 border-blue-500/30"},2:{label:"Under Review",color:"bg-purple-500/20 text-purple-400 border-purple-500/30"},3:{label:"Resolved",color:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30"},4:{label:"Closed",color:"bg-gray-500/20 text-gray-400 border-gray-500/30"},5:{label:"Won't Fix",color:"bg-red-500/20 text-red-400 border-red-500/30"},6:{label:"Duplicate",color:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"}},I={0:"border-l-gray-500",1:"border-l-blue-500",2:"border-l-orange-500",3:"border-l-red-500"},F=[{value:"newest",label:"Newest"},{value:"oldest",label:"Oldest"},{value:"votes",label:"Most Voted"},{value:"comments",label:"Most Comments"},{value:"updated",label:"Recently Updated"}];function D({issue:t,onVote:o,votingId:p}){const l=P(),r=j[t.type]||j[5],c=f[t.status]||f[0],x=I[t.priority]||I[1];return e.jsx($.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`bg-gray-800/50 rounded-xl p-4 border border-gray-700/50 hover:border-purple-500/30 transition-all cursor-pointer border-l-4 ${x}`,onClick:()=>l(`/issues/${t.issueNumber}`),children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("button",{onClick:d=>{d.stopPropagation(),o(t.id)},disabled:p===t.id,className:`flex flex-col items-center justify-center w-12 h-16 rounded-lg transition-colors ${t.hasVoted?"bg-purple-600/30 text-purple-400":"bg-gray-700/50 text-gray-400 hover:bg-gray-700 hover:text-white"}`,children:[e.jsx(i.ChevronUp,{}),e.jsx("span",{className:"text-sm font-semibold",children:t.voteCount})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.isPinned&&e.jsx("span",{className:"text-yellow-400",title:"Pinned",children:e.jsx(i.Pin,{})}),t.isLocked&&e.jsx("span",{className:"text-gray-400",title:"Locked",children:e.jsx(i.Lock,{})}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full ${r.color}`,children:[r.icon," ",r.label]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full border ${c.color}`,children:c.label})]}),e.jsxs("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:["#",t.issueNumber]})]}),e.jsx("h3",{className:"font-semibold text-white mb-1 line-clamp-1",children:t.title}),e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2 mb-3",children:t.description}),t.labels&&t.labels.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:t.labels.map(d=>e.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full",style:{backgroundColor:`${d.color}20`,color:d.color},children:[d.icon," ",d.name]},d.id))}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["by ",e.jsx("span",{className:"text-gray-400",children:t.authorUsername||"Unknown"})]}),e.jsx("span",{children:W(new Date(t.createdAt),{addSuffix:!0})}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(i.Comment,{}),t.commentCount]})]})]})]})})}function B({filters:t,setFilters:o,labels:p,stats:l}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700/50",children:[e.jsx("h3",{className:"font-semibold text-white mb-3",children:"Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"bg-gray-700/30 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-white",children:l.totalIssues||0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Total"})]}),e.jsxs("div",{className:"bg-green-500/10 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-green-400",children:l.openIssues||0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Open"})]}),e.jsxs("div",{className:"bg-emerald-500/10 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-emerald-400",children:l.resolvedIssues||0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Resolved"})]}),e.jsxs("div",{className:"bg-purple-500/10 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-purple-400",children:l.totalVotes||0}),e.jsx("div",{className:"text-xs text-gray-400",children:"Votes"})]})]})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700/50",children:[e.jsx("h3",{className:"font-semibold text-white mb-3",children:"Status"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("button",{onClick:()=>o({...t,status:void 0}),className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-colors ${t.status===void 0?"bg-purple-600 text-white":"text-gray-300 hover:bg-gray-700"}`,children:"All Statuses"}),Object.entries(f).map(([r,{label:c,color:x}])=>e.jsx("button",{onClick:()=>o({...t,status:parseInt(r)}),className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-colors ${t.status===parseInt(r)?"bg-purple-600 text-white":"text-gray-300 hover:bg-gray-700"}`,children:c},r))]})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700/50",children:[e.jsx("h3",{className:"font-semibold text-white mb-3",children:"Type"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("button",{onClick:()=>o({...t,type:void 0}),className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-colors ${t.type===void 0?"bg-purple-600 text-white":"text-gray-300 hover:bg-gray-700"}`,children:"All Types"}),Object.entries(j).map(([r,{label:c,icon:x}])=>e.jsxs("button",{onClick:()=>o({...t,type:parseInt(r)}),className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-colors ${t.type===parseInt(r)?"bg-purple-600 text-white":"text-gray-300 hover:bg-gray-700"}`,children:[x," ",c]},r))]})]}),p.length>0&&e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700/50",children:[e.jsx("h3",{className:"font-semibold text-white mb-3",children:"Labels"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("button",{onClick:()=>o({...t,labelSlug:void 0}),className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-colors ${t.labelSlug?"text-gray-300 hover:bg-gray-700":"bg-purple-600 text-white"}`,children:"All Labels"}),p.map(r=>e.jsxs("button",{onClick:()=>o({...t,labelSlug:r.slug}),className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-colors flex items-center gap-2 ${t.labelSlug===r.slug?"bg-purple-600 text-white":"text-gray-300 hover:bg-gray-700"}`,children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:r.color}}),r.name]},r.slug))]})]})]})}function X(){const{token:t}=z(),{user:o}=E(),p=P(),[l]=R(),[r,c]=n.useState([]),[x,d]=n.useState([]),[v,M]=n.useState({}),[N,w]=n.useState(!0),[u,O]=n.useState(0),[T,k]=n.useState(null),[S,C]=n.useState(!1),[s,h]=n.useState({status:l.get("status")?parseInt(l.get("status")):void 0,type:l.get("type")?parseInt(l.get("type")):void 0,labelSlug:l.get("label")||void 0,search:l.get("q")||"",sortBy:l.get("sort")||"newest",offset:0,limit:20});n.useEffect(()=>{Promise.all([fetch("/api/issues/labels").then(a=>a.json()),fetch("/api/issues/stats").then(a=>a.json())]).then(([a,b])=>{d(a.data||[]),M(b.data||{})}).catch(console.error)},[]),n.useEffect(()=>{V()},[s.status,s.type,s.labelSlug,s.search,s.sortBy,s.offset]);const V=async()=>{w(!0);try{const a=new URLSearchParams;s.status!==void 0&&a.set("status",s.status.toString()),s.type!==void 0&&a.set("type",s.type.toString()),s.labelSlug&&a.set("labelSlug",s.labelSlug),s.search&&a.set("search",s.search),s.sortBy&&a.set("sortBy",s.sortBy),a.set("limit",s.limit.toString()),a.set("offset",s.offset.toString());const b=t?{Authorization:`Bearer ${t}`}:{},m=await(await fetch(`/api/issues?${a}`,{headers:b})).json();c(m.data||[]),O(m.pagination?.total||0)}catch{}finally{w(!1)}},A=async a=>{if(!t){p("/login");return}k(a);try{const y=await(await fetch(`/api/issues/${a}/vote`,{method:"POST",headers:{Authorization:`Bearer ${t}`}})).json();y.data&&c(r.map(m=>m.id===a?{...m,hasVoted:y.data.voted,voteCount:y.data.voteCount}:m))}catch{}finally{k(null)}},U=a=>{a.preventDefault(),h({...s,offset:0})};return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white pb-24",children:[e.jsx("header",{className:"bg-gray-800 border-b border-gray-700 sticky top-0 z-20",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(g,{to:"/dashboard",className:"text-gray-400 hover:text-white flex items-center gap-2",children:[e.jsx(i.Back,{}),e.jsx("span",{className:"hidden sm:inline",children:"Back"})]}),e.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ›"}),e.jsx("span",{children:"Issues & Feedback"})]}),o&&e.jsxs(g,{to:"/issues/new",className:"bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 transition-colors",children:[e.jsx(i.Plus,{}),e.jsx("span",{className:"hidden sm:inline",children:"New Issue"})]}),!o&&e.jsx("div",{className:"w-24"})]})})}),e.jsx("div",{className:"bg-gray-800/50 border-b border-gray-700/50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-1",children:[e.jsx(g,{to:"/updates",className:"flex items-center gap-2 bg-blue-600/20 hover:bg-blue-600/30 px-4 py-2 rounded-full whitespace-nowrap text-sm font-medium text-blue-400 transition-colors",children:"ðŸ“¢ Dev Updates"}),e.jsx(g,{to:"/roadmap",className:"flex items-center gap-2 bg-green-600/20 hover:bg-green-600/30 px-4 py-2 rounded-full whitespace-nowrap text-sm font-medium text-green-400 transition-colors",children:"ðŸ—ºï¸ Roadmap"}),o&&e.jsx(g,{to:"/my-issues",className:"flex items-center gap-2 bg-purple-600/20 hover:bg-purple-600/30 px-4 py-2 rounded-full whitespace-nowrap text-sm font-medium text-purple-400 transition-colors",children:"ðŸ“‹ My Issues"})]})})}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsx("aside",{className:"hidden lg:block w-64 flex-shrink-0",children:e.jsx(B,{filters:s,setFilters:a=>h({...a,offset:0}),labels:x,stats:v})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[e.jsx("form",{onSubmit:U,className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(i.Search,{}),e.jsx("input",{type:"text",placeholder:"Search issues...",value:s.search,onChange:a=>h({...s,search:a.target.value}),className:"w-full bg-gray-800 border border-gray-700 rounded-lg pl-10 pr-4 py-2 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500",style:{paddingLeft:"2.5rem"}}),e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:e.jsx(i.Search,{})})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>C(!S),className:"lg:hidden bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 flex items-center gap-2 text-gray-300 hover:text-white",children:[e.jsx(i.Filter,{}),"Filters"]}),e.jsx("select",{value:s.sortBy,onChange:a=>h({...s,sortBy:a.target.value,offset:0}),className:"bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-purple-500",children:F.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]})]}),e.jsx(L,{children:S&&e.jsx($.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"lg:hidden mb-6 overflow-hidden",children:e.jsx(B,{filters:s,setFilters:a=>{h({...a,offset:0}),C(!1)},labels:x,stats:v})})}),e.jsx("div",{className:"text-sm text-gray-400 mb-4",children:N?"Loading...":`${u} issue${u!==1?"s":""} found`}),e.jsx("div",{className:"space-y-3",children:N?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Loading issues..."})]}):r.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-800/30 rounded-xl",children:[e.jsx("p",{className:"text-4xl mb-4",children:"ðŸ”"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"No issues found"}),e.jsx("p",{className:"text-gray-400 mb-4",children:s.search?"Try adjusting your search or filters":"Be the first to report an issue!"}),o&&e.jsxs(g,{to:"/issues/new",className:"inline-flex items-center gap-2 bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:[e.jsx(i.Plus,{}),"Create Issue"]})]}):e.jsx(L,{children:r.map(a=>e.jsx(D,{issue:a,onVote:A,votingId:T},a.id))})}),u>s.limit&&e.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[e.jsx("button",{onClick:()=>h({...s,offset:Math.max(0,s.offset-s.limit)}),disabled:s.offset===0,className:"px-4 py-2 bg-gray-800 rounded-lg text-gray-300 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsxs("span",{className:"px-4 py-2 text-gray-400",children:["Page ",Math.floor(s.offset/s.limit)+1," of ",Math.ceil(u/s.limit)]}),e.jsx("button",{onClick:()=>h({...s,offset:s.offset+s.limit}),disabled:s.offset+s.limit>=u,className:"px-4 py-2 bg-gray-800 rounded-lg text-gray-300 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})})]})}export{X as default};
