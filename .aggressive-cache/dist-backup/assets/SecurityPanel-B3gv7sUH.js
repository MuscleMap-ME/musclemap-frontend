import{r as l,j as e}from"./react-vendor-D1NxaRNd.js";import{G as j}from"./GlassSurface-BMiMerMg.js";import{L as I}from"./loader-circle-DGfqWrRz.js";import{c as me,ab as K,p as Y,P as he,b0 as ge,a3 as E,a_ as L,b8 as M}from"./index-DbqQayjh.js";import{R as ue}from"./refresh-cw-BfYV3Ubh.js";import{T as R}from"./triangle-alert-Bb4S_4va.js";import{M as $}from"./monitor-BV9G_n3F.js";import{B as f}from"./ban-Pir0iMqd.js";import{S as T}from"./shield-check-DGiTqrH4.js";import{S as Q}from"./shield-alert-mNzTvWJA.js";import{C as N}from"./chevron-down--Bls2GDe.js";import{C as w}from"./chevron-right-D3HHCYq-.js";import{L as pe}from"./lock-C2eBBeJR.js";import{C as Z}from"./circle-check-big-CBlsy3aJ.js";import{E as be}from"./eye-Dz69ydPN.js";import{C as je}from"./circle-x-DH5nulAB.js";import{T as fe}from"./trash-2-BKtxnKhq.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./recharts-vendor-BziRPEEi.js";import"./d3-vendor-mcDw60ct.js";import"./apollo-vendor-D9c7jRvS.js";import"./reactflow-vendor-Dz2P_-Qa.js";const Ne=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],we=me("log-out",Ne),m="/api/admin/security",y={critical:{bg:"bg-red-500/20",text:"text-red-400",border:"border-red-500/30"},high:{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500/30"},medium:{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500/30"},low:{bg:"bg-blue-500/20",text:"text-blue-400",border:"border-blue-500/30"},info:{bg:"bg-gray-500/20",text:"text-gray-400",border:"border-gray-500/30"}};function v(s){if(!s)return"N/A";const r=new Date(s),a=new Date-r,c=Math.floor(a/6e4),u=Math.floor(a/36e5),o=Math.floor(a/864e5);return c<1?"Just now":c<60?`${c}m ago`:u<24?`${u}h ago`:o<7?`${o}d ago`:r.toLocaleDateString()}function ye(s){return s?new Date(s).toLocaleString():"N/A"}function A({icon:s,label:r,value:i,color:a,alert:c}){return e.jsxs("div",{className:`p-4 rounded-lg ${c?"bg-red-500/10 border border-red-500/30":"bg-white/5"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(s,{className:`w-5 h-5 ${a||"text-gray-400"}`}),c&&e.jsx(R,{className:"w-4 h-4 text-red-400 animate-pulse"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:i}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:r})]})}function ve({attempt:s,onBlock:r}){return e.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"font-mono text-sm text-white",children:s.ip})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-300",children:s.username||"Unknown"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-xs text-gray-400",children:v(s.timestamp)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${s.attempts>5?"bg-red-500/20 text-red-400":s.attempts>3?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"}`,children:[s.attempts," attempt",s.attempts!==1?"s":""]})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{onClick:()=>r(s.ip),className:"p-1.5 rounded bg-red-500/20 hover:bg-red-500/30 text-red-400 transition-colors",title:"Block IP",children:e.jsx(f,{className:"w-4 h-4"})})})]})}function ke({session:s,onTerminate:r,isCurrentSession:i}){return e.jsxs("div",{className:`p-4 rounded-lg border ${i?"bg-green-500/10 border-green-500/30":"bg-white/5 border-white/10"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${i?"bg-green-500/20":"bg-white/10"}`,children:e.jsx($,{className:`w-5 h-5 ${i?"text-green-400":"text-gray-400"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-white flex items-center gap-2",children:[s.device||"Unknown Device",i&&e.jsx("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-0.5 rounded",children:"Current"})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:[s.browser||"Unknown Browser"," - ",s.os||"Unknown OS"]})]})]}),!i&&e.jsx("button",{onClick:()=>r(s.id),className:"p-1.5 rounded bg-red-500/20 hover:bg-red-500/30 text-red-400 transition-colors",title:"Terminate Session",children:e.jsx(we,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-xs text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-3 h-3"}),s.ip||"Unknown IP"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{className:"w-3 h-3"}),"Last active: ",v(s.lastActive)]}),s.location&&e.jsx("div",{children:s.location})]})]})}function Se({item:s,onUnblock:r}){return e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5 border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-red-500/20 flex items-center justify-center",children:e.jsx(f,{className:"w-4 h-4 text-red-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono text-sm text-white",children:s.ip}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Blocked ",v(s.blockedAt)," - ",s.reason||"No reason provided"]})]})]}),e.jsx("button",{onClick:()=>r(s.ip),className:"p-1.5 rounded bg-white/10 hover:bg-white/20 text-gray-400 transition-colors",title:"Unblock IP",children:e.jsx(fe,{className:"w-4 h-4"})})]})}function Ce({entry:s}){const r=y[s.severity]||y.info;return e.jsxs("div",{className:`p-3 rounded-lg ${r.bg} border ${r.border}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.severity==="critical"||s.severity==="high"?e.jsx(Q,{className:`w-4 h-4 ${r.text}`}):e.jsx(K,{className:`w-4 h-4 ${r.text}`}),e.jsx("span",{className:`text-sm font-medium ${r.text}`,children:s.action})]}),e.jsx("span",{className:"text-xs text-gray-400",children:v(s.timestamp)})]}),e.jsx("div",{className:"mt-2 text-sm text-gray-300",children:s.details}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs text-gray-400",children:[s.ip&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-3 h-3"}),s.ip]}),s.user&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(M,{className:"w-3 h-3"}),s.user]})]})]})}function Ae({result:s}){const r=y[s.severity]||y.info;return e.jsxs("div",{className:`p-3 rounded-lg ${r.bg} border ${r.border}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:`text-sm font-medium ${r.text}`,children:s.title}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${r.bg} ${r.text}`,children:s.severity?.toUpperCase()})]}),e.jsx("div",{className:"text-sm text-gray-300",children:s.description}),s.recommendation&&e.jsxs("div",{className:"mt-2 text-xs text-gray-400",children:[e.jsx("span",{className:"font-medium",children:"Recommendation:"})," ",s.recommendation]})]})}function $e({alert:s,onDismiss:r,onInvestigate:i}){const a=y[s.severity]||y.medium;return e.jsxs("div",{className:`p-4 rounded-lg ${a.bg} border ${a.border}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:`w-5 h-5 ${a.text}`}),e.jsx("span",{className:`text-sm font-semibold ${a.text}`,children:s.type})]}),e.jsx("span",{className:"text-xs text-gray-400",children:v(s.timestamp)})]}),e.jsx("div",{className:"mt-2 text-sm text-gray-300",children:s.description}),e.jsxs("div",{className:"flex items-center gap-3 mt-3 text-xs text-gray-400",children:[s.ip&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-3 h-3"}),s.ip]}),s.user&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(M,{className:"w-3 h-3"}),s.user]})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsxs("button",{onClick:()=>i(s.id),className:"flex items-center gap-1 px-3 py-1.5 rounded bg-white/10 hover:bg-white/20 text-white text-xs transition-colors",children:[e.jsx(be,{className:"w-3 h-3"}),"Investigate"]}),e.jsxs("button",{onClick:()=>r(s.id),className:"flex items-center gap-1 px-3 py-1.5 rounded bg-white/5 hover:bg-white/10 text-gray-400 text-xs transition-colors",children:[e.jsx(je,{className:"w-3 h-3"}),"Dismiss"]})]})]})}function Ie({config:s,onSave:r,loading:i}){const[a,c]=l.useState({loginAttempts:s?.loginAttempts||5,loginWindow:s?.loginWindow||15,apiRequests:s?.apiRequests||100,apiWindow:s?.apiWindow||1,blockDuration:s?.blockDuration||60}),u=o=>{o.preventDefault(),r(a)};return e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Login Attempts"}),e.jsx("input",{type:"number",value:a.loginAttempts,onChange:o=>c({...a,loginAttempts:parseInt(o.target.value)}),className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white text-sm focus:border-cyan-500/50 focus:outline-none",min:"1",max:"20"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Login Window (minutes)"}),e.jsx("input",{type:"number",value:a.loginWindow,onChange:o=>c({...a,loginWindow:parseInt(o.target.value)}),className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white text-sm focus:border-cyan-500/50 focus:outline-none",min:"1",max:"60"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"API Requests/min"}),e.jsx("input",{type:"number",value:a.apiRequests,onChange:o=>c({...a,apiRequests:parseInt(o.target.value)}),className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white text-sm focus:border-cyan-500/50 focus:outline-none",min:"10",max:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"API Window (minutes)"}),e.jsx("input",{type:"number",value:a.apiWindow,onChange:o=>c({...a,apiWindow:parseInt(o.target.value)}),className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white text-sm focus:border-cyan-500/50 focus:outline-none",min:"1",max:"60"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Auto-block Duration (minutes)"}),e.jsx("input",{type:"number",value:a.blockDuration,onChange:o=>c({...a,blockDuration:parseInt(o.target.value)}),className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white text-sm focus:border-cyan-500/50 focus:outline-none",min:"5",max:"1440"})]}),e.jsxs("button",{type:"submit",disabled:i,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-cyan-500/20 hover:bg-cyan-500/30 text-cyan-400 transition-colors disabled:opacity-50",children:[i?e.jsx(I,{className:"w-4 h-4 animate-spin"}):e.jsx(Z,{className:"w-4 h-4"}),"Save Configuration"]})]})}function Re({isOpen:s,onClose:r,onAdd:i}){const[a,c]=l.useState(""),[u,o]=l.useState(""),[k,b]=l.useState(!1),P=async h=>{h.preventDefault(),a&&(b(!0),await i(a,u),b(!1),c(""),o(""),r())};return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-xl p-6 w-full max-w-md mx-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(f,{className:"w-5 h-5 text-red-400"}),"Block IP Address"]}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"IP Address *"}),e.jsx("input",{type:"text",value:a,onChange:h=>c(h.target.value),placeholder:"192.168.1.1 or 192.168.1.0/24",className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white text-sm focus:border-red-500/50 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Reason"}),e.jsx("input",{type:"text",value:u,onChange:h=>o(h.target.value),placeholder:"Optional reason for blocking",className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white text-sm focus:border-white/30 focus:outline-none"})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 rounded-lg bg-white/5 hover:bg-white/10 text-gray-400 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:k||!a,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg bg-red-500/20 hover:bg-red-500/30 text-red-400 transition-colors disabled:opacity-50",children:[k?e.jsx(I,{className:"w-4 h-4 animate-spin"}):e.jsx(f,{className:"w-4 h-4"}),"Block IP"]})]})]})]})}):null}function Ze(){const[s,r]=l.useState(!0),[i,a]=l.useState("alerts"),[c,u]=l.useState(null),[o,k]=l.useState([]),[b,P]=l.useState([]),[h,ee]=l.useState([]),[se,O]=l.useState(null),[U,te]=l.useState([]),[d,D]=l.useState(null),[S,F]=l.useState([]),[W,_]=l.useState(!1),[ae,q]=l.useState(!1),[ie,H]=l.useState(!1),x=l.useCallback(()=>{try{const t=localStorage.getItem("musclemap-auth");if(t){const p=JSON.parse(t);if(p?.state?.token)return{Authorization:`Bearer ${p.state.token}`}}const n=localStorage.getItem("musclemap_token");return n?{Authorization:`Bearer ${n}`}:{}}catch{return{}}},[]),g=l.useCallback(async()=>{try{const t=x(),[n,p,C,z,G,V,X]=await Promise.all([fetch(`${m}/stats`,{headers:t}),fetch(`${m}/login-attempts`,{headers:t}),fetch(`${m}/sessions`,{headers:t}),fetch(`${m}/blocklist`,{headers:t}),fetch(`${m}/rate-limits`,{headers:t}),fetch(`${m}/audit-log`,{headers:t}),fetch(`${m}/alerts`,{headers:t})]);n.ok&&u(await n.json()),p.ok&&k((await p.json()).attempts||[]),C.ok&&P((await C.json()).sessions||[]),z.ok&&ee((await z.json()).blocked||[]),G.ok&&O(await G.json()),V.ok&&te((await V.json()).entries||[]),X.ok&&F((await X.json()).alerts||[])}catch{}finally{r(!1)}},[x]),J=l.useCallback(async(t,n="Manual block")=>{try{(await fetch(`${m}/blocklist`,{method:"POST",headers:{"Content-Type":"application/json",...x()},body:JSON.stringify({ip:t,reason:n})})).ok&&g()}catch{}},[x,g]),re=l.useCallback(async t=>{try{(await fetch(`${m}/blocklist/${encodeURIComponent(t)}`,{method:"DELETE",headers:x()})).ok&&g()}catch{}},[x,g]),le=l.useCallback(async t=>{try{(await fetch(`${m}/sessions/${t}`,{method:"DELETE",headers:x()})).ok&&g()}catch{}},[x,g]),ne=l.useCallback(async t=>{q(!0);try{(await fetch(`${m}/rate-limits`,{method:"PUT",headers:{"Content-Type":"application/json",...x()},body:JSON.stringify(t)})).ok&&O(t)}catch{}finally{q(!1)}},[x]),ce=l.useCallback(async()=>{_(!0),D(null);try{const t=await fetch(`${m}/scan`,{method:"POST",headers:x()});if(t.ok){const n=await t.json();D(n)}}catch(t){D({error:t.message})}finally{_(!1)}},[x]),oe=l.useCallback(async t=>{try{(await fetch(`${m}/alerts/${t}/dismiss`,{method:"POST",headers:x()})).ok&&F(p=>p.filter(C=>C.id!==t))}catch{}},[x]),de=l.useCallback(t=>{a("audit")},[]);if(l.useEffect(()=>{g();const t=setInterval(g,3e4);return()=>clearInterval(t)},[g]),s)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(I,{className:"w-8 h-8 animate-spin text-cyan-400"})});const xe=localStorage.getItem("session_id"),B=S.filter(t=>t.severity==="critical"||t.severity==="high");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(K,{className:"w-6 h-6 text-red-400"}),"Security Panel"]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Monitor security events, manage access, and configure protection"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:ce,disabled:W,className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 text-red-400 transition-colors disabled:opacity-50",children:[W?e.jsx(I,{className:"w-4 h-4 animate-spin"}):e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Run Scan"})]}),e.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 transition-colors",children:[e.jsx(ue,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Refresh"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(A,{icon:R,label:"Failed Logins (24h)",value:c?.failedLogins24h||0,color:"text-red-400",alert:c?.failedLogins24h>50}),e.jsx(A,{icon:$,label:"Active Sessions",value:c?.activeSessions||b.length,color:"text-blue-400"}),e.jsx(A,{icon:f,label:"Blocked IPs",value:c?.blockedIPs||h.length,color:"text-yellow-400"}),e.jsx(A,{icon:T,label:"Security Score",value:c?.securityScore||"N/A",color:"text-green-400",alert:c?.securityScore&&c.securityScore<70})]}),B.length>0&&e.jsxs("div",{className:"p-4 rounded-lg bg-red-500/10 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Q,{className:"w-5 h-5 text-red-400"}),e.jsxs("span",{className:"text-sm font-semibold text-red-400",children:[B.length," Critical Alert",B.length!==1?"s":""," Require Attention"]})]}),e.jsx("div",{className:"text-sm text-gray-300",children:"There are active security alerts that need immediate review."})]}),S.length>0&&e.jsxs(j,{className:"p-4",children:[e.jsxs("button",{onClick:()=>a(i==="alerts"?"":"alerts"),className:"w-full flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-yellow-400"}),"Suspicious Activity (",S.length,")"]}),i==="alerts"?e.jsx(N,{className:"w-4 h-4 text-gray-400"}):e.jsx(w,{className:"w-4 h-4 text-gray-400"})]}),i==="alerts"&&e.jsx("div",{className:"space-y-3",children:S.map(t=>e.jsx($e,{alert:t,onDismiss:oe,onInvestigate:de},t.id))})]}),d&&e.jsxs(j,{className:"p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-white flex items-center gap-2 mb-3",children:[e.jsx(Y,{className:"w-4 h-4 text-cyan-400"}),"Scan Results",d.completedAt&&e.jsx("span",{className:"text-xs text-gray-400",children:ye(d.completedAt)})]}),d.error?e.jsxs("div",{className:"p-3 rounded-lg bg-red-500/10 border border-red-500/30 text-red-400 text-sm",children:["Scan failed: ",d.error]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg ${d.score>=80?"bg-green-500/20 text-green-400":d.score>=60?"bg-yellow-500/20 text-yellow-400":"bg-red-500/20 text-red-400"}`,children:[e.jsx(T,{className:"w-4 h-4"}),"Score: ",d.score||"N/A","/100"]}),e.jsxs("div",{className:"text-sm text-gray-400",children:[d.findings?.length||0," finding",(d.findings?.length||0)!==1?"s":""]})]}),d.findings?.length>0&&e.jsx("div",{className:"space-y-2",children:d.findings.map((t,n)=>e.jsx(Ae,{result:t},n))}),(!d.findings||d.findings.length===0)&&e.jsxs("div",{className:"text-center py-6 text-gray-400",children:[e.jsx(T,{className:"w-8 h-8 mx-auto mb-2 text-green-400"}),e.jsx("div",{className:"text-sm",children:"No security issues found"})]})]})]}),e.jsxs(j,{className:"p-4",children:[e.jsxs("button",{onClick:()=>a(i==="logins"?"":"logins"),className:"w-full flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-red-400"}),"Failed Login Attempts",o.length>0&&e.jsx("span",{className:"text-xs bg-red-500/20 text-red-400 px-2 py-0.5 rounded",children:o.length})]}),i==="logins"?e.jsx(N,{className:"w-4 h-4 text-gray-400"}):e.jsx(w,{className:"w-4 h-4 text-gray-400"})]}),i==="logins"&&e.jsx(e.Fragment,{children:o.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-gray-400 border-b border-white/10",children:[e.jsx("th",{className:"px-4 py-2",children:"IP Address"}),e.jsx("th",{className:"px-4 py-2",children:"Username"}),e.jsx("th",{className:"px-4 py-2",children:"Time"}),e.jsx("th",{className:"px-4 py-2",children:"Attempts"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Actions"})]})}),e.jsx("tbody",{children:o.map((t,n)=>e.jsx(ve,{attempt:t,onBlock:J},n))})]})}):e.jsxs("div",{className:"text-center py-6 text-gray-400",children:[e.jsx(Z,{className:"w-8 h-8 mx-auto mb-2 text-green-400"}),e.jsx("div",{className:"text-sm",children:"No failed login attempts"})]})})]}),e.jsxs(j,{className:"p-4",children:[e.jsxs("button",{onClick:()=>a(i==="sessions"?"":"sessions"),className:"w-full flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4 text-blue-400"}),"Active Sessions (",b.length,")"]}),i==="sessions"?e.jsx(N,{className:"w-4 h-4 text-gray-400"}):e.jsx(w,{className:"w-4 h-4 text-gray-400"})]}),i==="sessions"&&e.jsx("div",{className:"space-y-3",children:b.length>0?b.map(t=>e.jsx(ke,{session:t,isCurrentSession:t.id===xe,onTerminate:le},t.id)):e.jsxs("div",{className:"text-center py-6 text-gray-400",children:[e.jsx($,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("div",{className:"text-sm",children:"No active sessions"})]})})]}),e.jsxs(j,{className:"p-4",children:[e.jsxs("button",{onClick:()=>a(i==="blocked"?"":"blocked"),className:"w-full flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[e.jsx(f,{className:"w-4 h-4 text-yellow-400"}),"IP Blocklist (",h.length,")"]}),i==="blocked"?e.jsx(N,{className:"w-4 h-4 text-gray-400"}):e.jsx(w,{className:"w-4 h-4 text-gray-400"})]}),i==="blocked"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-3",children:e.jsxs("button",{onClick:()=>H(!0),className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-red-500/20 hover:bg-red-500/30 text-red-400 transition-colors",children:[e.jsx(he,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Add IP to Blocklist"})]})}),e.jsx("div",{className:"space-y-2",children:h.length>0?h.map((t,n)=>e.jsx(Se,{item:t,onUnblock:re},n)):e.jsxs("div",{className:"text-center py-6 text-gray-400",children:[e.jsx(f,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("div",{className:"text-sm",children:"No blocked IPs"})]})})]})]}),e.jsxs(j,{className:"p-4",children:[e.jsxs("button",{onClick:()=>a(i==="ratelimit"?"":"ratelimit"),className:"w-full flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-purple-400"}),"Rate Limit Configuration"]}),i==="ratelimit"?e.jsx(N,{className:"w-4 h-4 text-gray-400"}):e.jsx(w,{className:"w-4 h-4 text-gray-400"})]}),i==="ratelimit"&&e.jsx(Ie,{config:se,onSave:ne,loading:ae})]}),e.jsxs(j,{className:"p-4",children:[e.jsxs("button",{onClick:()=>a(i==="audit"?"":"audit"),className:"w-full flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-green-400"}),"Security Audit Log"]}),i==="audit"?e.jsx(N,{className:"w-4 h-4 text-gray-400"}):e.jsx(w,{className:"w-4 h-4 text-gray-400"})]}),i==="audit"&&e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:U.length>0?U.map((t,n)=>e.jsx(Ce,{entry:t},n)):e.jsxs("div",{className:"text-center py-6 text-gray-400",children:[e.jsx(E,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("div",{className:"text-sm",children:"No audit log entries"})]})})]}),e.jsx(Re,{isOpen:ie,onClose:()=>H(!1),onAdd:J})]})}export{Ze as default};
