import{r as p,a as m}from"./react-vendor-D847gc3Q.js";import{zoomIdentity as ke,zoom as Sn,select as Rt,pointer as bn,drag as es}from"./d3-vendor-mcDw60ct.js";const ts={},Kt=e=>{let t;const n=new Set,o=(a,d)=>{const g=typeof a=="function"?a(t):a;if(!Object.is(g,t)){const f=t;t=d??(typeof g!="object"||g===null)?g:Object.assign({},t,g),n.forEach(E=>E(t,f))}},s=()=>t,l={setState:o,getState:s,getInitialState:()=>u,subscribe:a=>(n.add(a),()=>n.delete(a)),destroy:()=>{n.clear()}},u=t=e(o,s,l);return l},ns=e=>e?Kt(e):Kt;function os(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}const ss=typeof Object.is=="function"?Object.is:os;function rs(e,t,n,o,s){const i=p.useMemo(()=>{let c=!1,l,u;return()=>{const a=t();if(!c)return c=!0,l=a,u=o(a),u;if(ss(l,a))return u;const d=o(a);return s!==void 0&&s(u,d)?(l=a,u):(l=a,u=d,d)}},[t,o,s]),r=p.useCallback(()=>i(),[i]);return p.useSyncExternalStore(e,r,n===void 0?void 0:()=>o(n()))}const is={useSyncExternalStoreWithSelector:rs};function ie(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=ie(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const{useDebugValue:cs}=m,{useSyncExternalStoreWithSelector:as}=is,ls=e=>e;function Nn(e,t=ls,n){const o=as(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return cs(o),o}const qt=(e,t)=>{const n=ns(e),o=(s,i=t)=>Nn(n,s,i);return Object.assign(o,n),o},ds=(e,t)=>e?qt(e,t):qt;function se(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const ft=p.createContext(null),us=ft.Provider,xe={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},vn=xe.error001();function j(e,t){const n=p.useContext(ft);if(n===null)throw new Error(vn);return Nn(n,e,t)}const oe=()=>{const e=p.useContext(ft);if(e===null)throw new Error(vn);return p.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},fs=e=>e.userSelectionActive?"none":"all";function Dt({position:e,children:t,className:n,style:o,...s}){const i=j(fs),r=`${e}`.split("-");return m.createElement("div",{className:ie(["react-flow__panel",n,...r]),style:{...o,pointerEvents:i},...s},t)}function gs({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:m.createElement(Dt,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},m.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const hs=({x:e,y:t,label:n,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:i={},labelBgPadding:r=[2,4],labelBgBorderRadius:c=2,children:l,className:u,...a})=>{const d=p.useRef(null),[g,f]=p.useState({x:0,y:0,width:0,height:0}),E=ie(["react-flow__edge-textwrapper",u]);return p.useEffect(()=>{if(d.current){const h=d.current.getBBox();f({x:h.x,y:h.y,width:h.width,height:h.height})}},[n]),typeof n>"u"||!n?null:m.createElement("g",{transform:`translate(${e-g.width/2} ${t-g.height/2})`,className:E,visibility:g.width?"visible":"hidden",...a},s&&m.createElement("rect",{width:g.width+2*r[0],x:-r[0],y:-r[1],height:g.height+2*r[1],className:"react-flow__edge-textbg",style:i,rx:c,ry:c}),m.createElement("text",{className:"react-flow__edge-text",y:g.height/2,dy:"0.3em",ref:d,style:o},n),l)};var ps=p.memo(hs);const Tt=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ue=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),zt=(e={x:0,y:0},t)=>({x:Ue(e.x,t[0][0],t[1][0]),y:Ue(e.y,t[0][1],t[1][1])}),jt=(e,t,n)=>e<t?Ue(Math.abs(e-t),1,50)/50:e>n?-Ue(Math.abs(e-n),1,50)/50:0,Cn=(e,t)=>{const n=jt(e.x,35,t.width-35)*20,o=jt(e.y,35,t.height-35)*20;return[n,o]},Mn=e=>e.getRootNode?.()||window?.document,An=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),et=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),$n=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Qt=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),ms=(e,t)=>$n(An(et(e),et(t))),Ct=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},ys=e=>fe(e.width)&&fe(e.height)&&fe(e.x)&&fe(e.y),fe=e=>!isNaN(e)&&isFinite(e),Q=Symbol.for("internals"),In=["Enter"," ","Escape"],xs=(e,t)=>{},Es=e=>"nativeEvent"in e;function Mt(e){const n=(Es(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n?.nodeName)||n?.hasAttribute("contenteditable")||!!n?.closest(".nokey")}const _n=e=>"clientX"in e,be=(e,t)=>{const n=_n(e),o=n?e.clientX:e.touches?.[0].clientX,s=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:s-(t?.top??0)}},at=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0,ot=({id:e,path:t,labelX:n,labelY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:g,interactionWidth:f=20})=>m.createElement(m.Fragment,null,m.createElement("path",{id:e,style:a,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:g}),f&&m.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}),s&&fe(n)&&fe(o)?m.createElement(ps,{x:n,y:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u}):null);ot.displayName="BaseEdge";function qe(e,t,n){return n===void 0?n:o=>{const s=t().edges.find(i=>i.id===e);s&&n(o,{...s})}}function kn({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,i=n<e?n+s:n-s,r=Math.abs(o-t)/2,c=o<t?o+r:o-r;return[i,c,s,r]}function Hn({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:i,targetControlX:r,targetControlY:c}){const l=e*.125+s*.375+r*.375+n*.125,u=t*.125+i*.375+c*.375+o*.125,a=Math.abs(l-e),d=Math.abs(u-t);return[l,u,a,d]}var Re;(function(e){e.Strict="strict",e.Loose="loose"})(Re||(Re={}));var _e;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(_e||(_e={}));var tt;(function(e){e.Partial="partial",e.Full="full"})(tt||(tt={}));var Se;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Se||(Se={}));var lt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(lt||(lt={}));var O;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(O||(O={}));function Jt({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===O.Left||e===O.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function Rn({sourceX:e,sourceY:t,sourcePosition:n=O.Bottom,targetX:o,targetY:s,targetPosition:i=O.Top}){const[r,c]=Jt({pos:n,x1:e,y1:t,x2:o,y2:s}),[l,u]=Jt({pos:i,x1:o,y1:s,x2:e,y2:t}),[a,d,g,f]=Hn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:r,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${r},${c} ${l},${u} ${o},${s}`,a,d,g,f]}const Pt=p.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=O.Bottom,targetPosition:i=O.Top,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:g,markerEnd:f,markerStart:E,interactionWidth:h})=>{const[y,x,w]=Rn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i});return m.createElement(ot,{path:y,labelX:x,labelY:w,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:g,markerEnd:f,markerStart:E,interactionWidth:h})});Pt.displayName="SimpleBezierEdge";const en={[O.Left]:{x:-1,y:0},[O.Right]:{x:1,y:0},[O.Top]:{x:0,y:-1},[O.Bottom]:{x:0,y:1}},ws=({source:e,sourcePosition:t=O.Bottom,target:n})=>t===O.Left||t===O.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},tn=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Ss({source:e,sourcePosition:t=O.Bottom,target:n,targetPosition:o=O.Top,center:s,offset:i}){const r=en[t],c=en[o],l={x:e.x+r.x*i,y:e.y+r.y*i},u={x:n.x+c.x*i,y:n.y+c.y*i},a=ws({source:l,sourcePosition:t,target:u}),d=a.x!==0?"x":"y",g=a[d];let f=[],E,h;const y={x:0,y:0},x={x:0,y:0},[w,N,C,I]=kn({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(r[d]*c[d]===-1){E=s.x??w,h=s.y??N;const B=[{x:E,y:l.y},{x:E,y:u.y}],D=[{x:l.x,y:h},{x:u.x,y:h}];r[d]===g?f=d==="x"?B:D:f=d==="x"?D:B}else{const B=[{x:l.x,y:u.y}],D=[{x:u.x,y:l.y}];if(d==="x"?f=r.x===g?D:B:f=r.y===g?B:D,t===o){const M=Math.abs(e[d]-n[d]);if(M<=i){const S=Math.min(i-1,i-M);r[d]===g?y[d]=(l[d]>e[d]?-1:1)*S:x[d]=(u[d]>n[d]?-1:1)*S}}if(t!==o){const M=d==="x"?"y":"x",S=r[d]===c[M],$=l[M]>u[M],z=l[M]<u[M];(r[d]===1&&(!S&&$||S&&z)||r[d]!==1&&(!S&&z||S&&$))&&(f=d==="x"?B:D)}const v={x:l.x+y.x,y:l.y+y.y},_={x:u.x+x.x,y:u.y+x.y},k=Math.max(Math.abs(v.x-f[0].x),Math.abs(_.x-f[0].x)),H=Math.max(Math.abs(v.y-f[0].y),Math.abs(_.y-f[0].y));k>=H?(E=(v.x+_.x)/2,h=f[0].y):(E=f[0].x,h=(v.y+_.y)/2)}return[[e,{x:l.x+y.x,y:l.y+y.y},...f,{x:u.x+x.x,y:u.y+x.y},n],E,h,C,I]}function bs(e,t,n,o){const s=Math.min(tn(e,t)/2,tn(t,n)/2,o),{x:i,y:r}=t;if(e.x===i&&i===n.x||e.y===r&&r===n.y)return`L${i} ${r}`;if(e.y===r){const u=e.x<n.x?-1:1,a=e.y<n.y?1:-1;return`L ${i+s*u},${r}Q ${i},${r} ${i},${r+s*a}`}const c=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${r+s*l}Q ${i},${r} ${i+s*c},${r}`}function At({sourceX:e,sourceY:t,sourcePosition:n=O.Bottom,targetX:o,targetY:s,targetPosition:i=O.Top,borderRadius:r=5,centerX:c,centerY:l,offset:u=20}){const[a,d,g,f,E]=Ss({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:i,center:{x:c,y:l},offset:u});return[a.reduce((y,x,w)=>{let N="";return w>0&&w<a.length-1?N=bs(a[w-1],x,a[w+1],r):N=`${w===0?"M":"L"}${x.x} ${x.y}`,y+=N,y},""),d,g,f,E]}const gt=p.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,sourcePosition:d=O.Bottom,targetPosition:g=O.Top,markerEnd:f,markerStart:E,pathOptions:h,interactionWidth:y})=>{const[x,w,N]=At({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:o,targetPosition:g,borderRadius:h?.borderRadius,offset:h?.offset});return m.createElement(ot,{path:x,labelX:w,labelY:N,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:f,markerStart:E,interactionWidth:y})});gt.displayName="SmoothStepEdge";const Bt=p.memo(e=>m.createElement(gt,{...e,pathOptions:p.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));Bt.displayName="StepEdge";function Ns({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,i,r,c]=kn({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,i,r,c]}const Vt=p.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:g,interactionWidth:f})=>{const[E,h,y]=Ns({sourceX:e,sourceY:t,targetX:n,targetY:o});return m.createElement(ot,{path:E,labelX:h,labelY:y,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:g,interactionWidth:f})});Vt.displayName="StraightEdge";function st(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function nn({pos:e,x1:t,y1:n,x2:o,y2:s,c:i}){switch(e){case O.Left:return[t-st(t-o,i),n];case O.Right:return[t+st(o-t,i),n];case O.Top:return[t,n-st(n-s,i)];case O.Bottom:return[t,n+st(s-n,i)]}}function Dn({sourceX:e,sourceY:t,sourcePosition:n=O.Bottom,targetX:o,targetY:s,targetPosition:i=O.Top,curvature:r=.25}){const[c,l]=nn({pos:n,x1:e,y1:t,x2:o,y2:s,c:r}),[u,a]=nn({pos:i,x1:o,y1:s,x2:e,y2:t,c:r}),[d,g,f,E]=Hn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:c,sourceControlY:l,targetControlX:u,targetControlY:a});return[`M${e},${t} C${c},${l} ${u},${a} ${o},${s}`,d,g,f,E]}const dt=p.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=O.Bottom,targetPosition:i=O.Top,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:g,markerEnd:f,markerStart:E,pathOptions:h,interactionWidth:y})=>{const[x,w,N]=Dn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i,curvature:h?.curvature});return m.createElement(ot,{path:x,labelX:w,labelY:N,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:g,markerEnd:f,markerStart:E,interactionWidth:y})});dt.displayName="BezierEdge";const Ot=p.createContext(null),vs=Ot.Provider;Ot.Consumer;const Cs=()=>p.useContext(Ot),Ms=e=>"id"in e&&"source"in e&&"target"in e,As=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${n}${o||""}`,$t=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,$s=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Is=(e,t)=>{if(!e.source||!e.target)return t;let n;return Ms(e)?n={...e}:n={...e,id:As(e)},$s(n,t)?t:t.concat(n)},It=({x:e,y:t},[n,o,s],i,[r,c])=>{const l={x:(e-n)/s,y:(t-o)/s};return i?{x:r*Math.round(l.x/r),y:c*Math.round(l.y/c)}:l},Tn=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o}),He=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],o=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-o};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-o}:s}},ht=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const{x:i,y:r}=He(s,t).positionAbsolute;return An(o,et({x:i,y:r,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return $n(n)},zn=(e,t,[n,o,s]=[0,0,1],i=!1,r=!1,c=[0,0])=>{const l={x:(t.x-n)/s,y:(t.y-o)/s,width:t.width/s,height:t.height/s},u=[];return e.forEach(a=>{const{width:d,height:g,selectable:f=!0,hidden:E=!1}=a;if(r&&!f||E)return!1;const{positionAbsolute:h}=He(a,c),y={x:h.x,y:h.y,width:d||0,height:g||0},x=Ct(l,y),w=typeof d>"u"||typeof g>"u"||d===null||g===null,N=i&&x>0,C=(d||0)*(g||0);(w||N||x>=C||a.dragging)&&u.push(a)}),u},Pn=(e,t)=>{const n=e.map(o=>o.id);return t.filter(o=>n.includes(o.source)||n.includes(o.target))},Bn=(e,t,n,o,s,i=.1)=>{const r=t/(e.width*(1+i)),c=n/(e.height*(1+i)),l=Math.min(r,c),u=Ue(l,o,s),a=e.x+e.width/2,d=e.y+e.height/2,g=t/2-a*u,f=n/2-d*u;return{x:g,y:f,zoom:u}},Ie=(e,t=0)=>e.transition().duration(t);function on(e,t,n,o){return(t[n]||[]).reduce((s,i)=>(`${e.id}-${i.id}-${n}`!==o&&s.push({id:i.id||null,type:n,nodeId:e.id,x:(e.positionAbsolute?.x??0)+i.x+i.width/2,y:(e.positionAbsolute?.y??0)+i.y+i.height/2}),s),[])}function _s(e,t,n,o,s,i){const{x:r,y:c}=be(e),u=t.elementsFromPoint(r,c).find(E=>E.classList.contains("react-flow__handle"));if(u){const E=u.getAttribute("data-nodeid");if(E){const h=Lt(void 0,u),y=u.getAttribute("data-handleid"),x=i({nodeId:E,id:y,type:h});if(x){const w=s.find(N=>N.nodeId===E&&N.type===h&&N.id===y);return{handle:{id:y,type:h,nodeId:E,x:w?.x||n.x,y:w?.y||n.y},validHandleResult:x}}}}let a=[],d=1/0;if(s.forEach(E=>{const h=Math.sqrt((E.x-n.x)**2+(E.y-n.y)**2);if(h<=o){const y=i(E);h<=d&&(h<d?a=[{handle:E,validHandleResult:y}]:h===d&&a.push({handle:E,validHandleResult:y}),d=h)}}),!a.length)return{handle:null,validHandleResult:Vn()};if(a.length===1)return a[0];const g=a.some(({validHandleResult:E})=>E.isValid),f=a.some(({handle:E})=>E.type==="target");return a.find(({handle:E,validHandleResult:h})=>f?E.type==="target":g?h.isValid:!0)||a[0]}const ks={source:null,target:null,sourceHandle:null,targetHandle:null},Vn=()=>({handleDomNode:null,isValid:!1,connection:ks,endHandle:null});function On(e,t,n,o,s,i,r){const c=s==="target",l=r.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),u={...Vn(),handleDomNode:l};if(l){const a=Lt(void 0,l),d=l.getAttribute("data-nodeid"),g=l.getAttribute("data-handleid"),f=l.classList.contains("connectable"),E=l.classList.contains("connectableend"),h={source:c?d:n,sourceHandle:c?g:o,target:c?n:d,targetHandle:c?o:g};u.connection=h,f&&E&&(t===Re.Strict?c&&a==="source"||!c&&a==="target":d!==n||g!==o)&&(u.endHandle={nodeId:d,handleId:g,type:a},u.isValid=i(h))}return u}function Hs({nodes:e,nodeId:t,handleId:n,handleType:o}){return e.reduce((s,i)=>{if(i[Q]){const{handleBounds:r}=i[Q];let c=[],l=[];r&&(c=on(i,r,"source",`${t}-${n}-${o}`),l=on(i,r,"target",`${t}-${n}-${o}`)),s.push(...c,...l)}return s},[])}function Lt(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Et(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function Rs(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Ln({event:e,handleId:t,nodeId:n,onConnect:o,isTarget:s,getState:i,setState:r,isValidConnection:c,edgeUpdaterType:l,onReconnectEnd:u}){const a=Mn(e.target),{connectionMode:d,domNode:g,autoPanOnConnect:f,connectionRadius:E,onConnectStart:h,panBy:y,getNodes:x,cancelConnection:w}=i();let N=0,C;const{x:I,y:A}=be(e),B=a?.elementFromPoint(I,A),D=Lt(l,B),v=g?.getBoundingClientRect();if(!v||!D)return;let _,k=be(e,v),H=!1,M=null,S=!1,$=null;const z=Hs({nodes:x(),nodeId:n,handleId:t,handleType:D}),Z=()=>{if(!f)return;const[P,R]=Cn(k,v);y({x:P,y:R}),N=requestAnimationFrame(Z)};r({connectionPosition:k,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:D,connectionStartHandle:{nodeId:n,handleId:t,type:D},connectionEndHandle:null}),h?.(e,{nodeId:n,handleId:t,handleType:D});function F(P){const{transform:R}=i();k=be(P,v);const{handle:T,validHandleResult:L}=_s(P,a,It(k,R,!1,[1,1]),E,z,W=>On(W,d,n,t,s?"target":"source",c,a));if(C=T,H||(Z(),H=!0),$=L.handleDomNode,M=L.connection,S=L.isValid,r({connectionPosition:C&&S?Tn({x:C.x,y:C.y},R):k,connectionStatus:Rs(!!C,S),connectionEndHandle:L.endHandle}),!C&&!S&&!$)return Et(_);M.source!==M.target&&$&&(Et(_),_=$,$.classList.add("connecting","react-flow__handle-connecting"),$.classList.toggle("valid",S),$.classList.toggle("react-flow__handle-valid",S))}function b(P){(C||$)&&M&&S&&o?.(M),i().onConnectEnd?.(P),l&&u?.(P),Et(_),w(),cancelAnimationFrame(N),H=!1,S=!1,M=null,$=null,a.removeEventListener("mousemove",F),a.removeEventListener("mouseup",b),a.removeEventListener("touchmove",F),a.removeEventListener("touchend",b)}a.addEventListener("mousemove",F),a.addEventListener("mouseup",b),a.addEventListener("touchmove",F),a.addEventListener("touchend",b)}const sn=()=>!0,Ds=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),Ts=(e,t,n)=>o=>{const{connectionStartHandle:s,connectionEndHandle:i,connectionClickStartHandle:r}=o;return{connecting:s?.nodeId===e&&s?.handleId===t&&s?.type===n||i?.nodeId===e&&i?.handleId===t&&i?.type===n,clickConnecting:r?.nodeId===e&&r?.handleId===t&&r?.type===n}},Fn=p.forwardRef(({type:e="source",position:t=O.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:r,onConnect:c,children:l,className:u,onMouseDown:a,onTouchStart:d,...g},f)=>{const E=r||null,h=e==="target",y=oe(),x=Cs(),{connectOnClick:w,noPanClassName:N}=j(Ds,se),{connecting:C,clickConnecting:I}=j(Ts(x,E,e),se);x||y.getState().onError?.("010",xe.error010());const A=v=>{const{defaultEdgeOptions:_,onConnect:k,hasDefaultEdges:H}=y.getState(),M={..._,...v};if(H){const{edges:S,setEdges:$}=y.getState();$(Is(M,S))}k?.(M),c?.(M)},B=v=>{if(!x)return;const _=_n(v);s&&(_&&v.button===0||!_)&&Ln({event:v,handleId:E,nodeId:x,onConnect:A,isTarget:h,getState:y.getState,setState:y.setState,isValidConnection:n||y.getState().isValidConnection||sn}),_?a?.(v):d?.(v)},D=v=>{const{onClickConnectStart:_,onClickConnectEnd:k,connectionClickStartHandle:H,connectionMode:M,isValidConnection:S}=y.getState();if(!x||!H&&!s)return;if(!H){_?.(v,{nodeId:x,handleId:E,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:x,type:e,handleId:E}});return}const $=Mn(v.target),z=n||S||sn,{connection:Z,isValid:F}=On({nodeId:x,id:E,type:e},M,H.nodeId,H.handleId||null,H.type,z,$);F&&A(Z),k?.(v),y.setState({connectionClickStartHandle:null})};return m.createElement("div",{"data-handleid":E,"data-nodeid":x,"data-handlepos":t,"data-id":`${x}-${E}-${e}`,className:ie(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",N,u,{source:!h,target:h,connectable:o,connectablestart:s,connectableend:i,connecting:I,connectionindicator:o&&(s&&!C||i&&C)}]),onMouseDown:B,onTouchStart:B,onClick:w?D:void 0,ref:f,...g},l)});Fn.displayName="Handle";var ut=p.memo(Fn);const Zn=({data:e,isConnectable:t,targetPosition:n=O.Top,sourcePosition:o=O.Bottom})=>m.createElement(m.Fragment,null,m.createElement(ut,{type:"target",position:n,isConnectable:t}),e?.label,m.createElement(ut,{type:"source",position:o,isConnectable:t}));Zn.displayName="DefaultNode";var _t=p.memo(Zn);const Wn=({data:e,isConnectable:t,sourcePosition:n=O.Bottom})=>m.createElement(m.Fragment,null,e?.label,m.createElement(ut,{type:"source",position:n,isConnectable:t}));Wn.displayName="InputNode";var Yn=p.memo(Wn);const Un=({data:e,isConnectable:t,targetPosition:n=O.Top})=>m.createElement(m.Fragment,null,m.createElement(ut,{type:"target",position:n,isConnectable:t}),e?.label);Un.displayName="OutputNode";var Xn=p.memo(Un);const Ft=()=>null;Ft.displayName="GroupNode";const zs=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),rt=e=>e.id;function Ps(e,t){return se(e.selectedNodes.map(rt),t.selectedNodes.map(rt))&&se(e.selectedEdges.map(rt),t.selectedEdges.map(rt))}const Gn=p.memo(({onSelectionChange:e})=>{const t=oe(),{selectedNodes:n,selectedEdges:o}=j(zs,Ps);return p.useEffect(()=>{const s={nodes:n,edges:o};e?.(s),t.getState().onSelectionChange.forEach(i=>i(s))},[n,o,e]),null});Gn.displayName="SelectionListener";const Bs=e=>!!e.onSelectionChange;function Vs({onSelectionChange:e}){const t=j(Bs);return e||t?m.createElement(Gn,{onSelectionChange:e}):null}const Os=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Oe(e,t){p.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Y(e,t,n){p.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const Ls=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:s,onConnectStart:i,onConnectEnd:r,onClickConnectStart:c,onClickConnectEnd:l,nodesDraggable:u,nodesConnectable:a,nodesFocusable:d,edgesFocusable:g,edgesUpdatable:f,elevateNodesOnSelect:E,minZoom:h,maxZoom:y,nodeExtent:x,onNodesChange:w,onEdgesChange:N,elementsSelectable:C,connectionMode:I,snapGrid:A,snapToGrid:B,translateExtent:D,connectOnClick:v,defaultEdgeOptions:_,fitView:k,fitViewOptions:H,onNodesDelete:M,onEdgesDelete:S,onNodeDrag:$,onNodeDragStart:z,onNodeDragStop:Z,onSelectionDrag:F,onSelectionDragStart:b,onSelectionDragStop:P,noPanClassName:R,nodeOrigin:T,rfId:L,autoPanOnConnect:W,autoPanOnNodeDrag:U,onError:G,connectionRadius:J,isValidConnection:te,nodeDragThreshold:q})=>{const{setNodes:X,setEdges:re,setDefaultNodesAndEdges:ne,setMinZoom:le,setMaxZoom:ce,setTranslateExtent:ee,setNodeExtent:ue,reset:K}=j(Os,se),V=oe();return p.useEffect(()=>{const de=o?.map(me=>({...me,..._}));return ne(n,de),()=>{K()}},[]),Y("defaultEdgeOptions",_,V.setState),Y("connectionMode",I,V.setState),Y("onConnect",s,V.setState),Y("onConnectStart",i,V.setState),Y("onConnectEnd",r,V.setState),Y("onClickConnectStart",c,V.setState),Y("onClickConnectEnd",l,V.setState),Y("nodesDraggable",u,V.setState),Y("nodesConnectable",a,V.setState),Y("nodesFocusable",d,V.setState),Y("edgesFocusable",g,V.setState),Y("edgesUpdatable",f,V.setState),Y("elementsSelectable",C,V.setState),Y("elevateNodesOnSelect",E,V.setState),Y("snapToGrid",B,V.setState),Y("snapGrid",A,V.setState),Y("onNodesChange",w,V.setState),Y("onEdgesChange",N,V.setState),Y("connectOnClick",v,V.setState),Y("fitViewOnInit",k,V.setState),Y("fitViewOnInitOptions",H,V.setState),Y("onNodesDelete",M,V.setState),Y("onEdgesDelete",S,V.setState),Y("onNodeDrag",$,V.setState),Y("onNodeDragStart",z,V.setState),Y("onNodeDragStop",Z,V.setState),Y("onSelectionDrag",F,V.setState),Y("onSelectionDragStart",b,V.setState),Y("onSelectionDragStop",P,V.setState),Y("noPanClassName",R,V.setState),Y("nodeOrigin",T,V.setState),Y("rfId",L,V.setState),Y("autoPanOnConnect",W,V.setState),Y("autoPanOnNodeDrag",U,V.setState),Y("onError",G,V.setState),Y("connectionRadius",J,V.setState),Y("isValidConnection",te,V.setState),Y("nodeDragThreshold",q,V.setState),Oe(e,X),Oe(t,re),Oe(h,le),Oe(y,ce),Oe(D,ee),Oe(x,ue),null},rn={display:"none"},Fs={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Kn="react-flow__node-desc",qn="react-flow__edge-desc",Zs="react-flow__aria-live",Ws=e=>e.ariaLiveMessage;function Ys({rfId:e}){const t=j(Ws);return m.createElement("div",{id:`${Zs}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Fs},t)}function Us({rfId:e,disableKeyboardA11y:t}){return m.createElement(m.Fragment,null,m.createElement("div",{id:`${Kn}-${e}`,style:rn},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),m.createElement("div",{id:`${qn}-${e}`,style:rn},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&m.createElement(Ys,{rfId:e}))}var nt=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,o]=p.useState(!1),s=p.useRef(!1),i=p.useRef(new Set([])),[r,c]=p.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),a=u.reduce((d,g)=>d.concat(...g),[]);return[u,a]}return[[],[]]},[e]);return p.useEffect(()=>{const l=typeof document<"u"?document:null,u=t?.target||l;if(e!==null){const a=f=>{if(s.current=f.ctrlKey||f.metaKey||f.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Mt(f))return!1;const h=an(f.code,c);i.current.add(f[h]),cn(r,i.current,!1)&&(f.preventDefault(),o(!0))},d=f=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Mt(f))return!1;const h=an(f.code,c);cn(r,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(f[h]),f.key==="Meta"&&i.current.clear(),s.current=!1},g=()=>{i.current.clear(),o(!1)};return u?.addEventListener("keydown",a),u?.addEventListener("keyup",d),window.addEventListener("blur",g),()=>{u?.removeEventListener("keydown",a),u?.removeEventListener("keyup",d),window.removeEventListener("blur",g)}}},[e,o]),n};function cn(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function an(e,t){return t.includes(e)?"code":"key"}function jn(e,t,n,o){const s=e.parentNode||e.parentId;if(!s)return n;const i=t.get(s),r=He(i,o);return jn(i,t,{x:(n.x??0)+r.x,y:(n.y??0)+r.y,z:(i[Q]?.z??0)>(n.z??0)?i[Q]?.z??0:n.z??0},o)}function Qn(e,t,n){e.forEach(o=>{const s=o.parentNode||o.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||n?.[o.id]){const{x:i,y:r,z:c}=jn(o,e,{...o.position,z:o[Q]?.z??0},t);o.positionAbsolute={x:i,y:r},o[Q].z=c,n?.[o.id]&&(o[Q].isParent=!0)}})}function wt(e,t,n,o){const s=new Map,i={},r=o?1e3:0;return e.forEach(c=>{const l=(fe(c.zIndex)?c.zIndex:0)+(c.selected?r:0),u=t.get(c.id),a={...c,positionAbsolute:{x:c.position.x,y:c.position.y}},d=c.parentNode||c.parentId;d&&(i[d]=!0);const g=u?.type&&u?.type!==c.type;Object.defineProperty(a,Q,{enumerable:!1,value:{handleBounds:g?void 0:u?.[Q]?.handleBounds,z:l}}),s.set(c.id,a)}),Qn(s,n,i),s}function Jn(e,t={}){const{getNodes:n,width:o,height:s,minZoom:i,maxZoom:r,d3Zoom:c,d3Selection:l,fitViewOnInitDone:u,fitViewOnInit:a,nodeOrigin:d}=e(),g=t.initial&&!u&&a;if(c&&l&&(g||!t.initial)){const E=n().filter(y=>{const x=t.includeHiddenNodes?y.width&&y.height:!y.hidden;return t.nodes?.length?x&&t.nodes.some(w=>w.id===y.id):x}),h=E.every(y=>y.width&&y.height);if(E.length>0&&h){const y=ht(E,d),{x,y:w,zoom:N}=Bn(y,o,s,t.minZoom??i,t.maxZoom??r,t.padding??.1),C=ke.translate(x,w).scale(N);return typeof t.duration=="number"&&t.duration>0?c.transform(Ie(l,t.duration),C):c.transform(l,C),!0}}return!1}function Xs(e,t){return e.forEach(n=>{const o=t.get(n.id);o&&t.set(o.id,{...o,[Q]:o[Q],selected:n.selected})}),new Map(t)}function Gs(e,t){return t.map(n=>{const o=e.find(s=>s.id===n.id);return o&&(n.selected=o.selected),n})}function it({changedNodes:e,changedEdges:t,get:n,set:o}){const{nodeInternals:s,edges:i,onNodesChange:r,onEdgesChange:c,hasDefaultNodes:l,hasDefaultEdges:u}=n();e?.length&&(l&&o({nodeInternals:Xs(e,s)}),r?.(e)),t?.length&&(u&&o({edges:Gs(t,i)}),c?.(t))}const Le=()=>{},Ks={zoomIn:Le,zoomOut:Le,zoomTo:Le,getZoom:()=>1,setViewport:Le,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Le,fitBounds:Le,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},qs=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),js=()=>{const e=oe(),{d3Zoom:t,d3Selection:n}=j(qs,se);return p.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy(Ie(n,s?.duration),1.2),zoomOut:s=>t.scaleBy(Ie(n,s?.duration),1/1.2),zoomTo:(s,i)=>t.scaleTo(Ie(n,i?.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,i)=>{const[r,c,l]=e.getState().transform,u=ke.translate(s.x??r,s.y??c).scale(s.zoom??l);t.transform(Ie(n,i?.duration),u)},getViewport:()=>{const[s,i,r]=e.getState().transform;return{x:s,y:i,zoom:r}},fitView:s=>Jn(e.getState,s),setCenter:(s,i,r)=>{const{width:c,height:l,maxZoom:u}=e.getState(),a=typeof r?.zoom<"u"?r.zoom:u,d=c/2-s*a,g=l/2-i*a,f=ke.translate(d,g).scale(a);t.transform(Ie(n,r?.duration),f)},fitBounds:(s,i)=>{const{width:r,height:c,minZoom:l,maxZoom:u}=e.getState(),{x:a,y:d,zoom:g}=Bn(s,r,c,l,u,i?.padding??.1),f=ke.translate(a,d).scale(g);t.transform(Ie(n,i?.duration),f)},project:s=>{const{transform:i,snapToGrid:r,snapGrid:c}=e.getState();return It(s,i,r,c)},screenToFlowPosition:s=>{const{transform:i,snapToGrid:r,snapGrid:c,domNode:l}=e.getState();if(!l)return s;const{x:u,y:a}=l.getBoundingClientRect(),d={x:s.x-u,y:s.y-a};return It(d,i,r,c)},flowToScreenPosition:s=>{const{transform:i,domNode:r}=e.getState();if(!r)return s;const{x:c,y:l}=r.getBoundingClientRect(),u=Tn(s,i);return{x:u.x+c,y:u.y+l}},viewportInitialized:!0}:Ks,[t,n])};function Zt(){const e=js(),t=oe(),n=p.useCallback(()=>t.getState().getNodes().map(h=>({...h})),[]),o=p.useCallback(h=>t.getState().nodeInternals.get(h),[]),s=p.useCallback(()=>{const{edges:h=[]}=t.getState();return h.map(y=>({...y}))},[]),i=p.useCallback(h=>{const{edges:y=[]}=t.getState();return y.find(x=>x.id===h)},[]),r=p.useCallback(h=>{const{getNodes:y,setNodes:x,hasDefaultNodes:w,onNodesChange:N}=t.getState(),C=y(),I=typeof h=="function"?h(C):h;if(w)x(I);else if(N){const A=I.length===0?C.map(B=>({type:"remove",id:B.id})):I.map(B=>({item:B,type:"reset"}));N(A)}},[]),c=p.useCallback(h=>{const{edges:y=[],setEdges:x,hasDefaultEdges:w,onEdgesChange:N}=t.getState(),C=typeof h=="function"?h(y):h;if(w)x(C);else if(N){const I=C.length===0?y.map(A=>({type:"remove",id:A.id})):C.map(A=>({item:A,type:"reset"}));N(I)}},[]),l=p.useCallback(h=>{const y=Array.isArray(h)?h:[h],{getNodes:x,setNodes:w,hasDefaultNodes:N,onNodesChange:C}=t.getState();if(N){const A=[...x(),...y];w(A)}else if(C){const I=y.map(A=>({item:A,type:"add"}));C(I)}},[]),u=p.useCallback(h=>{const y=Array.isArray(h)?h:[h],{edges:x=[],setEdges:w,hasDefaultEdges:N,onEdgesChange:C}=t.getState();if(N)w([...x,...y]);else if(C){const I=y.map(A=>({item:A,type:"add"}));C(I)}},[]),a=p.useCallback(()=>{const{getNodes:h,edges:y=[],transform:x}=t.getState(),[w,N,C]=x;return{nodes:h().map(I=>({...I})),edges:y.map(I=>({...I})),viewport:{x:w,y:N,zoom:C}}},[]),d=p.useCallback(({nodes:h,edges:y})=>{const{nodeInternals:x,getNodes:w,edges:N,hasDefaultNodes:C,hasDefaultEdges:I,onNodesDelete:A,onEdgesDelete:B,onNodesChange:D,onEdgesChange:v}=t.getState(),_=(h||[]).map($=>$.id),k=(y||[]).map($=>$.id),H=w().reduce(($,z)=>{const Z=z.parentNode||z.parentId,F=!_.includes(z.id)&&Z&&$.find(P=>P.id===Z);return(typeof z.deletable=="boolean"?z.deletable:!0)&&(_.includes(z.id)||F)&&$.push(z),$},[]),M=N.filter($=>typeof $.deletable=="boolean"?$.deletable:!0),S=M.filter($=>k.includes($.id));if(H||S){const $=Pn(H,M),z=[...S,...$],Z=z.reduce((F,b)=>(F.includes(b.id)||F.push(b.id),F),[]);if((I||C)&&(I&&t.setState({edges:N.filter(F=>!Z.includes(F.id))}),C&&(H.forEach(F=>{x.delete(F.id)}),t.setState({nodeInternals:new Map(x)}))),Z.length>0&&(B?.(z),v&&v(Z.map(F=>({id:F,type:"remove"})))),H.length>0&&(A?.(H),D)){const F=H.map(b=>({id:b.id,type:"remove"}));D(F)}}},[]),g=p.useCallback(h=>{const y=ys(h),x=y?null:t.getState().nodeInternals.get(h.id);return!y&&!x?[null,null,y]:[y?h:Qt(x),x,y]},[]),f=p.useCallback((h,y=!0,x)=>{const[w,N,C]=g(h);return w?(x||t.getState().getNodes()).filter(I=>{if(!C&&(I.id===N.id||!I.positionAbsolute))return!1;const A=Qt(I),B=Ct(A,w);return y&&B>0||B>=w.width*w.height}):[]},[]),E=p.useCallback((h,y,x=!0)=>{const[w]=g(h);if(!w)return!1;const N=Ct(w,y);return x&&N>0||N>=w.width*w.height},[]);return p.useMemo(()=>({...e,getNodes:n,getNode:o,getEdges:s,getEdge:i,setNodes:r,setEdges:c,addNodes:l,addEdges:u,toObject:a,deleteElements:d,getIntersectingNodes:f,isNodeIntersecting:E}),[e,n,o,s,i,r,c,l,u,a,d,f,E])}const Qs={actInsideInputWithModifier:!1};var Js=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=oe(),{deleteElements:o}=Zt(),s=nt(e,Qs),i=nt(t);p.useEffect(()=>{if(s){const{edges:r,getNodes:c}=n.getState(),l=c().filter(a=>a.selected),u=r.filter(a=>a.selected);o({nodes:l,edges:u}),n.setState({nodesSelectionActive:!1})}},[s]),p.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function er(e){const t=oe();p.useEffect(()=>{let n;const o=()=>{if(!e.current)return;const s=Tt(e.current);(s.height===0||s.width===0)&&t.getState().onError?.("004",xe.error004()),t.setState({width:s.width||500,height:s.height||500})};return o(),window.addEventListener("resize",o),e.current&&(n=new ResizeObserver(()=>o()),n.observe(e.current)),()=>{window.removeEventListener("resize",o),n&&e.current&&n.unobserve(e.current)}},[])}const Wt={position:"absolute",width:"100%",height:"100%",top:0,left:0},tr=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,ct=e=>({x:e.x,y:e.y,zoom:e.k}),Fe=(e,t)=>e.target.closest(`.${t}`),ln=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),dn=e=>{const t=e.ctrlKey&&at()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},nr=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),or=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:s=!0,zoomOnPinch:i=!0,panOnScroll:r=!1,panOnScrollSpeed:c=.5,panOnScrollMode:l=_e.Free,zoomOnDoubleClick:u=!0,elementsSelectable:a,panOnDrag:d=!0,defaultViewport:g,translateExtent:f,minZoom:E,maxZoom:h,zoomActivationKeyCode:y,preventScrolling:x=!0,children:w,noWheelClassName:N,noPanClassName:C})=>{const I=p.useRef(),A=oe(),B=p.useRef(!1),D=p.useRef(!1),v=p.useRef(null),_=p.useRef({x:0,y:0,zoom:0}),{d3Zoom:k,d3Selection:H,d3ZoomHandler:M,userSelectionActive:S}=j(nr,se),$=nt(y),z=p.useRef(0),Z=p.useRef(!1),F=p.useRef();return er(v),p.useEffect(()=>{if(v.current){const b=v.current.getBoundingClientRect(),P=Sn().scaleExtent([E,h]).translateExtent(f),R=Rt(v.current).call(P),T=ke.translate(g.x,g.y).scale(Ue(g.zoom,E,h)),L=[[0,0],[b.width,b.height]],W=P.constrain()(T,L,f);P.transform(R,W),P.wheelDelta(dn),A.setState({d3Zoom:P,d3Selection:R,d3ZoomHandler:R.on("wheel.zoom"),transform:[W.x,W.y,W.k],domNode:v.current.closest(".react-flow")})}},[]),p.useEffect(()=>{H&&k&&(r&&!$&&!S?H.on("wheel.zoom",b=>{if(Fe(b,N))return!1;b.preventDefault(),b.stopImmediatePropagation();const P=H.property("__zoom").k||1;if(b.ctrlKey&&i){const te=bn(b),q=dn(b),X=P*Math.pow(2,q);k.scaleTo(H,X,te,b);return}const R=b.deltaMode===1?20:1;let T=l===_e.Vertical?0:b.deltaX*R,L=l===_e.Horizontal?0:b.deltaY*R;!at()&&b.shiftKey&&l!==_e.Vertical&&(T=b.deltaY*R,L=0),k.translateBy(H,-(T/P)*c,-(L/P)*c,{internal:!0});const W=ct(H.property("__zoom")),{onViewportChangeStart:U,onViewportChange:G,onViewportChangeEnd:J}=A.getState();clearTimeout(F.current),Z.current||(Z.current=!0,t?.(b,W),U?.(W)),Z.current&&(e?.(b,W),G?.(W),F.current=setTimeout(()=>{n?.(b,W),J?.(W),Z.current=!1},150))},{passive:!1}):typeof M<"u"&&H.on("wheel.zoom",function(b,P){if(!x&&b.type==="wheel"&&!b.ctrlKey||Fe(b,N))return null;b.preventDefault(),M.call(this,b,P)},{passive:!1}))},[S,r,l,H,k,M,$,i,x,N,t,e,n]),p.useEffect(()=>{k&&k.on("start",b=>{if(!b.sourceEvent||b.sourceEvent.internal)return null;z.current=b.sourceEvent?.button;const{onViewportChangeStart:P}=A.getState(),R=ct(b.transform);B.current=!0,_.current=R,b.sourceEvent?.type==="mousedown"&&A.setState({paneDragging:!0}),P?.(R),t?.(b.sourceEvent,R)})},[k,t]),p.useEffect(()=>{k&&(S&&!B.current?k.on("zoom",null):S||k.on("zoom",b=>{const{onViewportChange:P}=A.getState();if(A.setState({transform:[b.transform.x,b.transform.y,b.transform.k]}),D.current=!!(o&&ln(d,z.current??0)),(e||P)&&!b.sourceEvent?.internal){const R=ct(b.transform);P?.(R),e?.(b.sourceEvent,R)}}))},[S,k,e,d,o]),p.useEffect(()=>{k&&k.on("end",b=>{if(!b.sourceEvent||b.sourceEvent.internal)return null;const{onViewportChangeEnd:P}=A.getState();if(B.current=!1,A.setState({paneDragging:!1}),o&&ln(d,z.current??0)&&!D.current&&o(b.sourceEvent),D.current=!1,(n||P)&&tr(_.current,b.transform)){const R=ct(b.transform);_.current=R,clearTimeout(I.current),I.current=setTimeout(()=>{P?.(R),n?.(b.sourceEvent,R)},r?150:0)}})},[k,r,d,n,o]),p.useEffect(()=>{k&&k.filter(b=>{const P=$||s,R=i&&b.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&b.button===1&&b.type==="mousedown"&&(Fe(b,"react-flow__node")||Fe(b,"react-flow__edge")))return!0;if(!d&&!P&&!r&&!u&&!i||S||!u&&b.type==="dblclick"||Fe(b,N)&&b.type==="wheel"||Fe(b,C)&&(b.type!=="wheel"||r&&b.type==="wheel"&&!$)||!i&&b.ctrlKey&&b.type==="wheel"||!P&&!r&&!R&&b.type==="wheel"||!d&&(b.type==="mousedown"||b.type==="touchstart")||Array.isArray(d)&&!d.includes(b.button)&&b.type==="mousedown")return!1;const T=Array.isArray(d)&&d.includes(b.button)||!b.button||b.button<=1;return(!b.ctrlKey||b.type==="wheel")&&T})},[S,k,s,i,r,u,d,a,$]),m.createElement("div",{className:"react-flow__renderer",ref:v,style:Wt},w)},sr=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function rr(){const{userSelectionActive:e,userSelectionRect:t}=j(sr,se);return e&&t?m.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function un(e,t){const n=t.parentNode||t.parentId,o=e.find(s=>s.id===n);if(o){const s=t.position.x+t.width-o.width,i=t.position.y+t.height-o.height;if(s>0||i>0||t.position.x<0||t.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,s>0&&(o.style.width+=s),i>0&&(o.style.height+=i),t.position.x<0){const r=Math.abs(t.position.x);o.position.x=o.position.x-r,o.style.width+=r,t.position.x=0}if(t.position.y<0){const r=Math.abs(t.position.y);o.position.y=o.position.y-r,o.style.height+=r,t.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function eo(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const n=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,s)=>{const i=e.filter(c=>c.id===s.id);if(i.length===0)return o.push(s),o;const r={...s};for(const c of i)if(c)switch(c.type){case"select":{r.selected=c.selected;break}case"position":{typeof c.position<"u"&&(r.position=c.position),typeof c.positionAbsolute<"u"&&(r.positionAbsolute=c.positionAbsolute),typeof c.dragging<"u"&&(r.dragging=c.dragging),r.expandParent&&un(o,r);break}case"dimensions":{typeof c.dimensions<"u"&&(r.width=c.dimensions.width,r.height=c.dimensions.height),typeof c.updateStyle<"u"&&(r.style={...r.style||{},...c.dimensions}),typeof c.resizing=="boolean"&&(r.resizing=c.resizing),r.expandParent&&un(o,r);break}case"remove":return o}return o.push(r),o},n)}function to(e,t){return eo(e,t)}function ir(e,t){return eo(e,t)}const we=(e,t)=>({id:e,type:"select",selected:t});function We(e,t){return e.reduce((n,o)=>{const s=t.includes(o.id);return!o.selected&&s?(o.selected=!0,n.push(we(o.id,!0))):o.selected&&!s&&(o.selected=!1,n.push(we(o.id,!1))),n},[])}const St=(e,t)=>n=>{n.target===t.current&&e?.(n)},cr=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),no=p.memo(({isSelecting:e,selectionMode:t=tt.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:s,onPaneClick:i,onPaneContextMenu:r,onPaneScroll:c,onPaneMouseEnter:l,onPaneMouseMove:u,onPaneMouseLeave:a,children:d})=>{const g=p.useRef(null),f=oe(),E=p.useRef(0),h=p.useRef(0),y=p.useRef(),{userSelectionActive:x,elementsSelectable:w,dragging:N}=j(cr,se),C=()=>{f.setState({userSelectionActive:!1,userSelectionRect:null}),E.current=0,h.current=0},I=M=>{i?.(M),f.getState().resetSelectedElements(),f.setState({nodesSelectionActive:!1})},A=M=>{if(Array.isArray(n)&&n?.includes(2)){M.preventDefault();return}r?.(M)},B=c?M=>c(M):void 0,D=M=>{const{resetSelectedElements:S,domNode:$}=f.getState();if(y.current=$?.getBoundingClientRect(),!w||!e||M.button!==0||M.target!==g.current||!y.current)return;const{x:z,y:Z}=be(M,y.current);S(),f.setState({userSelectionRect:{width:0,height:0,startX:z,startY:Z,x:z,y:Z}}),o?.(M)},v=M=>{const{userSelectionRect:S,nodeInternals:$,edges:z,transform:Z,onNodesChange:F,onEdgesChange:b,nodeOrigin:P,getNodes:R}=f.getState();if(!e||!y.current||!S)return;f.setState({userSelectionActive:!0,nodesSelectionActive:!1});const T=be(M,y.current),L=S.startX??0,W=S.startY??0,U={...S,x:T.x<L?T.x:L,y:T.y<W?T.y:W,width:Math.abs(T.x-L),height:Math.abs(T.y-W)},G=R(),J=zn($,U,Z,t===tt.Partial,!0,P),te=Pn(J,z).map(X=>X.id),q=J.map(X=>X.id);if(E.current!==q.length){E.current=q.length;const X=We(G,q);X.length&&F?.(X)}if(h.current!==te.length){h.current=te.length;const X=We(z,te);X.length&&b?.(X)}f.setState({userSelectionRect:U})},_=M=>{if(M.button!==0)return;const{userSelectionRect:S}=f.getState();!x&&S&&M.target===g.current&&I?.(M),f.setState({nodesSelectionActive:E.current>0}),C(),s?.(M)},k=M=>{x&&(f.setState({nodesSelectionActive:E.current>0}),s?.(M)),C()},H=w&&(e||x);return m.createElement("div",{className:ie(["react-flow__pane",{dragging:N,selection:e}]),onClick:H?void 0:St(I,g),onContextMenu:St(A,g),onWheel:St(B,g),onMouseEnter:H?void 0:l,onMouseDown:H?D:void 0,onMouseMove:H?v:u,onMouseUp:H?_:void 0,onMouseLeave:H?k:a,ref:g,style:Wt},d,m.createElement(rr,null))});no.displayName="Pane";function oo(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const o=t.get(n);return o?o.selected?!0:oo(o,t):!1}function fn(e,t,n){let o=e;do{if(o?.matches(t))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function ar(e,t,n,o){return Array.from(e.values()).filter(s=>(s.selected||s.id===o)&&(!s.parentNode||s.parentId||!oo(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>({id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(s.positionAbsolute?.x??0),y:n.y-(s.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}))}function lr(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function so(e,t,n,o,s=[0,0],i){const r=lr(e,e.extent||o);let c=r;const l=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(l&&e.width&&e.height){const d=n.get(l),{x:g,y:f}=He(d,s).positionAbsolute;c=d&&fe(g)&&fe(f)&&fe(d.width)&&fe(d.height)?[[g+e.width*s[0],f+e.height*s[1]],[g+d.width-e.width+e.width*s[0],f+d.height-e.height+e.height*s[1]]]:c}else i?.("005",xe.error005()),c=r;else if(e.extent&&l&&e.extent!=="parent"){const d=n.get(l),{x:g,y:f}=He(d,s).positionAbsolute;c=[[e.extent[0][0]+g,e.extent[0][1]+f],[e.extent[1][0]+g,e.extent[1][1]+f]]}let u={x:0,y:0};if(l){const d=n.get(l);u=He(d,s).positionAbsolute}const a=c&&c!=="parent"?zt(t,c):t;return{position:{x:a.x-u.x,y:a.y-u.y},positionAbsolute:a}}function bt({nodeId:e,dragItems:t,nodeInternals:n}){const o=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?o.find(s=>s.id===e):o[0],o]}const gn=(e,t,n,o)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const i=Array.from(s),r=t.getBoundingClientRect(),c={x:r.width*o[0],y:r.height*o[1]};return i.map(l=>{const u=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(u.left-r.left-c.x)/n,y:(u.top-r.top-c.y)/n,...Tt(l)}})};function je(e,t,n){return n===void 0?n:o=>{const s=t().nodeInternals.get(e);s&&n(o,{...s})}}function kt({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:r,nodeInternals:c,onError:l}=t.getState(),u=c.get(e);if(!u){l?.("012",xe.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&r)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):s([e])}function dr(){const e=oe();return p.useCallback(({sourceEvent:n})=>{const{transform:o,snapGrid:s,snapToGrid:i}=e.getState(),r=n.touches?n.touches[0].clientX:n.clientX,c=n.touches?n.touches[0].clientY:n.clientY,l={x:(r-o[0])/o[2],y:(c-o[1])/o[2]};return{xSnapped:i?s[0]*Math.round(l.x/s[0]):l.x,ySnapped:i?s[1]*Math.round(l.y/s[1]):l.y,...l}},[])}function Nt(e){return(t,n,o)=>e?.(t,o)}function ro({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:i,selectNodesOnDrag:r}){const c=oe(),[l,u]=p.useState(!1),a=p.useRef([]),d=p.useRef({x:null,y:null}),g=p.useRef(0),f=p.useRef(null),E=p.useRef({x:0,y:0}),h=p.useRef(null),y=p.useRef(!1),x=p.useRef(!1),w=p.useRef(!1),N=dr();return p.useEffect(()=>{if(e?.current){const C=Rt(e.current),I=({x:D,y:v})=>{const{nodeInternals:_,onNodeDrag:k,onSelectionDrag:H,updateNodePositions:M,nodeExtent:S,snapGrid:$,snapToGrid:z,nodeOrigin:Z,onError:F}=c.getState();d.current={x:D,y:v};let b=!1,P={x:0,y:0,x2:0,y2:0};if(a.current.length>1&&S){const T=ht(a.current,Z);P=et(T)}if(a.current=a.current.map(T=>{const L={x:D-T.distance.x,y:v-T.distance.y};z&&(L.x=$[0]*Math.round(L.x/$[0]),L.y=$[1]*Math.round(L.y/$[1]));const W=[[S[0][0],S[0][1]],[S[1][0],S[1][1]]];a.current.length>1&&S&&!T.extent&&(W[0][0]=T.positionAbsolute.x-P.x+S[0][0],W[1][0]=T.positionAbsolute.x+(T.width??0)-P.x2+S[1][0],W[0][1]=T.positionAbsolute.y-P.y+S[0][1],W[1][1]=T.positionAbsolute.y+(T.height??0)-P.y2+S[1][1]);const U=so(T,L,_,W,Z,F);return b=b||T.position.x!==U.position.x||T.position.y!==U.position.y,T.position=U.position,T.positionAbsolute=U.positionAbsolute,T}),!b)return;M(a.current,!0,!0),u(!0);const R=s?k:Nt(H);if(R&&h.current){const[T,L]=bt({nodeId:s,dragItems:a.current,nodeInternals:_});R(h.current,T,L)}},A=()=>{if(!f.current)return;const[D,v]=Cn(E.current,f.current);if(D!==0||v!==0){const{transform:_,panBy:k}=c.getState();d.current.x=(d.current.x??0)-D/_[2],d.current.y=(d.current.y??0)-v/_[2],k({x:D,y:v})&&I(d.current)}g.current=requestAnimationFrame(A)},B=D=>{const{nodeInternals:v,multiSelectionActive:_,nodesDraggable:k,unselectNodesAndEdges:H,onNodeDragStart:M,onSelectionDragStart:S}=c.getState();x.current=!0;const $=s?M:Nt(S);(!r||!i)&&!_&&s&&(v.get(s)?.selected||H()),s&&i&&r&&kt({id:s,store:c,nodeRef:e});const z=N(D);if(d.current=z,a.current=ar(v,k,z,s),$&&a.current){const[Z,F]=bt({nodeId:s,dragItems:a.current,nodeInternals:v});$(D.sourceEvent,Z,F)}};if(t)C.on(".drag",null);else{const D=es().on("start",v=>{const{domNode:_,nodeDragThreshold:k}=c.getState();k===0&&B(v),w.current=!1;const H=N(v);d.current=H,f.current=_?.getBoundingClientRect()||null,E.current=be(v.sourceEvent,f.current)}).on("drag",v=>{const _=N(v),{autoPanOnNodeDrag:k,nodeDragThreshold:H}=c.getState();if(v.sourceEvent.type==="touchmove"&&v.sourceEvent.touches.length>1&&(w.current=!0),!w.current){if(!y.current&&x.current&&k&&(y.current=!0,A()),!x.current){const M=_.xSnapped-(d?.current?.x??0),S=_.ySnapped-(d?.current?.y??0);Math.sqrt(M*M+S*S)>H&&B(v)}(d.current.x!==_.xSnapped||d.current.y!==_.ySnapped)&&a.current&&x.current&&(h.current=v.sourceEvent,E.current=be(v.sourceEvent,f.current),I(_))}}).on("end",v=>{if(!(!x.current||w.current)&&(u(!1),y.current=!1,x.current=!1,cancelAnimationFrame(g.current),a.current)){const{updateNodePositions:_,nodeInternals:k,onNodeDragStop:H,onSelectionDragStop:M}=c.getState(),S=s?H:Nt(M);if(_(a.current,!1,!1),S){const[$,z]=bt({nodeId:s,dragItems:a.current,nodeInternals:k});S(v.sourceEvent,$,z)}}}).filter(v=>{const _=v.target;return!v.button&&(!n||!fn(_,`.${n}`,e))&&(!o||fn(_,o,e))});return C.call(D),()=>{C.on(".drag",null)}}}},[e,t,n,o,i,c,s,r,N]),l}function io(){const e=oe();return p.useCallback(n=>{const{nodeInternals:o,nodeExtent:s,updateNodePositions:i,getNodes:r,snapToGrid:c,snapGrid:l,onError:u,nodesDraggable:a}=e.getState(),d=r().filter(w=>w.selected&&(w.draggable||a&&typeof w.draggable>"u")),g=c?l[0]:5,f=c?l[1]:5,E=n.isShiftPressed?4:1,h=n.x*g*E,y=n.y*f*E,x=d.map(w=>{if(w.positionAbsolute){const N={x:w.positionAbsolute.x+h,y:w.positionAbsolute.y+y};c&&(N.x=l[0]*Math.round(N.x/l[0]),N.y=l[1]*Math.round(N.y/l[1]));const{positionAbsolute:C,position:I}=so(w,N,o,s,void 0,u);w.position=I,w.positionAbsolute=C}return w});i(x,!0,!1)},[])}const Ye={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Qe=e=>{const t=({id:n,type:o,data:s,xPos:i,yPos:r,xPosOrigin:c,yPosOrigin:l,selected:u,onClick:a,onMouseEnter:d,onMouseMove:g,onMouseLeave:f,onContextMenu:E,onDoubleClick:h,style:y,className:x,isDraggable:w,isSelectable:N,isConnectable:C,isFocusable:I,selectNodesOnDrag:A,sourcePosition:B,targetPosition:D,hidden:v,resizeObserver:_,dragHandle:k,zIndex:H,isParent:M,noDragClassName:S,noPanClassName:$,initialized:z,disableKeyboardA11y:Z,ariaLabel:F,rfId:b,hasHandleBounds:P})=>{const R=oe(),T=p.useRef(null),L=p.useRef(null),W=p.useRef(B),U=p.useRef(D),G=p.useRef(o),J=N||w||a||d||g||f,te=io(),q=je(n,R.getState,d),X=je(n,R.getState,g),re=je(n,R.getState,f),ne=je(n,R.getState,E),le=je(n,R.getState,h),ce=K=>{const{nodeDragThreshold:V}=R.getState();if(N&&(!A||!w||V>0)&&kt({id:n,store:R,nodeRef:T}),a){const de=R.getState().nodeInternals.get(n);de&&a(K,{...de})}},ee=K=>{if(!Mt(K)&&!Z)if(In.includes(K.key)&&N){const V=K.key==="Escape";kt({id:n,store:R,unselect:V,nodeRef:T})}else w&&u&&Object.prototype.hasOwnProperty.call(Ye,K.key)&&(R.setState({ariaLiveMessage:`Moved selected node ${K.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~r}`}),te({x:Ye[K.key].x,y:Ye[K.key].y,isShiftPressed:K.shiftKey}))};p.useEffect(()=>()=>{L.current&&(_?.unobserve(L.current),L.current=null)},[]),p.useEffect(()=>{if(T.current&&!v){const K=T.current;(!z||!P||L.current!==K)&&(L.current&&_?.unobserve(L.current),_?.observe(K),L.current=K)}},[v,z,P]),p.useEffect(()=>{const K=G.current!==o,V=W.current!==B,de=U.current!==D;T.current&&(K||V||de)&&(K&&(G.current=o),V&&(W.current=B),de&&(U.current=D),R.getState().updateNodeDimensions([{id:n,nodeElement:T.current,forceUpdate:!0}]))},[n,o,B,D]);const ue=ro({nodeRef:T,disabled:v||!w,noDragClassName:S,handleSelector:k,nodeId:n,isSelectable:N,selectNodesOnDrag:A});return v?null:m.createElement("div",{className:ie(["react-flow__node",`react-flow__node-${o}`,{[$]:w},x,{selected:u,selectable:N,parent:M,dragging:ue}]),ref:T,style:{zIndex:H,transform:`translate(${c}px,${l}px)`,pointerEvents:J?"all":"none",visibility:z?"visible":"hidden",...y},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:q,onMouseMove:X,onMouseLeave:re,onContextMenu:ne,onClick:ce,onDoubleClick:le,onKeyDown:I?ee:void 0,tabIndex:I?0:void 0,role:I?"button":void 0,"aria-describedby":Z?void 0:`${Kn}-${b}`,"aria-label":F},m.createElement(vs,{value:n},m.createElement(e,{id:n,data:s,type:o,xPos:i,yPos:r,selected:u,isConnectable:C,sourcePosition:B,targetPosition:D,dragging:ue,dragHandle:k,zIndex:H})))};return t.displayName="NodeWrapper",p.memo(t)};const ur=e=>{const t=e.getNodes().filter(n=>n.selected);return{...ht(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function fr({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=oe(),{width:s,height:i,x:r,y:c,transformString:l,userSelectionActive:u}=j(ur,se),a=io(),d=p.useRef(null);if(p.useEffect(()=>{n||d.current?.focus({preventScroll:!0})},[n]),ro({nodeRef:d}),u||!s||!i)return null;const g=e?E=>{const h=o.getState().getNodes().filter(y=>y.selected);e(E,h)}:void 0,f=E=>{Object.prototype.hasOwnProperty.call(Ye,E.key)&&a({x:Ye[E.key].x,y:Ye[E.key].y,isShiftPressed:E.shiftKey})};return m.createElement("div",{className:ie(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l}},m.createElement("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:g,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:s,height:i,top:c,left:r}}))}var gr=p.memo(fr);const hr=e=>e.nodesSelectionActive,co=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,deleteKeyCode:c,onMove:l,onMoveStart:u,onMoveEnd:a,selectionKeyCode:d,selectionOnDrag:g,selectionMode:f,onSelectionStart:E,onSelectionEnd:h,multiSelectionKeyCode:y,panActivationKeyCode:x,zoomActivationKeyCode:w,elementsSelectable:N,zoomOnScroll:C,zoomOnPinch:I,panOnScroll:A,panOnScrollSpeed:B,panOnScrollMode:D,zoomOnDoubleClick:v,panOnDrag:_,defaultViewport:k,translateExtent:H,minZoom:M,maxZoom:S,preventScrolling:$,onSelectionContextMenu:z,noWheelClassName:Z,noPanClassName:F,disableKeyboardA11y:b})=>{const P=j(hr),R=nt(d),T=nt(x),L=T||_,W=T||A,U=R||g&&L!==!0;return Js({deleteKeyCode:c,multiSelectionKeyCode:y}),m.createElement(or,{onMove:l,onMoveStart:u,onMoveEnd:a,onPaneContextMenu:i,elementsSelectable:N,zoomOnScroll:C,zoomOnPinch:I,panOnScroll:W,panOnScrollSpeed:B,panOnScrollMode:D,zoomOnDoubleClick:v,panOnDrag:!R&&L,defaultViewport:k,translateExtent:H,minZoom:M,maxZoom:S,zoomActivationKeyCode:w,preventScrolling:$,noWheelClassName:Z,noPanClassName:F},m.createElement(no,{onSelectionStart:E,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,panOnDrag:L,isSelecting:!!U,selectionMode:f},e,P&&m.createElement(gr,{onSelectionContextMenu:z,noPanClassName:F,disableKeyboardA11y:b})))};co.displayName="FlowRenderer";var pr=p.memo(co);function mr(e){return j(p.useCallback(n=>e?zn(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function yr(e){const t={input:Qe(e.input||Yn),default:Qe(e.default||_t),output:Qe(e.output||Xn),group:Qe(e.group||Ft)},n={},o=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,i)=>(s[i]=Qe(e[i]||_t),s),n);return{...t,...o}}const xr=({x:e,y:t,width:n,height:o,origin:s})=>!n||!o?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-o*s[1]},Er=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),ao=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,updateNodeDimensions:i,onError:r}=j(Er,se),c=mr(e.onlyRenderVisibleElements),l=p.useRef(),u=p.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const a=new ResizeObserver(d=>{const g=d.map(f=>({id:f.target.getAttribute("data-id"),nodeElement:f.target,forceUpdate:!0}));i(g)});return l.current=a,a},[]);return p.useEffect(()=>()=>{l?.current?.disconnect()},[]),m.createElement("div",{className:"react-flow__nodes",style:Wt},c.map(a=>{let d=a.type||"default";e.nodeTypes[d]||(r?.("003",xe.error003(d)),d="default");const g=e.nodeTypes[d]||e.nodeTypes.default,f=!!(a.draggable||t&&typeof a.draggable>"u"),E=!!(a.selectable||s&&typeof a.selectable>"u"),h=!!(a.connectable||n&&typeof a.connectable>"u"),y=!!(a.focusable||o&&typeof a.focusable>"u"),x=e.nodeExtent?zt(a.positionAbsolute,e.nodeExtent):a.positionAbsolute,w=x?.x??0,N=x?.y??0,C=xr({x:w,y:N,width:a.width??0,height:a.height??0,origin:e.nodeOrigin});return m.createElement(g,{key:a.id,id:a.id,className:a.className,style:a.style,type:d,data:a.data,sourcePosition:a.sourcePosition||O.Bottom,targetPosition:a.targetPosition||O.Top,hidden:a.hidden,xPos:w,yPos:N,xPosOrigin:C.x,yPosOrigin:C.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!a.selected,isDraggable:f,isSelectable:E,isConnectable:h,isFocusable:y,resizeObserver:u,dragHandle:a.dragHandle,zIndex:a[Q]?.z??0,isParent:!!a[Q]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!a.width&&!!a.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:a.ariaLabel,hasHandleBounds:!!a[Q]?.handleBounds})}))};ao.displayName="NodeRenderer";var wr=p.memo(ao);const Sr=(e,t,n)=>n===O.Left?e-t:n===O.Right?e+t:e,br=(e,t,n)=>n===O.Top?e-t:n===O.Bottom?e+t:e,hn="react-flow__edgeupdater",pn=({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:i,onMouseOut:r,type:c})=>m.createElement("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:r,className:ie([hn,`${hn}-${c}`]),cx:Sr(t,o,e),cy:br(n,o,e),r:o,stroke:"transparent",fill:"transparent"}),Nr=()=>!0;var Ze=e=>{const t=({id:n,className:o,type:s,data:i,onClick:r,onEdgeDoubleClick:c,selected:l,animated:u,label:a,labelStyle:d,labelShowBg:g,labelBgStyle:f,labelBgPadding:E,labelBgBorderRadius:h,style:y,source:x,target:w,sourceX:N,sourceY:C,targetX:I,targetY:A,sourcePosition:B,targetPosition:D,elementsSelectable:v,hidden:_,sourceHandleId:k,targetHandleId:H,onContextMenu:M,onMouseEnter:S,onMouseMove:$,onMouseLeave:z,reconnectRadius:Z,onReconnect:F,onReconnectStart:b,onReconnectEnd:P,markerEnd:R,markerStart:T,rfId:L,ariaLabel:W,isFocusable:U,isReconnectable:G,pathOptions:J,interactionWidth:te,disableKeyboardA11y:q})=>{const X=p.useRef(null),[re,ne]=p.useState(!1),[le,ce]=p.useState(!1),ee=oe(),ue=p.useMemo(()=>`url('#${$t(T,L)}')`,[T,L]),K=p.useMemo(()=>`url('#${$t(R,L)}')`,[R,L]);if(_)return null;const V=ae=>{const{edges:he,addSelectedEdges:Ce,unselectNodesAndEdges:Me,multiSelectionActive:Ve}=ee.getState(),pe=he.find(Ae=>Ae.id===n);pe&&(v&&(ee.setState({nodesSelectionActive:!1}),pe.selected&&Ve?(Me({nodes:[],edges:[pe]}),X.current?.blur()):Ce([n])),r&&r(ae,pe))},de=qe(n,ee.getState,c),me=qe(n,ee.getState,M),Xe=qe(n,ee.getState,S),De=qe(n,ee.getState,$),Te=qe(n,ee.getState,z),ye=(ae,he)=>{if(ae.button!==0)return;const{edges:Ce,isValidConnection:Me}=ee.getState(),Ve=he?w:x,pe=(he?H:k)||null,Ae=he?"target":"source",pt=Me||Nr,mt=he,Ke=Ce.find($e=>$e.id===n);ce(!0),b?.(ae,Ke,Ae);const yt=$e=>{ce(!1),P?.($e,Ke,Ae)};Ln({event:ae,handleId:pe,nodeId:Ve,onConnect:$e=>F?.(Ke,$e),isTarget:mt,getState:ee.getState,setState:ee.setState,isValidConnection:pt,edgeUpdaterType:Ae,onReconnectEnd:yt})},ze=ae=>ye(ae,!0),Ne=ae=>ye(ae,!1),ve=()=>ne(!0),Pe=()=>ne(!1),Be=!v&&!r,Ge=ae=>{if(!q&&In.includes(ae.key)&&v){const{unselectNodesAndEdges:he,addSelectedEdges:Ce,edges:Me}=ee.getState();ae.key==="Escape"?(X.current?.blur(),he({edges:[Me.find(pe=>pe.id===n)]})):Ce([n])}};return m.createElement("g",{className:ie(["react-flow__edge",`react-flow__edge-${s}`,o,{selected:l,animated:u,inactive:Be,updating:re}]),onClick:V,onDoubleClick:de,onContextMenu:me,onMouseEnter:Xe,onMouseMove:De,onMouseLeave:Te,onKeyDown:U?Ge:void 0,tabIndex:U?0:void 0,role:U?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":W===null?void 0:W||`Edge from ${x} to ${w}`,"aria-describedby":U?`${qn}-${L}`:void 0,ref:X},!le&&m.createElement(e,{id:n,source:x,target:w,selected:l,animated:u,label:a,labelStyle:d,labelShowBg:g,labelBgStyle:f,labelBgPadding:E,labelBgBorderRadius:h,data:i,style:y,sourceX:N,sourceY:C,targetX:I,targetY:A,sourcePosition:B,targetPosition:D,sourceHandleId:k,targetHandleId:H,markerStart:ue,markerEnd:K,pathOptions:J,interactionWidth:te}),G&&m.createElement(m.Fragment,null,(G==="source"||G===!0)&&m.createElement(pn,{position:B,centerX:N,centerY:C,radius:Z,onMouseDown:ze,onMouseEnter:ve,onMouseOut:Pe,type:"source"}),(G==="target"||G===!0)&&m.createElement(pn,{position:D,centerX:I,centerY:A,radius:Z,onMouseDown:Ne,onMouseEnter:ve,onMouseOut:Pe,type:"target"})))};return t.displayName="EdgeWrapper",p.memo(t)};function vr(e){const t={default:Ze(e.default||dt),straight:Ze(e.bezier||Vt),step:Ze(e.step||Bt),smoothstep:Ze(e.step||gt),simplebezier:Ze(e.simplebezier||Pt)},n={},o=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,i)=>(s[i]=Ze(e[i]||dt),s),n);return{...t,...o}}function mn(e,t,n=null){const o=(n?.x||0)+t.x,s=(n?.y||0)+t.y,i=n?.width||t.width,r=n?.height||t.height;switch(e){case O.Top:return{x:o+i/2,y:s};case O.Right:return{x:o+i,y:s+r/2};case O.Bottom:return{x:o+i/2,y:s+r};case O.Left:return{x:o,y:s+r/2}}}function yn(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const Cr=(e,t,n,o,s,i)=>{const r=mn(n,e,t),c=mn(i,o,s);return{sourceX:r.x,sourceY:r.y,targetX:c.x,targetY:c.y}};function Mr({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:s,targetHeight:i,width:r,height:c,transform:l}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+o,t.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const a=et({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:r/l[2],height:c/l[2]}),d=Math.max(0,Math.min(a.x2,u.x2)-Math.max(a.x,u.x)),g=Math.max(0,Math.min(a.y2,u.y2)-Math.max(a.y,u.y));return Math.ceil(d*g)>0}function xn(e){const t=e?.[Q]?.handleBounds||null,n=t&&e?.width&&e?.height&&typeof e?.positionAbsolute?.x<"u"&&typeof e?.positionAbsolute?.y<"u";return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!n]}const Ar=[{level:0,isMaxLevel:!0,edges:[]}];function $r(e,t,n=!1){let o=-1;const s=e.reduce((r,c)=>{const l=fe(c.zIndex);let u=l?c.zIndex:0;if(n){const a=t.get(c.target),d=t.get(c.source),g=c.selected||a?.selected||d?.selected,f=Math.max(d?.[Q]?.z||0,a?.[Q]?.z||0,1e3);u=(l?c.zIndex:0)+(g?f:0)}return r[u]?r[u].push(c):r[u]=[c],o=u>o?u:o,r},{}),i=Object.entries(s).map(([r,c])=>{const l=+r;return{edges:c,level:l,isMaxLevel:l===o}});return i.length===0?Ar:i}function Ir(e,t,n){const o=j(p.useCallback(s=>e?s.edges.filter(i=>{const r=t.get(i.source),c=t.get(i.target);return r?.width&&r?.height&&c?.width&&c?.height&&Mr({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:c.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:c.width,targetHeight:c.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return $r(o,t,n)}const _r=({color:e="none",strokeWidth:t=1})=>m.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),kr=({color:e="none",strokeWidth:t=1})=>m.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),En={[lt.Arrow]:_r,[lt.ArrowClosed]:kr};function Hr(e){const t=oe();return p.useMemo(()=>Object.prototype.hasOwnProperty.call(En,e)?En[e]:(t.getState().onError?.("009",xe.error009(e)),null),[e])}const Rr=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:r,orient:c="auto-start-reverse"})=>{const l=Hr(t);return l?m.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:c,refX:"0",refY:"0"},m.createElement(l,{color:n,strokeWidth:r})):null},Dr=({defaultColor:e,rfId:t})=>n=>{const o=[];return n.edges.reduce((s,i)=>([i.markerStart,i.markerEnd].forEach(r=>{if(r&&typeof r=="object"){const c=$t(r,t);o.includes(c)||(s.push({id:c,color:r.color||e,...r}),o.push(c))}}),s),[]).sort((s,i)=>s.id.localeCompare(i.id))},lo=({defaultColor:e,rfId:t})=>{const n=j(p.useCallback(Dr({defaultColor:e,rfId:t}),[e,t]),(o,s)=>!(o.length!==s.length||o.some((i,r)=>i.id!==s[r].id)));return m.createElement("defs",null,n.map(o=>m.createElement(Rr,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};lo.displayName="MarkerDefinitions";var Tr=p.memo(lo);const zr=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),uo=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:o,edgeTypes:s,noPanClassName:i,onEdgeContextMenu:r,onEdgeMouseEnter:c,onEdgeMouseMove:l,onEdgeMouseLeave:u,onEdgeClick:a,onEdgeDoubleClick:d,onReconnect:g,onReconnectStart:f,onReconnectEnd:E,reconnectRadius:h,children:y,disableKeyboardA11y:x})=>{const{edgesFocusable:w,edgesUpdatable:N,elementsSelectable:C,width:I,height:A,connectionMode:B,nodeInternals:D,onError:v}=j(zr,se),_=Ir(t,D,n);return I?m.createElement(m.Fragment,null,_.map(({level:k,edges:H,isMaxLevel:M})=>m.createElement("svg",{key:k,style:{zIndex:k},width:I,height:A,className:"react-flow__edges react-flow__container"},M&&m.createElement(Tr,{defaultColor:e,rfId:o}),m.createElement("g",null,H.map(S=>{const[$,z,Z]=xn(D.get(S.source)),[F,b,P]=xn(D.get(S.target));if(!Z||!P)return null;let R=S.type||"default";s[R]||(v?.("011",xe.error011(R)),R="default");const T=s[R]||s.default,L=B===Re.Strict?b.target:(b.target??[]).concat(b.source??[]),W=yn(z.source,S.sourceHandle),U=yn(L,S.targetHandle),G=W?.position||O.Bottom,J=U?.position||O.Top,te=!!(S.focusable||w&&typeof S.focusable>"u"),q=S.reconnectable||S.updatable,X=typeof g<"u"&&(q||N&&typeof q>"u");if(!W||!U)return v?.("008",xe.error008(W,S)),null;const{sourceX:re,sourceY:ne,targetX:le,targetY:ce}=Cr($,W,G,F,U,J);return m.createElement(T,{key:S.id,id:S.id,className:ie([S.className,i]),type:R,data:S.data,selected:!!S.selected,animated:!!S.animated,hidden:!!S.hidden,label:S.label,labelStyle:S.labelStyle,labelShowBg:S.labelShowBg,labelBgStyle:S.labelBgStyle,labelBgPadding:S.labelBgPadding,labelBgBorderRadius:S.labelBgBorderRadius,style:S.style,source:S.source,target:S.target,sourceHandleId:S.sourceHandle,targetHandleId:S.targetHandle,markerEnd:S.markerEnd,markerStart:S.markerStart,sourceX:re,sourceY:ne,targetX:le,targetY:ce,sourcePosition:G,targetPosition:J,elementsSelectable:C,onContextMenu:r,onMouseEnter:c,onMouseMove:l,onMouseLeave:u,onClick:a,onEdgeDoubleClick:d,onReconnect:g,onReconnectStart:f,onReconnectEnd:E,reconnectRadius:h,rfId:o,ariaLabel:S.ariaLabel,isFocusable:te,isReconnectable:X,pathOptions:"pathOptions"in S?S.pathOptions:void 0,interactionWidth:S.interactionWidth,disableKeyboardA11y:x})})))),y):null};uo.displayName="EdgeRenderer";var Pr=p.memo(uo);const Br=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Vr({children:e}){const t=j(Br);return m.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function Or(e){const t=Zt(),n=p.useRef(!1);p.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Lr={[O.Left]:O.Right,[O.Right]:O.Left,[O.Top]:O.Bottom,[O.Bottom]:O.Top},fo=({nodeId:e,handleType:t,style:n,type:o=Se.Bezier,CustomComponent:s,connectionStatus:i})=>{const{fromNode:r,handleId:c,toX:l,toY:u,connectionMode:a}=j(p.useCallback(A=>({fromNode:A.nodeInternals.get(e),handleId:A.connectionHandleId,toX:(A.connectionPosition.x-A.transform[0])/A.transform[2],toY:(A.connectionPosition.y-A.transform[1])/A.transform[2],connectionMode:A.connectionMode}),[e]),se),d=r?.[Q]?.handleBounds;let g=d?.[t];if(a===Re.Loose&&(g=g||d?.[t==="source"?"target":"source"]),!r||!g)return null;const f=c?g.find(A=>A.id===c):g[0],E=f?f.x+f.width/2:(r.width??0)/2,h=f?f.y+f.height/2:r.height??0,y=(r.positionAbsolute?.x??0)+E,x=(r.positionAbsolute?.y??0)+h,w=f?.position,N=w?Lr[w]:null;if(!w||!N)return null;if(s)return m.createElement(s,{connectionLineType:o,connectionLineStyle:n,fromNode:r,fromHandle:f,fromX:y,fromY:x,toX:l,toY:u,fromPosition:w,toPosition:N,connectionStatus:i});let C="";const I={sourceX:y,sourceY:x,sourcePosition:w,targetX:l,targetY:u,targetPosition:N};return o===Se.Bezier?[C]=Dn(I):o===Se.Step?[C]=At({...I,borderRadius:0}):o===Se.SmoothStep?[C]=At(I):o===Se.SimpleBezier?[C]=Rn(I):C=`M${y},${x} ${l},${u}`,m.createElement("path",{d:C,fill:"none",className:"react-flow__connection-path",style:n})};fo.displayName="ConnectionLine";const Fr=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function Zr({containerStyle:e,style:t,type:n,component:o}){const{nodeId:s,handleType:i,nodesConnectable:r,width:c,height:l,connectionStatus:u}=j(Fr,se);return!(s&&i&&c&&r)?null:m.createElement("svg",{style:e,width:c,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},m.createElement("g",{className:ie(["react-flow__connection",u])},m.createElement(fo,{nodeId:s,handleType:i,style:t,type:n,CustomComponent:o,connectionStatus:u})))}function wn(e,t){return p.useRef(null),oe(),p.useMemo(()=>t(e),[e])}const go=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:o,onMoveEnd:s,onInit:i,onNodeClick:r,onEdgeClick:c,onNodeDoubleClick:l,onEdgeDoubleClick:u,onNodeMouseEnter:a,onNodeMouseMove:d,onNodeMouseLeave:g,onNodeContextMenu:f,onSelectionContextMenu:E,onSelectionStart:h,onSelectionEnd:y,connectionLineType:x,connectionLineStyle:w,connectionLineComponent:N,connectionLineContainerStyle:C,selectionKeyCode:I,selectionOnDrag:A,selectionMode:B,multiSelectionKeyCode:D,panActivationKeyCode:v,zoomActivationKeyCode:_,deleteKeyCode:k,onlyRenderVisibleElements:H,elementsSelectable:M,selectNodesOnDrag:S,defaultViewport:$,translateExtent:z,minZoom:Z,maxZoom:F,preventScrolling:b,defaultMarkerColor:P,zoomOnScroll:R,zoomOnPinch:T,panOnScroll:L,panOnScrollSpeed:W,panOnScrollMode:U,zoomOnDoubleClick:G,panOnDrag:J,onPaneClick:te,onPaneMouseEnter:q,onPaneMouseMove:X,onPaneMouseLeave:re,onPaneScroll:ne,onPaneContextMenu:le,onEdgeContextMenu:ce,onEdgeMouseEnter:ee,onEdgeMouseMove:ue,onEdgeMouseLeave:K,onReconnect:V,onReconnectStart:de,onReconnectEnd:me,reconnectRadius:Xe,noDragClassName:De,noWheelClassName:Te,noPanClassName:ye,elevateEdgesOnSelect:ze,disableKeyboardA11y:Ne,nodeOrigin:ve,nodeExtent:Pe,rfId:Be})=>{const Ge=wn(e,yr),ae=wn(t,vr);return Or(i),m.createElement(pr,{onPaneClick:te,onPaneMouseEnter:q,onPaneMouseMove:X,onPaneMouseLeave:re,onPaneContextMenu:le,onPaneScroll:ne,deleteKeyCode:k,selectionKeyCode:I,selectionOnDrag:A,selectionMode:B,onSelectionStart:h,onSelectionEnd:y,multiSelectionKeyCode:D,panActivationKeyCode:v,zoomActivationKeyCode:_,elementsSelectable:M,onMove:n,onMoveStart:o,onMoveEnd:s,zoomOnScroll:R,zoomOnPinch:T,zoomOnDoubleClick:G,panOnScroll:L,panOnScrollSpeed:W,panOnScrollMode:U,panOnDrag:J,defaultViewport:$,translateExtent:z,minZoom:Z,maxZoom:F,onSelectionContextMenu:E,preventScrolling:b,noDragClassName:De,noWheelClassName:Te,noPanClassName:ye,disableKeyboardA11y:Ne},m.createElement(Vr,null,m.createElement(Pr,{edgeTypes:ae,onEdgeClick:c,onEdgeDoubleClick:u,onlyRenderVisibleElements:H,onEdgeContextMenu:ce,onEdgeMouseEnter:ee,onEdgeMouseMove:ue,onEdgeMouseLeave:K,onReconnect:V,onReconnectStart:de,onReconnectEnd:me,reconnectRadius:Xe,defaultMarkerColor:P,noPanClassName:ye,elevateEdgesOnSelect:!!ze,disableKeyboardA11y:Ne,rfId:Be},m.createElement(Zr,{style:w,type:x,component:N,containerStyle:C})),m.createElement("div",{className:"react-flow__edgelabel-renderer"}),m.createElement(wr,{nodeTypes:Ge,onNodeClick:r,onNodeDoubleClick:l,onNodeMouseEnter:a,onNodeMouseMove:d,onNodeMouseLeave:g,onNodeContextMenu:f,selectNodesOnDrag:S,onlyRenderVisibleElements:H,noPanClassName:ye,noDragClassName:De,disableKeyboardA11y:Ne,nodeOrigin:ve,nodeExtent:Pe,rfId:Be})))};go.displayName="GraphView";var Wr=p.memo(go);const Ht=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Ee={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Ht,nodeExtent:Ht,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Re.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:xs,isValidConnection:void 0},Yr=()=>ds((e,t)=>({...Ee,setNodes:n=>{const{nodeInternals:o,nodeOrigin:s,elevateNodesOnSelect:i}=t();e({nodeInternals:wt(n,o,s,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:o={}}=t();e({edges:n.map(s=>({...o,...s}))})},setDefaultNodesAndEdges:(n,o)=>{const s=typeof n<"u",i=typeof o<"u",r=s?wt(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:r,edges:i?o:[],hasDefaultNodes:s,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:o,nodeInternals:s,fitViewOnInit:i,fitViewOnInitDone:r,fitViewOnInitOptions:c,domNode:l,nodeOrigin:u}=t(),a=l?.querySelector(".react-flow__viewport");if(!a)return;const d=window.getComputedStyle(a),{m22:g}=new window.DOMMatrixReadOnly(d.transform),f=n.reduce((h,y)=>{const x=s.get(y.id);if(x?.hidden)s.set(x.id,{...x,[Q]:{...x[Q],handleBounds:void 0}});else if(x){const w=Tt(y.nodeElement);!!(w.width&&w.height&&(x.width!==w.width||x.height!==w.height||y.forceUpdate))&&(s.set(x.id,{...x,[Q]:{...x[Q],handleBounds:{source:gn(".source",y.nodeElement,g,u),target:gn(".target",y.nodeElement,g,u)}},...w}),h.push({id:x.id,type:"dimensions",dimensions:w}))}return h},[]);Qn(s,u);const E=r||i&&!r&&Jn(t,{initial:!0,...c});e({nodeInternals:new Map(s),fitViewOnInitDone:E}),f?.length>0&&o?.(f)},updateNodePositions:(n,o=!0,s=!1)=>{const{triggerNodeChanges:i}=t(),r=n.map(c=>{const l={id:c.id,type:"position",dragging:s};return o&&(l.positionAbsolute=c.positionAbsolute,l.position=c.position),l});i(r)},triggerNodeChanges:n=>{const{onNodesChange:o,nodeInternals:s,hasDefaultNodes:i,nodeOrigin:r,getNodes:c,elevateNodesOnSelect:l}=t();if(n?.length){if(i){const u=to(n,c()),a=wt(u,s,r,l);e({nodeInternals:a})}o?.(n)}},addSelectedNodes:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(l=>we(l,!0)):(r=We(i(),n),c=We(s,[])),it({changedNodes:r,changedEdges:c,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(l=>we(l,!0)):(r=We(s,n),c=We(i(),[])),it({changedNodes:c,changedEdges:r,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{const{edges:s,getNodes:i}=t(),r=n||i(),c=o||s,l=r.map(a=>(a.selected=!1,we(a.id,!1))),u=c.map(a=>we(a.id,!1));it({changedNodes:l,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:o,maxZoom:s}=t();o?.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:o,minZoom:s}=t();o?.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{t().d3Zoom?.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:o}=t(),i=o().filter(c=>c.selected).map(c=>we(c.id,!1)),r=n.filter(c=>c.selected).map(c=>we(c.id,!1));it({changedNodes:i,changedEdges:r,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:o}=t();o.forEach(s=>{s.positionAbsolute=zt(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{const{transform:o,width:s,height:i,d3Zoom:r,d3Selection:c,translateExtent:l}=t();if(!r||!c||!n.x&&!n.y)return!1;const u=ke.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),a=[[0,0],[s,i]],d=r?.constrain()(u,a,l);return r.transform(c,d),o[0]!==d.x||o[1]!==d.y||o[2]!==d.k},cancelConnection:()=>e({connectionNodeId:Ee.connectionNodeId,connectionHandleId:Ee.connectionHandleId,connectionHandleType:Ee.connectionHandleType,connectionStatus:Ee.connectionStatus,connectionStartHandle:Ee.connectionStartHandle,connectionEndHandle:Ee.connectionEndHandle}),reset:()=>e({...Ee})}),Object.is),ho=({children:e})=>{const t=p.useRef(null);return t.current||(t.current=Yr()),m.createElement(us,{value:t.current},e)};ho.displayName="ReactFlowProvider";const po=({children:e})=>p.useContext(ft)?m.createElement(m.Fragment,null,e):m.createElement(ho,null,e);po.displayName="ReactFlowWrapper";const Ur={input:Yn,default:_t,output:Xn,group:Ft},Xr={default:dt,straight:Vt,step:Bt,smoothstep:gt,simplebezier:Pt},Gr=[0,0],Kr=[15,15],qr={x:0,y:0,zoom:1},jr={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Qr=p.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:i=Ur,edgeTypes:r=Xr,onNodeClick:c,onEdgeClick:l,onInit:u,onMove:a,onMoveStart:d,onMoveEnd:g,onConnect:f,onConnectStart:E,onConnectEnd:h,onClickConnectStart:y,onClickConnectEnd:x,onNodeMouseEnter:w,onNodeMouseMove:N,onNodeMouseLeave:C,onNodeContextMenu:I,onNodeDoubleClick:A,onNodeDragStart:B,onNodeDrag:D,onNodeDragStop:v,onNodesDelete:_,onEdgesDelete:k,onSelectionChange:H,onSelectionDragStart:M,onSelectionDrag:S,onSelectionDragStop:$,onSelectionContextMenu:z,onSelectionStart:Z,onSelectionEnd:F,connectionMode:b=Re.Strict,connectionLineType:P=Se.Bezier,connectionLineStyle:R,connectionLineComponent:T,connectionLineContainerStyle:L,deleteKeyCode:W="Backspace",selectionKeyCode:U="Shift",selectionOnDrag:G=!1,selectionMode:J=tt.Full,panActivationKeyCode:te="Space",multiSelectionKeyCode:q=at()?"Meta":"Control",zoomActivationKeyCode:X=at()?"Meta":"Control",snapToGrid:re=!1,snapGrid:ne=Kr,onlyRenderVisibleElements:le=!1,selectNodesOnDrag:ce=!0,nodesDraggable:ee,nodesConnectable:ue,nodesFocusable:K,nodeOrigin:V=Gr,edgesFocusable:de,edgesUpdatable:me,elementsSelectable:Xe,defaultViewport:De=qr,minZoom:Te=.5,maxZoom:ye=2,translateExtent:ze=Ht,preventScrolling:Ne=!0,nodeExtent:ve,defaultMarkerColor:Pe="#b1b1b7",zoomOnScroll:Be=!0,zoomOnPinch:Ge=!0,panOnScroll:ae=!1,panOnScrollSpeed:he=.5,panOnScrollMode:Ce=_e.Free,zoomOnDoubleClick:Me=!0,panOnDrag:Ve=!0,onPaneClick:pe,onPaneMouseEnter:Ae,onPaneMouseMove:pt,onPaneMouseLeave:mt,onPaneScroll:Ke,onPaneContextMenu:yt,children:Yt,onEdgeContextMenu:$e,onEdgeDoubleClick:So,onEdgeMouseEnter:bo,onEdgeMouseMove:No,onEdgeMouseLeave:vo,onEdgeUpdate:Co,onEdgeUpdateStart:Mo,onEdgeUpdateEnd:Ao,onReconnect:$o,onReconnectStart:Io,onReconnectEnd:_o,reconnectRadius:ko=10,edgeUpdaterRadius:Ho=10,onNodesChange:Ro,onEdgesChange:Do,noDragClassName:To="nodrag",noWheelClassName:zo="nowheel",noPanClassName:Ut="nopan",fitView:Po=!1,fitViewOptions:Bo,connectOnClick:Vo=!0,attributionPosition:Oo,proOptions:Lo,defaultEdgeOptions:Fo,elevateNodesOnSelect:Zo=!0,elevateEdgesOnSelect:Wo=!1,disableKeyboardA11y:Xt=!1,autoPanOnConnect:Yo=!0,autoPanOnNodeDrag:Uo=!0,connectionRadius:Xo=20,isValidConnection:Go,onError:Ko,style:qo,id:Gt,nodeDragThreshold:jo,...Qo},Jo)=>{const xt=Gt||"1";return m.createElement("div",{...Qo,style:{...qo,...jr},ref:Jo,className:ie(["react-flow",s]),"data-testid":"rf__wrapper",id:Gt},m.createElement(po,null,m.createElement(Wr,{onInit:u,onMove:a,onMoveStart:d,onMoveEnd:g,onNodeClick:c,onEdgeClick:l,onNodeMouseEnter:w,onNodeMouseMove:N,onNodeMouseLeave:C,onNodeContextMenu:I,onNodeDoubleClick:A,nodeTypes:i,edgeTypes:r,connectionLineType:P,connectionLineStyle:R,connectionLineComponent:T,connectionLineContainerStyle:L,selectionKeyCode:U,selectionOnDrag:G,selectionMode:J,deleteKeyCode:W,multiSelectionKeyCode:q,panActivationKeyCode:te,zoomActivationKeyCode:X,onlyRenderVisibleElements:le,selectNodesOnDrag:ce,defaultViewport:De,translateExtent:ze,minZoom:Te,maxZoom:ye,preventScrolling:Ne,zoomOnScroll:Be,zoomOnPinch:Ge,zoomOnDoubleClick:Me,panOnScroll:ae,panOnScrollSpeed:he,panOnScrollMode:Ce,panOnDrag:Ve,onPaneClick:pe,onPaneMouseEnter:Ae,onPaneMouseMove:pt,onPaneMouseLeave:mt,onPaneScroll:Ke,onPaneContextMenu:yt,onSelectionContextMenu:z,onSelectionStart:Z,onSelectionEnd:F,onEdgeContextMenu:$e,onEdgeDoubleClick:So,onEdgeMouseEnter:bo,onEdgeMouseMove:No,onEdgeMouseLeave:vo,onReconnect:$o??Co,onReconnectStart:Io??Mo,onReconnectEnd:_o??Ao,reconnectRadius:ko??Ho,defaultMarkerColor:Pe,noDragClassName:To,noWheelClassName:zo,noPanClassName:Ut,elevateEdgesOnSelect:Wo,rfId:xt,disableKeyboardA11y:Xt,nodeOrigin:V,nodeExtent:ve}),m.createElement(Ls,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:f,onConnectStart:E,onConnectEnd:h,onClickConnectStart:y,onClickConnectEnd:x,nodesDraggable:ee,nodesConnectable:ue,nodesFocusable:K,edgesFocusable:de,edgesUpdatable:me,elementsSelectable:Xe,elevateNodesOnSelect:Zo,minZoom:Te,maxZoom:ye,nodeExtent:ve,onNodesChange:Ro,onEdgesChange:Do,snapToGrid:re,snapGrid:ne,connectionMode:b,translateExtent:ze,connectOnClick:Vo,defaultEdgeOptions:Fo,fitView:Po,fitViewOptions:Bo,onNodesDelete:_,onEdgesDelete:k,onNodeDragStart:B,onNodeDrag:D,onNodeDragStop:v,onSelectionDrag:S,onSelectionDragStart:M,onSelectionDragStop:$,noPanClassName:Ut,nodeOrigin:V,rfId:xt,autoPanOnConnect:Yo,autoPanOnNodeDrag:Uo,onError:Ko,connectionRadius:Xo,isValidConnection:Go,nodeDragThreshold:jo}),m.createElement(Vs,{onSelectionChange:H}),Yt,m.createElement(gs,{proOptions:Lo,position:Oo}),m.createElement(Us,{rfId:xt,disableKeyboardA11y:Xt})))});Qr.displayName="ReactFlow";function mo(e){return t=>{const[n,o]=p.useState(t),s=p.useCallback(i=>o(r=>e(i,r)),[]);return[n,o,s]}}const Si=mo(to),bi=mo(ir),yo=({id:e,x:t,y:n,width:o,height:s,style:i,color:r,strokeColor:c,strokeWidth:l,className:u,borderRadius:a,shapeRendering:d,onClick:g,selected:f})=>{const{background:E,backgroundColor:h}=i||{},y=r||E||h;return m.createElement("rect",{className:ie(["react-flow__minimap-node",{selected:f},u]),x:t,y:n,rx:a,ry:a,width:o,height:s,fill:y,stroke:c,strokeWidth:l,shapeRendering:d,onClick:g?x=>g(x,e):void 0})};yo.displayName="MiniMapNode";var Jr=p.memo(yo);const ei=e=>e.nodeOrigin,ti=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),vt=e=>e instanceof Function?e:()=>e;function ni({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:s=2,nodeComponent:i=Jr,onClick:r}){const c=j(ti,se),l=j(ei),u=vt(t),a=vt(e),d=vt(n),g=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return m.createElement(m.Fragment,null,c.map(f=>{const{x:E,y:h}=He(f,l).positionAbsolute;return m.createElement(i,{key:f.id,x:E,y:h,width:f.width,height:f.height,style:f.style,selected:f.selected,className:d(f),color:u(f),borderRadius:o,strokeColor:a(f),strokeWidth:s,shapeRendering:g,onClick:r,id:f.id})}))}var oi=p.memo(ni);const si=200,ri=150,ii=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?ms(ht(t,e.nodeOrigin),n):n,rfId:e.rfId}},ci="react-flow__minimap-desc";function xo({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:o="#e2e2e2",nodeClassName:s="",nodeBorderRadius:i=5,nodeStrokeWidth:r=2,nodeComponent:c,maskColor:l="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:a=1,position:d="bottom-right",onClick:g,onNodeClick:f,pannable:E=!1,zoomable:h=!1,ariaLabel:y="React Flow mini map",inversePan:x=!1,zoomStep:w=10,offsetScale:N=5}){const C=oe(),I=p.useRef(null),{boundingRect:A,viewBB:B,rfId:D}=j(ii,se),v=e?.width??si,_=e?.height??ri,k=A.width/v,H=A.height/_,M=Math.max(k,H),S=M*v,$=M*_,z=N*M,Z=A.x-(S-A.width)/2-z,F=A.y-($-A.height)/2-z,b=S+z*2,P=$+z*2,R=`${ci}-${D}`,T=p.useRef(0);T.current=M,p.useEffect(()=>{if(I.current){const U=Rt(I.current),G=q=>{const{transform:X,d3Selection:re,d3Zoom:ne}=C.getState();if(q.sourceEvent.type!=="wheel"||!re||!ne)return;const le=-q.sourceEvent.deltaY*(q.sourceEvent.deltaMode===1?.05:q.sourceEvent.deltaMode?1:.002)*w,ce=X[2]*Math.pow(2,le);ne.scaleTo(re,ce)},J=q=>{const{transform:X,d3Selection:re,d3Zoom:ne,translateExtent:le,width:ce,height:ee}=C.getState();if(q.sourceEvent.type!=="mousemove"||!re||!ne)return;const ue=T.current*Math.max(1,X[2])*(x?-1:1),K={x:X[0]-q.sourceEvent.movementX*ue,y:X[1]-q.sourceEvent.movementY*ue},V=[[0,0],[ce,ee]],de=ke.translate(K.x,K.y).scale(X[2]),me=ne.constrain()(de,V,le);ne.transform(re,me)},te=Sn().on("zoom",E?J:null).on("zoom.wheel",h?G:null);return U.call(te),()=>{U.on("zoom",null)}}},[E,h,x,w]);const L=g?U=>{const G=bn(U);g(U,{x:G[0],y:G[1]})}:void 0,W=f?(U,G)=>{const J=C.getState().nodeInternals.get(G);f(U,J)}:void 0;return m.createElement(Dt,{position:d,style:e,className:ie(["react-flow__minimap",t]),"data-testid":"rf__minimap"},m.createElement("svg",{width:v,height:_,viewBox:`${Z} ${F} ${b} ${P}`,role:"img","aria-labelledby":R,ref:I,onClick:L},y&&m.createElement("title",{id:R},y),m.createElement(oi,{onClick:W,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:s,nodeStrokeWidth:r,nodeComponent:c}),m.createElement("path",{className:"react-flow__minimap-mask",d:`M${Z-z},${F-z}h${b+z*2}v${P+z*2}h${-b-z*2}z
        M${B.x},${B.y}h${B.width}v${B.height}h${-B.width}z`,fill:l,fillRule:"evenodd",stroke:u,strokeWidth:a,pointerEvents:"none"})))}xo.displayName="MiniMap";var Ni=p.memo(xo);function ai(){return m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},m.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function li(){return m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},m.createElement("path",{d:"M0 0h32v4.2H0z"}))}function di(){return m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},m.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function ui(){return m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},m.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function fi(){return m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},m.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Je=({children:e,className:t,...n})=>m.createElement("button",{type:"button",className:ie(["react-flow__controls-button",t]),...n},e);Je.displayName="ControlButton";const gi=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Eo=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:i,onZoomOut:r,onFitView:c,onInteractiveChange:l,className:u,children:a,position:d="bottom-left"})=>{const g=oe(),[f,E]=p.useState(!1),{isInteractive:h,minZoomReached:y,maxZoomReached:x}=j(gi,se),{zoomIn:w,zoomOut:N,fitView:C}=Zt();if(p.useEffect(()=>{E(!0)},[]),!f)return null;const I=()=>{w(),i?.()},A=()=>{N(),r?.()},B=()=>{C(s),c?.()},D=()=>{g.setState({nodesDraggable:!h,nodesConnectable:!h,elementsSelectable:!h}),l?.(!h)};return m.createElement(Dt,{className:ie(["react-flow__controls",u]),position:d,style:e,"data-testid":"rf__controls"},t&&m.createElement(m.Fragment,null,m.createElement(Je,{onClick:I,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:x},m.createElement(ai,null)),m.createElement(Je,{onClick:A,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:y},m.createElement(li,null))),n&&m.createElement(Je,{className:"react-flow__controls-fitview",onClick:B,title:"fit view","aria-label":"fit view"},m.createElement(di,null)),o&&m.createElement(Je,{className:"react-flow__controls-interactive",onClick:D,title:"toggle interactivity","aria-label":"toggle interactivity"},h?m.createElement(fi,null):m.createElement(ui,null)),a)};Eo.displayName="Controls";var vi=p.memo(Eo),ge;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(ge||(ge={}));function hi({color:e,dimensions:t,lineWidth:n}){return m.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function pi({color:e,radius:t}){return m.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const mi={[ge.Dots]:"#91919a",[ge.Lines]:"#eee",[ge.Cross]:"#e2e2e2"},yi={[ge.Dots]:1,[ge.Lines]:1,[ge.Cross]:6},xi=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function wo({id:e,variant:t=ge.Dots,gap:n=20,size:o,lineWidth:s=1,offset:i=2,color:r,style:c,className:l}){const u=p.useRef(null),{transform:a,patternId:d}=j(xi,se),g=r||mi[t],f=o||yi[t],E=t===ge.Dots,h=t===ge.Cross,y=Array.isArray(n)?n:[n,n],x=[y[0]*a[2]||1,y[1]*a[2]||1],w=f*a[2],N=h?[w,w]:x,C=E?[w/i,w/i]:[N[0]/i,N[1]/i];return m.createElement("svg",{className:ie(["react-flow__background",l]),style:{...c,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},m.createElement("pattern",{id:d+e,x:a[0]%x[0],y:a[1]%x[1],width:x[0],height:x[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${C[0]},-${C[1]})`},E?m.createElement(pi,{color:g,radius:w/i}):m.createElement(hi,{dimensions:N,color:g,lineWidth:s})),m.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${d+e})`}))}wo.displayName="Background";var Ci=p.memo(wo);export{Ci as B,vi as C,ut as H,Ni as M,O as P,ho as R,Zt as a,Si as b,ns as c,bi as d,Qr as e,ge as f,is as u};
