import{r as c,j as e,L as B}from"./react-vendor-D847gc3Q.js";import{e as D,i as j,m as N,A as P}from"./index-MC6c9alI.js";import{G as y}from"./GlassSurface-CW71V7bR.js";import{G as u}from"./GlassButton-BrjojfTU.js";import{G as F,A as I,d as E}from"./GlassNav-DAHxuQeJ.js";import{M as G}from"./MeshBackground-BqbFOsCF.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./apollo-vendor-BNHFeEEc.js";import"./reactflow-vendor-5ig9bY2l.js";import"./d3-vendor-DkU_Wy0v.js";import"./recharts-vendor-d8oTApeF.js";const o={Shield:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),Star:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),Clock:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),Plus:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),X:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),ChevronRight:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})},p={"U.S. Army":{color:"#556B2F",icon:"ðŸª–"},"U.S. Marine Corps":{color:"#8B0000",icon:"ðŸ¦…"},"U.S. Navy":{color:"#000080",icon:"âš“"},"U.S. Air Force":{color:"#00308F",icon:"âœˆï¸"},"Fire Service":{color:"#B22222",icon:"ðŸš’"},"Law Enforcement":{color:"#191970",icon:"ðŸš”"},FBI:{color:"#003366",icon:"ðŸ”"},EMS:{color:"#FF6347",icon:"ðŸš‘"},default:{color:"#6366f1",icon:"ðŸ‹ï¸"}};function O({test:t,onClick:n,isSelected:i}){const l=p[t.institution]||p.default;return e.jsxs(N.button,{onClick:n,initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{scale:1.02},className:`w-full p-4 rounded-xl text-left transition-all ${i?"bg-[var(--brand-blue-500)]/20 border-[var(--brand-blue-500)]":"bg-[var(--glass-white-5)] border-[var(--border-subtle)] hover:bg-[var(--glass-white-10)]"} border`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:l.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-[var(--text-primary)] truncate",children:t.name}),e.jsx("p",{className:"text-sm text-[var(--text-tertiary)]",children:t.institution})]}),e.jsx(o.ChevronRight,{className:"w-5 h-5 text-[var(--text-quaternary)]"})]}),t.components&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-1",children:[t.components.slice(0,3).map(r=>e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-[var(--glass-white-10)] text-[var(--text-tertiary)]",children:r.name},r.id)),t.components.length>3&&e.jsxs("span",{className:"px-2 py-0.5 rounded-full text-xs bg-[var(--glass-white-10)] text-[var(--text-tertiary)]",children:["+",t.components.length-3," more"]})]})]})}function q({test:t,onRecordResult:n}){const i=p[t.institution]||p.default;return e.jsxs(y,{className:"p-6",depth:"medium",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center text-3xl",style:{backgroundColor:`${i.color}20`},children:i.icon}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-[var(--text-primary)]",children:t.name}),e.jsx("p",{className:"text-[var(--text-secondary)]",children:t.institution})]})]}),e.jsxs(u,{variant:"primary",onClick:n,children:[e.jsx(o.Plus,{className:"w-5 h-5 mr-2"}),"Log Result"]})]}),t.description&&e.jsx("p",{className:"text-[var(--text-tertiary)] mb-6",children:t.description}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-[var(--glass-white-5)]",children:[e.jsx("div",{className:"text-2xl font-bold text-[var(--text-primary)]",children:t.maxScore||"â€”"}),e.jsx("div",{className:"text-sm text-[var(--text-tertiary)]",children:"Max Score"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-[var(--glass-white-5)]",children:[e.jsx("div",{className:"text-2xl font-bold text-[var(--text-primary)]",children:t.passingScore||"â€”"}),e.jsx("div",{className:"text-sm text-[var(--text-tertiary)]",children:"Passing"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-[var(--glass-white-5)]",children:[e.jsx("div",{className:"text-2xl font-bold text-[var(--text-primary)] capitalize",children:t.scoringMethod?.replace("_"," ")||"â€”"}),e.jsx("div",{className:"text-sm text-[var(--text-tertiary)]",children:"Scoring"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-[var(--text-primary)] mb-4",children:"Test Components"}),e.jsx("div",{className:"space-y-3",children:t.components?.map((l,r)=>e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-xl bg-[var(--glass-white-5)]",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-[var(--brand-blue-500)]/20 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-sm font-bold text-[var(--brand-blue-400)]",children:r+1})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-[var(--text-primary)]",children:l.name}),l.description&&e.jsx("div",{className:"text-sm text-[var(--text-tertiary)]",children:l.description}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[l.type&&e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[var(--glass-white-10)] text-[var(--text-quaternary)]",children:l.type}),l.durationSeconds&&e.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[var(--glass-white-10)] text-[var(--text-quaternary)]",children:[l.durationSeconds,"s"]}),l.distanceMiles&&e.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[var(--glass-white-10)] text-[var(--text-quaternary)]",children:[l.distanceMiles," mi"]})]})]})]},l.id))})]})]})}function z({isOpen:t,onClose:n,test:i,onSubmit:l}){const[r,x]=c.useState({testDate:new Date().toISOString().split("T")[0],componentResults:{},official:!1,location:"",notes:""});if(c.useEffect(()=>{if(i){const s={};i.components?.forEach(d=>{s[d.id]=""}),x(d=>({...d,componentResults:s}))}},[i]),!t||!i)return null;const f=s=>{s.preventDefault();const d=Object.entries(r.componentResults).map(([h,g])=>({componentId:h,value:parseFloat(g)||0}));l({ptTestId:i.id,testDate:r.testDate,componentResults:d,official:r.official,location:r.location||void 0,notes:r.notes||void 0})};return e.jsx(P,{children:e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:n,children:e.jsxs(N.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"w-full max-w-lg bg-[var(--void-base)] border border-[var(--border-subtle)] rounded-2xl p-6 max-h-[90vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-[var(--text-primary)]",children:"Log PT Test Result"}),e.jsx("button",{onClick:n,className:"text-[var(--text-tertiary)] hover:text-[var(--text-primary)]",children:e.jsx(o.X,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1",children:"Test Date"}),e.jsx("input",{type:"date",required:!0,value:r.testDate,onChange:s=>x({...r,testDate:s.target.value}),className:"w-full px-3 py-2 rounded-lg bg-[var(--glass-white-5)] border border-[var(--border-subtle)] text-[var(--text-primary)]"})]}),e.jsxs("div",{className:"border-t border-[var(--border-subtle)] pt-4",children:[e.jsx("h3",{className:"font-semibold text-[var(--text-primary)] mb-3",children:"Results"}),e.jsx("div",{className:"space-y-3",children:i.components?.map(s=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-[var(--text-secondary)] mb-1",children:[s.name,s.type==="time"&&" (seconds)",s.type==="reps"&&" (reps)",s.type==="distance"&&" (meters)",s.type==="weight"&&" (lbs)"]}),e.jsx("input",{type:"number",step:"0.1",value:r.componentResults[s.id]||"",onChange:d=>x({...r,componentResults:{...r.componentResults,[s.id]:d.target.value}}),className:"w-full px-3 py-2 rounded-lg bg-[var(--glass-white-5)] border border-[var(--border-subtle)] text-[var(--text-primary)]",placeholder:s.type==="time"?"e.g., 720 for 12:00":"Enter value"})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1",children:"Location (Optional)"}),e.jsx("input",{type:"text",value:r.location,onChange:s=>x({...r,location:s.target.value}),className:"w-full px-3 py-2 rounded-lg bg-[var(--glass-white-5)] border border-[var(--border-subtle)] text-[var(--text-primary)]",placeholder:"e.g., Fort Bragg, Local Gym"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.official,onChange:s=>x({...r,official:s.target.checked}),className:"rounded border-[var(--border-subtle)]"}),e.jsx("span",{className:"text-sm text-[var(--text-secondary)]",children:"This was an official/proctored test"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1",children:"Notes (Optional)"}),e.jsx("textarea",{value:r.notes,onChange:s=>x({...r,notes:s.target.value}),rows:2,className:"w-full px-3 py-2 rounded-lg bg-[var(--glass-white-5)] border border-[var(--border-subtle)] text-[var(--text-primary)]",placeholder:"Any additional notes..."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(u,{type:"button",variant:"ghost",className:"flex-1",onClick:n,children:"Cancel"}),e.jsx(u,{type:"submit",variant:"primary",className:"flex-1",children:"Save Result"})]})]})]})})})}function U({result:t}){const n=t.passed,i=p[t.institution]||p.default;return e.jsxs("div",{className:"p-4 rounded-xl bg-[var(--glass-white-5)] border border-[var(--border-subtle)]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:i.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-[var(--text-primary)]",children:t.testName}),e.jsx("div",{className:"text-xs text-[var(--text-tertiary)]",children:new Date(t.testDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"text-right",children:[t.totalScore!==null&&e.jsx("div",{className:"text-xl font-bold text-[var(--text-primary)]",children:t.totalScore}),n!==null&&e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${n?"bg-[var(--feedback-success)]/20 text-[var(--feedback-success)]":"bg-[var(--feedback-error)]/20 text-[var(--feedback-error)]"}`,children:n?"PASS":"FAIL"}),t.category&&e.jsx("div",{className:"text-sm text-[var(--text-secondary)]",children:t.category})]})]}),t.official&&e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[var(--brand-blue-500)]/20 text-[var(--brand-blue-400)]",children:"Official"})]})}function ee(){const{user:t}=D(),[n,i]=c.useState([]),[l,r]=c.useState({}),[x,f]=c.useState([]),[s,d]=c.useState(null),[h,g]=c.useState(null),[T,C]=c.useState(!0),[R,v]=c.useState(!1),[w,k]=c.useState("tests");c.useEffect(()=>{L(),S(),M()},[]);const L=async()=>{try{const a=await j.get("/pt-tests"),m=a.data?.data||a.data||{};i(m.tests||[]),r(m.byInstitution||{})}catch{}finally{C(!1)}},S=async()=>{try{const a=await j.get("/pt-tests/results?limit=20"),m=a.data?.data||a.data||{};f(m.results||[])}catch{}},M=async()=>{try{const a=await j.get("/pt-tests/my-archetype"),m=a.data?.data||a.data||{};g(m.test)}catch{}},A=async a=>{try{await j.post("/pt-tests/results",a),v(!1),S()}catch{}};return e.jsxs("div",{className:"min-h-screen relative",children:[e.jsx(G,{intensity:"subtle"}),e.jsx(F,{brandSlot:e.jsxs(B,{to:"/dashboard",className:"flex items-center gap-3",children:[e.jsx(I,{size:32,breathing:!0}),e.jsx("span",{className:"font-bold text-lg text-[var(--text-primary)] hidden sm:block",children:"MuscleMap"})]})}),e.jsx("div",{className:"flex pt-16",children:e.jsx("main",{className:"flex-1 lg:ml-64 p-4 lg:p-8 pb-24 lg:pb-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-black text-[var(--text-primary)] tracking-tight",children:"PT Tests"}),e.jsx("p",{className:"text-[var(--text-secondary)]",children:"Military, first responder, and occupational fitness tests"})]}),h&&e.jsx(y,{className:"p-4 mb-6",depth:"subtle",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o.Star,{className:"w-5 h-5 text-[var(--brand-blue-400)]"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-[var(--text-primary)]",children:"Your PT Test"}),e.jsxs("div",{className:"text-sm text-[var(--text-tertiary)]",children:[h.name," (",h.institution,")"]})]})]}),e.jsx(u,{variant:"primary",size:"sm",onClick:()=>{d(h),v(!0)},children:"Log Result"})]})}),e.jsx("div",{className:"flex gap-2 mb-6",children:[{key:"tests",label:"All Tests",icon:o.Shield},{key:"history",label:"My History",icon:o.Clock}].map(a=>e.jsxs("button",{onClick:()=>k(a.key),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${w===a.key?"bg-[var(--brand-blue-500)] text-white":"bg-[var(--glass-white-5)] text-[var(--text-secondary)] hover:bg-[var(--glass-white-10)]"}`,children:[e.jsx(a.icon,{className:"w-4 h-4"}),a.label]},a.key))}),T?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-2 border-[var(--brand-blue-500)] border-t-transparent rounded-full animate-spin"})}):w==="tests"?e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-4",children:Object.entries(l).map(([a,m])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-[var(--text-tertiary)] uppercase tracking-wide mb-3",children:a}),e.jsx("div",{className:"space-y-2",children:m.map(b=>e.jsx(O,{test:b,onClick:()=>d(b),isSelected:s?.id===b.id},b.id))})]},a))}),e.jsx("div",{className:"lg:sticky lg:top-24 lg:h-fit",children:s?e.jsx(q,{test:s,onRecordResult:()=>v(!0)}):e.jsxs(y,{className:"p-12 text-center",depth:"subtle",children:[e.jsx(o.Shield,{className:"w-16 h-16 mx-auto mb-4 text-[var(--text-quaternary)]"}),e.jsx("h3",{className:"text-xl font-bold text-[var(--text-primary)] mb-2",children:"Select a Test"}),e.jsx("p",{className:"text-[var(--text-tertiary)]",children:"Choose a PT test from the list to view details and log your results"})]})})]}):e.jsx("div",{children:x.length===0?e.jsxs(y,{className:"p-12 text-center",depth:"subtle",children:[e.jsx(o.Clock,{className:"w-16 h-16 mx-auto mb-4 text-[var(--text-quaternary)]"}),e.jsx("h3",{className:"text-xl font-bold text-[var(--text-primary)] mb-2",children:"No Results Yet"}),e.jsx("p",{className:"text-[var(--text-tertiary)] mb-6",children:"Log your first PT test result to start tracking your progress"}),e.jsx(u,{variant:"primary",onClick:()=>k("tests"),children:"Browse Tests"})]}):e.jsx("div",{className:"space-y-4",children:x.map(a=>e.jsx(U,{result:a},a.id))})})]})})}),e.jsx(E,{items:[{to:"/dashboard",icon:o.Shield,label:"Home"},{to:"/pt-tests",icon:o.Shield,label:"PT Tests",active:!0},{to:"/profile",icon:o.Shield,label:"Profile"}]}),e.jsx(z,{isOpen:R,onClose:()=>v(!1),test:s,onSubmit:A})]})}export{ee as default};
