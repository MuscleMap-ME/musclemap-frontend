const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-6FSOh2tj.js","assets/react-vendor-D1NxaRNd.js","assets/illustrations-CFkZtwGd.js","assets/index-CJAW2BmH.js","assets/leaflet-vendor-CIGW-MKW.css","assets/reactflow-vendor-B5DZHykP.css","assets/index-CTxaAOZG.css"])))=>i.map(i=>d[i]);
import{D as Ie,E as Ns,R as ws,G as Ss,H as ks,I as Cs,J as Ms,K as Es,N as Rs,O as Ts,Q as _s,V as Is,Y as Ps,$ as As,h as Ke,P as ve,m as re,a0 as we,A as Fe,j as Os,Z as Ls,a1 as Qe,a2 as Ws,X as Ds,a3 as Us,y as $s,_ as Fs}from"./index-CJAW2BmH.js";import{r as a,j as e,d as Bs,L as Gs}from"./react-vendor-D1NxaRNd.js";import{T as Je}from"./TipCard-AKbGNPAR.js";import{h as qs}from"./illustrations-CFkZtwGd.js";import{M as Be}from"./MuscleViewer-nelDANCp.js";import{M as zs}from"./MuscleActivationBadge-QiWRE8IT.js";import"./GlassSurface-BMiMerMg.js";import"./GlassButton-squkS7NA.js";import{FloatingRestTimer as Vs}from"./FloatingRestTimer-4aBwBqqz.js";import{u as Ge,b as qe,c as ae,g as Xe}from"./apollo-vendor-D9c7jRvS.js";import{M as je}from"./minus-BPHNkliY.js";import{L as he}from"./loader-circle-B7M2qoaq.js";import{A as ze}from"./award-DOUcaB6a.js";import{R as Ae}from"./refresh-cw-B-wIAA49.js";import{C as Ze}from"./chevron-down-B5FfgmD-.js";import{C as Pe}from"./circle-alert-CEApFfsR.js";import{C as Ys}from"./check-m5yTAdxo.js";import{C as es}from"./chevron-right-H9cxl-o9.js";import{T as Hs}from"./trash-2-CWIhx_mt.js";import"./reactflow-vendor-Dz2P_-Qa.js";import"./d3-vendor-mcDw60ct.js";import"./recharts-vendor-BziRPEEi.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./use-drag-controls-CaMEQTys.js";import"./timer-CaAd7j96.js";import"./minimize-2-DoFeKaCi.js";import"./skip-forward-DDq3BD4d.js";import"./volume-x-D3Skr6Ax.js";const Ks="musclemap-sessions",Qs=1,Se="active_session";let Ne=null;function Js(){return Ne||(Ne=new Promise((r,h)=>{const d=indexedDB.open(Ks,Qs);d.onerror=()=>{h(d.error)},d.onsuccess=()=>{r(d.result)},d.onupgradeneeded=p=>{const j=p.target.result;j.objectStoreNames.contains(Se)||j.createObjectStore(Se,{keyPath:"id"})}}),Ne)}async function Xs(){try{const d=(await Js()).transaction(Se,"readwrite").objectStore(Se);await new Promise((p,j)=>{const x=d.delete("current");x.onsuccess=()=>p(),x.onerror=()=>j(x.error)})}catch{}}let Z=null;const Zs=5e3,et=3e4;let Re=0;async function st(r,h=!1){if(!localStorage.getItem("token"))return;const p=Date.now();if(h||p-Re>et){Z&&(clearTimeout(Z),Z=null);try{await Ie.post("/sessions",Ve(r)),Re=p}catch{}return}Z&&clearTimeout(Z),Z=setTimeout(async()=>{try{await Ie.post("/sessions",Ve(r)),Re=Date.now()}catch{}Z=null},Zs)}async function tt(r,h){if(localStorage.getItem("token"))try{await Ie.delete("/sessions/active",{data:{reason:r,workoutId:h}})}catch{}}function Ve(r){return{sessionId:r.sessionId,startedAt:r.startTime,pausedAt:r.pausedAt,totalPausedTime:r.totalPausedTime,workoutPlan:r.workoutPlan||{exercises:r.exercises},currentExerciseIndex:r.currentExerciseIndex,currentSetIndex:r.currentSetIndex,sets:r.sets,totalVolume:r.totalVolume,totalReps:r.totalReps,estimatedCalories:r.estimatedCalories,musclesWorked:r.musclesWorked,sessionPRs:r.sessionPRs,restTimer:r.restTimer,exerciseGroups:r.exerciseGroups,activeGroup:r.activeGroup,activeGroupExerciseIndex:r.activeGroupExerciseIndex,activeGroupRound:r.activeGroupRound,groupSets:r.groupSets,clientVersion:r.clientVersion}}async function Ye(r="completed",h){Z&&(clearTimeout(Z),Z=null),await Xs(),await tt(r,h)}function ke(){const r=a.useRef(null),h=a.useRef(null),d=a.useRef(null),{data:p,loading:j,refetch:x}=Ge(Ns,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),{data:R,loading:N,refetch:k}=Ge(ws,{fetchPolicy:"network-only"}),[y,{data:E,loading:_}]=qe(Ss),[I,{data:$,loading:f}]=qe(ks),[A,{loading:i}]=ae(Cs),[o,{loading:O}]=ae(Ms),[W,{loading:H}]=ae(Es),[L,{loading:z}]=ae(Rs),[le,{loading:M}]=ae(Ts),[D,{loading:ne}]=ae(_s),[K,{loading:F}]=ae(Is),[U,{loading:T}]=ae(Ps),[B,{loading:V}]=ae(As),b=a.useMemo(()=>p?.activeWorkoutSession||null,[p]),Q=a.useMemo(()=>R?.recoverableSessions||[],[R]),J=a.useMemo(()=>{const n={};if(E?.exerciseHistory)for(const m of E.exerciseHistory)n[m.exerciseId]=m;return n},[E]),G=!!b,ee=!!b?.pausedAt,Y=a.useCallback(async n=>{try{const{data:m}=await A({variables:{input:{prescriptionId:n}}});return m?.startWorkoutSession?.success?(await x(),{success:!0,sessionId:m.startWorkoutSession.session?.id}):{success:!1,error:m?.startWorkoutSession?.error||"Failed to start session"}}catch(m){return{success:!1,error:m instanceof Error?m.message:"Unknown error"}}},[A,x]),u=a.useCallback(async n=>{try{const{data:m}=await o({variables:{input:n},optimisticResponse:{logSet:{__typename:"LogSetResult",success:!0,set:{__typename:"LoggedSet",id:n.clientSetId||`temp-${Date.now()}`,exerciseId:n.exerciseId,exerciseName:"",setNumber:n.setNumber,reps:n.reps||null,weightKg:n.weightKg||null,rpe:n.rpe||null,rir:n.rir||null,durationSeconds:n.durationSeconds||null,tu:0,muscleActivations:[],isPRWeight:!1,isPR1RM:!1,isPRVolume:!1,notes:n.notes||null,performedAt:new Date().toISOString()},sessionUpdate:null,error:null}}});if(m?.logSet?.success){const C=m.logSet.sessionUpdate?.sessionPRs||[];for(const q of C)r.current&&r.current(q);return{success:!0,set:m.logSet.set,prs:C}}return{success:!1,error:m?.logSet?.error||"Failed to log set"}}catch(m){return{success:!1,error:m instanceof Error?m.message:"Unknown error"}}},[o]),w=a.useCallback(async(n,m,C)=>{try{const{data:q}=await W({variables:{input:{sessionId:n,setId:m,...C}}});return q?.updateSet?.success?{success:!0,set:q.updateSet.set}:{success:!1,error:q?.updateSet?.error||"Failed to update set"}}catch(q){return{success:!1,error:q instanceof Error?q.message:"Unknown error"}}},[W]),v=a.useCallback(async(n,m)=>{try{const{data:C}=await L({variables:{sessionId:n,setId:m}});return C?.deleteSet?.success?(await x(),{success:!0}):{success:!1,error:C?.deleteSet?.error||"Failed to delete set"}}catch(C){return{success:!1,error:C instanceof Error?C.message:"Unknown error"}}},[L,x]),ce=a.useCallback(async()=>{if(!b)return{success:!1,error:"No active session"};try{const{data:n}=await le({variables:{sessionId:b.id}});return n?.pauseWorkoutSession?.success?(await x(),{success:!0}):{success:!1,error:n?.pauseWorkoutSession?.error||"Failed to pause session"}}catch(n){return{success:!1,error:n instanceof Error?n.message:"Unknown error"}}},[b,le,x]),pe=a.useCallback(async()=>{if(!b)return{success:!1,error:"No active session"};try{const{data:n}=await D({variables:{sessionId:b.id}});return n?.resumeWorkoutSession?.success?(await x(),{success:!0}):{success:!1,error:n?.resumeWorkoutSession?.error||"Failed to resume session"}}catch(n){return{success:!1,error:n instanceof Error?n.message:"Unknown error"}}},[b,D,x]),X=a.useCallback(async n=>{if(!b)return{success:!1,workout:null,tuEarned:0,xpEarned:0,characterStats:null,levelUp:!1,newLevel:null,achievements:[],sessionSummary:null,error:"No active session"};try{const{data:m}=await K({variables:{input:{sessionId:b.id,notes:n}}}),C=m?.completeWorkoutSession;return C?.success?(C.levelUp&&C.newLevel&&h.current&&h.current(C.newLevel),d.current&&d.current(C),await x(),C):{success:!1,workout:null,tuEarned:0,xpEarned:0,characterStats:null,levelUp:!1,newLevel:null,achievements:[],sessionSummary:null,error:C?.error||"Failed to complete session"}}catch(m){return{success:!1,workout:null,tuEarned:0,xpEarned:0,characterStats:null,levelUp:!1,newLevel:null,achievements:[],sessionSummary:null,error:m instanceof Error?m.message:"Unknown error"}}},[b,K,x]),oe=a.useCallback(async()=>{if(!b)return{success:!1,error:"No active session"};try{const{data:n}=await U({variables:{sessionId:b.id}});return n?.abandonWorkoutSession?.success?(await x(),{success:!0}):{success:!1,error:n?.abandonWorkoutSession?.error||"Failed to abandon session"}}catch(n){return{success:!1,error:n instanceof Error?n.message:"Unknown error"}}},[b,U,x]),Oe=a.useCallback(async n=>{try{const{data:m}=await B({variables:{sessionId:n}});return m?.recoverWorkoutSession?.success?(await x(),{success:!0,session:m.recoverWorkoutSession.session}):{success:!1,error:m?.recoverWorkoutSession?.error||"Failed to recover session"}}catch(m){return{success:!1,error:m instanceof Error?m.message:"Unknown error"}}},[B,x]),Le=a.useCallback(async n=>{n.length!==0&&await y({variables:{exerciseIds:n}})},[y]),Ce=a.useCallback(async(n,m,C)=>{const{data:q}=await I({variables:{exerciseId:n,equipment:m,maxResults:C||5}});return q?.exerciseSubstitutions||[]},[I]),me=a.useCallback(n=>{n.onPRAchieved&&(r.current=n.onPRAchieved),n.onLevelUp&&(h.current=n.onLevelUp),n.onWorkoutComplete&&(d.current=n.onWorkoutComplete)},[]),Me=a.useMemo(()=>{if(!b)return 0;const n=new Date(b.startedAt).getTime(),C=Date.now()-n;return Math.floor((C-b.totalPausedTime)/1e3)},[b]),de=a.useMemo(()=>b?.currentExerciseId?b.sets.filter(n=>n.exerciseId===b.currentExerciseId):[],[b]),xe=b?.sets.length||0;return{activeSession:b,isSessionActive:G,isPaused:ee,recoverableSessions:Q,exerciseHistory:J,sessionDuration:Me,currentExerciseSets:de,totalSets:xe,loading:{activeSession:j,recoverableSessions:N,exerciseHistory:_,substitutions:f,startingSession:i,loggingSet:O,updatingSet:H,deletingSet:z,pausingSession:M,resumingSession:ne,completingSession:F,abandoningSession:T,recoveringSession:V},startSession:Y,logSet:u,updateSet:w,deleteSet:v,pauseSession:ce,resumeSession:pe,completeSession:X,abandonSession:oe,recoverSession:Oe,loadExerciseHistory:Le,findSubstitutes:Ce,registerCallbacks:me,refetchActiveSession:x,refetchRecoverableSessions:k}}function at({exerciseId:r,delay:h=2e3}){const[d,p]=a.useState(null),[j,x]=a.useState(!1),[R,N]=a.useState(!1);return a.useEffect(()=>{if(!r)return;p(null),x(!1),N(!1),(async()=>{try{const y=await Ke(`/tips/exercise/${r}`);y?.data&&(p(y.data),setTimeout(()=>x(!0),h))}catch{}})()},[r,h]),!d||!j||R?null:e.jsx("div",{className:"animate-fadeIn",children:e.jsx(Je,{tip:d,onDismiss:()=>N(!0),compact:!0})})}const rt={first_workout:"ðŸŽ‰",workouts_10:"ðŸ”¥",workouts_50:"âš¡",workouts_100:"ðŸ†",streak_7:"ðŸ“…",streak_30:"ðŸ—“ï¸",exercises_100:"ðŸ’¯",reps_1000:"ðŸŽ¯",reps_10000:"ðŸš€",hours_10:"â±ï¸"};function lt({milestone:r,onContinue:h}){if(!r)return null;const d=rt[r.id]||"ðŸ…";return e.jsxs("div",{className:"bg-gradient-to-b from-yellow-500/20 via-amber-500/10 to-transparent rounded-2xl p-6 border border-yellow-500/30 text-center",children:[e.jsxs("div",{className:"relative inline-block mb-4",children:[e.jsx("div",{className:"text-6xl animate-bounce",children:d}),e.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-black",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),e.jsx("h3",{className:"text-xl font-bold text-yellow-400 mb-1",children:"Milestone Achieved!"}),e.jsx("p",{className:"text-2xl font-bold text-white mb-2",children:r.name}),r.description&&e.jsx("p",{className:"text-gray-300 text-sm mb-4",children:r.description}),h&&e.jsx("button",{onClick:h,className:"mt-4 px-6 py-2 bg-yellow-500 hover:bg-yellow-400 text-black font-medium rounded-lg transition-colors",children:"Awesome!"})]})}function nt({workout:r,onClose:h}){const[d,p]=a.useState(null),[j,x]=a.useState(null),[R,N]=a.useState(!0),[k,y]=a.useState(!0);a.useEffect(()=>{(async()=>{try{const I=await Ke("/tips/completion",{method:"POST",body:{goals:r?.goals||[]}});p(I?.data?.tip),x(I?.data?.milestone)}catch{}finally{N(!1)}})()},[r?.goals]);const E=[{icon:"â±ï¸",value:r?.duration||"-",label:"minutes",color:"text-blue-400"},{icon:"ðŸ‹ï¸",value:r?.exerciseCount||r?.exercises?.length||"-",label:"exercises",color:"text-yellow-400"},{icon:"ðŸ”¥",value:r?.totalSets||"-",label:"sets",color:"text-orange-400"},{icon:"ðŸ’ª",value:r?.totalTU?Math.round(r.totalTU):"-",label:"TU earned",color:"text-purple-400"}];return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-gray-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"relative pt-8 pb-4 px-6 text-center overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 left-1/4 w-2 h-2 bg-yellow-400 rounded-full animate-ping",style:{animationDelay:"0s"}}),e.jsx("div",{className:"absolute top-4 right-1/4 w-2 h-2 bg-purple-400 rounded-full animate-ping",style:{animationDelay:"0.2s"}}),e.jsx("div",{className:"absolute top-2 left-1/2 w-2 h-2 bg-pink-400 rounded-full animate-ping",style:{animationDelay:"0.4s"}})]}),e.jsx("div",{className:"text-6xl mb-3",children:"ðŸŽ‰"}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Workout Complete!"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Great job staying consistent"})]}),e.jsx("div",{className:"px-6 pb-4",children:e.jsx("div",{className:"grid grid-cols-4 gap-2",children:E.map((_,I)=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg mb-1",children:_.icon}),e.jsx("div",{className:`text-lg font-bold ${_.color}`,children:_.value}),e.jsx("div",{className:"text-xs text-gray-500",children:_.label})]},I))})}),j&&k&&e.jsx("div",{className:"px-6 pb-4",children:e.jsx(lt,{milestone:j,onContinue:()=>y(!1)})}),!R&&d&&(!j||!k)&&e.jsx("div",{className:"px-6 pb-4",children:e.jsx(Je,{tip:d})}),R&&e.jsx("div",{className:"px-6 pb-4",children:e.jsx("div",{className:"bg-gray-800 rounded-xl p-4 animate-pulse",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-700 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-700 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-700 rounded w-1/2"})]})]})})}),e.jsx("div",{className:"px-6 pb-6",children:e.jsx("button",{onClick:h,className:"w-full py-3 bg-purple-600 hover:bg-purple-500 text-white font-medium rounded-xl transition-colors",children:"Done"})})]})})}const it={warmup:{label:"Warmup",color:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",icon:Ws},working:{label:"Working",color:"bg-blue-500/20 text-blue-400 border-blue-500/30",icon:Qe},failure:{label:"Failure",color:"bg-red-500/20 text-red-400 border-red-500/30",icon:Ls},drop:{label:"Drop",color:"bg-purple-500/20 text-purple-400 border-purple-500/30",icon:Ze},amrap:{label:"AMRAP",color:"bg-orange-500/20 text-orange-400 border-orange-500/30",icon:Os}},ct=[{value:0,label:"0 RIR",description:"Total failure"},{value:1,label:"1 RIR",description:"Could do 1 more"},{value:2,label:"2 RIR",description:"Could do 2 more"},{value:3,label:"3 RIR",description:"Could do 3 more"},{value:4,label:"4+ RIR",description:"Easy"}];function ot({exerciseId:r,exerciseName:h,suggestedSets:d=3,suggestedReps:p=10,onSetLogged:j,onAllSetsComplete:x,compact:R=!1}){const[N,k]=a.useState(""),[y,E]=a.useState(p.toString()),[_,I]=a.useState("working"),[$,f]=a.useState(null),[A,i]=a.useState(null),[o,O]=a.useState(""),[W,H]=a.useState(!1),[L,z]=a.useState(null),[le,M]=a.useState([]),{logSet:D,loadExerciseHistory:ne,exerciseHistory:K,currentExerciseSets:F,isLoggingSet:U}=ke();a.useEffect(()=>{ne([r])},[r,ne]);const T=K[r],B=F(r),V=B.length+1,b=a.useMemo(()=>T?.bestWeight?Math.round(T.bestWeight*.85/5)*5:null,[T]);a.useEffect(()=>{b&&!N&&k(b.toString())},[b,N]);const Q=a.useCallback(async()=>{const u=parseFloat(N),w=parseInt(y);if(!u||!w)return;const v=await D({exerciseId:r,exerciseName:h,reps:w,weightKg:u/2.205,rpe:$||void 0,rir:A||void 0,notes:o.trim()||void 0});if(v?.set){if(M(v.set.muscleActivations||[]),v.set.isPRWeight||v.set.isPR1RM||v.set.isPRVolume){const ce=v.set.isPR1RM?"1rm":v.set.isPRWeight?"weight":"volume";z({type:ce,value:Math.round(ce==="1rm"?v.set.weightKg*2.205/(1.0278-.0278*w):v.set.weightKg*2.205)}),setTimeout(()=>z(null),4e3)}E(p.toString()),f(null),i(null),O(""),j?.(v.set),V>=d&&x?.()}},[N,y,_,$,A,o,r,h,D,p,d,V,j,x]),J=u=>{const w=parseFloat(N)||0;k(Math.max(0,w+u).toString())},G=u=>{const w=parseInt(y)||0;E(Math.max(0,w+u).toString())},ee=a.useMemo(()=>{const u=parseFloat(N),w=parseInt(y);return u>0&&w>0&&w<=15?Math.round(u/(1.0278-.0278*w)):null},[N,y]),Y=ee&&T?.best1RM&&ee>T.best1RM;return R?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs text-gray-400 mb-1 block",children:"Weight (lbs)"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>J(-5),className:"p-1.5 rounded bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(je,{className:"w-4 h-4"})}),e.jsx("input",{type:"number",value:N,onChange:u=>k(u.target.value),placeholder:"0",className:"flex-1 bg-gray-800/50 border border-gray-700 rounded px-2 py-2 text-center text-lg font-bold focus:border-blue-500 focus:outline-none w-20"}),e.jsx("button",{onClick:()=>J(5),className:"p-1.5 rounded bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(ve,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs text-gray-400 mb-1 block",children:"Reps"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>G(-1),className:"p-1.5 rounded bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(je,{className:"w-4 h-4"})}),e.jsx("input",{type:"number",value:y,onChange:u=>E(u.target.value),placeholder:"0",className:"flex-1 bg-gray-800/50 border border-gray-700 rounded px-2 py-2 text-center text-lg font-bold focus:border-blue-500 focus:outline-none w-16"}),e.jsx("button",{onClick:()=>G(1),className:"p-1.5 rounded bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(ve,{className:"w-4 h-4"})})]})]})]}),e.jsx(re.button,{whileTap:{scale:.98},onClick:Q,disabled:!N||!y||U,className:`w-full py-3 rounded-xl font-bold text-base transition-all flex items-center justify-center gap-2 ${N&&y&&!U?"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:U?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"w-4 h-4 animate-spin"}),"Logging..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-4 h-4"}),"Log Set ",V,"/",d]})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(Fe,{children:L&&e.jsxs(re.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},className:"bg-gradient-to-r from-yellow-500/20 to-orange-500/20 border border-yellow-500/30 rounded-lg p-4 flex items-center gap-3",children:[e.jsx(ze,{className:"w-8 h-8 text-yellow-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-yellow-400",children:"NEW PR!"}),e.jsxs("p",{className:"text-sm text-gray-300",children:[L.type==="1rm"&&`Estimated 1RM: ${L.value} lbs`,L.type==="weight"&&`Max weight: ${L.value} lbs`,L.type==="volume"&&`Set volume: ${L.value} lbs`]})]})]})}),T&&e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3 flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsxs("span",{children:["Last: ",T.totalSessions," sessions"]})]}),e.jsxs("div",{className:"flex gap-4",children:[T.bestWeight&&e.jsxs("span",{className:"text-blue-400",children:["Best: ",Math.round(T.bestWeight*2.205)," lbs"]}),T.best1RM&&e.jsxs("span",{className:"text-purple-400",children:["1RM: ",Math.round(T.best1RM*2.205)," lbs"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Set Progress:"}),e.jsx("div",{className:"flex gap-1",children:Array.from({length:d}).map((u,w)=>e.jsx("div",{className:`w-8 h-2 rounded-full transition-colors ${w<B.length?"bg-green-500":w===B.length?"bg-blue-500 animate-pulse":"bg-gray-700"}`},w))}),e.jsxs("span",{className:"text-sm font-medium",children:[B.length,"/",d]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(it).map(([u,w])=>{const v=w.icon;return e.jsxs("button",{onClick:()=>I(u),className:`px-3 py-1.5 rounded-full text-sm font-medium border transition-all flex items-center gap-1.5 ${_===u?w.color:"bg-gray-800/50 text-gray-400 border-gray-700 hover:border-gray-600"}`,children:[e.jsx(v,{className:"w-4 h-4"}),w.label]},u)})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Weight (lbs)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>J(-5),className:"p-2 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(je,{className:"w-5 h-5"})}),e.jsx("input",{type:"number",value:N,onChange:u=>k(u.target.value),placeholder:"0",className:"flex-1 bg-gray-800/50 border border-gray-700 rounded-lg px-4 py-3 text-center text-2xl font-bold focus:border-blue-500 focus:outline-none"}),e.jsx("button",{onClick:()=>J(5),className:"p-2 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(ve,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Reps"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>G(-1),className:"p-2 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(je,{className:"w-5 h-5"})}),e.jsx("input",{type:"number",value:y,onChange:u=>E(u.target.value),placeholder:"0",className:"flex-1 bg-gray-800/50 border border-gray-700 rounded-lg px-4 py-3 text-center text-2xl font-bold focus:border-blue-500 focus:outline-none"}),e.jsx("button",{onClick:()=>G(1),className:"p-2 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(ve,{className:"w-5 h-5"})})]})]}),ee&&e.jsxs("div",{className:`p-3 rounded-lg border ${Y?"bg-yellow-500/10 border-yellow-500/30":"bg-gray-800/50 border-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Estimated 1RM"}),e.jsxs("span",{className:`font-bold ${Y?"text-yellow-400":"text-white"}`,children:[ee," lbs",Y&&e.jsx("span",{className:"ml-2 text-xs",children:"NEW PR!"})]})]}),T?.best1RM&&e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Previous Best"}),e.jsxs("span",{className:"text-xs text-gray-400",children:[Math.round(T.best1RM*2.205)," lbs"]})]})]}),le.length>0&&e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Last Set - Muscle Activation"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:le.map(u=>e.jsxs("span",{className:"bg-purple-500/30 text-purple-200 px-2 py-0.5 rounded text-xs",children:[u.muscleName," (",u.activationPercent,"%)"]},u.muscleId))})]}),e.jsxs("button",{onClick:()=>H(!W),className:"w-full py-2 text-sm text-gray-400 hover:text-gray-300 flex items-center justify-center gap-2",children:[e.jsxs("span",{children:[W?"Hide":"Show"," Advanced Options"]}),e.jsx(Ze,{className:`w-4 h-4 transition-transform ${W?"rotate-180":""}`})]}),e.jsx(Fe,{children:W&&e.jsxs(re.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"space-y-4 overflow-hidden",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"RPE (1-10)"}),e.jsx("span",{className:"text-sm font-medium",children:$||"-"})]}),e.jsx("input",{type:"range",min:"1",max:"10",value:$||5,onChange:u=>f(parseInt(u.target.value)),className:"w-full accent-blue-500"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsx("span",{children:"Easy"}),e.jsx("span",{children:"Max Effort"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Reps in Reserve"}),e.jsx("div",{className:"flex gap-2",children:ct.map(u=>e.jsx("button",{onClick:()=>i(A===u.value?null:u.value),className:`flex-1 py-2 px-2 rounded-lg text-xs font-medium border transition-all ${A===u.value?"bg-blue-500/20 text-blue-400 border-blue-500/30":"bg-gray-800/50 text-gray-400 border-gray-700 hover:border-gray-600"}`,children:u.label},u.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Notes"}),e.jsx("input",{type:"text",value:o,onChange:u=>O(u.target.value),placeholder:"Optional notes...",className:"w-full bg-gray-800/50 border border-gray-700 rounded-lg px-4 py-2 text-sm focus:border-blue-500 focus:outline-none"})]})]})}),B.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Logged Sets"}),e.jsx("div",{className:"space-y-1",children:B.map((u,w)=>e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-400",children:["Set ",w+1]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"font-medium",children:[Math.round((u.weightKg||0)*2.205)," lbs x ",u.reps]}),e.jsxs("span",{className:"text-purple-400",children:[u.tu," TU"]}),u.isPRWeight&&e.jsx(ze,{className:"w-4 h-4 text-yellow-400"})]})]},u.id))})]}),e.jsx(re.button,{whileTap:{scale:.98},onClick:Q,disabled:!N||!y||U,className:`w-full py-4 rounded-xl font-bold text-lg transition-all flex items-center justify-center gap-2 ${N&&y&&!U?"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:U?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"w-5 h-5 animate-spin"}),"Logging Set..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-5 h-5"}),"Log Set ",V]})})]})}function dt({exerciseId:r,exerciseName:h,availableEquipment:d,onSelect:p,onCancel:j}){const[x,R]=a.useState([]),[N,k]=a.useState(!0),[y,E]=a.useState(null),[_,I]=a.useState(null),{findSubstitutes:$}=ke();a.useEffect(()=>{(async()=>{k(!0),E(null);const O=await $(r,d,8);O&&O.length>0?R(O):E("No alternative exercises found for your equipment."),k(!1)})()},[r,d,$]);const f=a.useCallback(o=>{I(o.exercise.id),setTimeout(()=>{p(o.exercise)},200)},[p]),A=o=>o>=.8?"text-green-400":o>=.6?"text-yellow-400":"text-orange-400",i=o=>o>=.8?"Excellent match":o>=.6?"Good match":"Partial match";return e.jsx(re.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-end sm:items-center justify-center",onClick:j,children:e.jsxs(re.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},onClick:o=>o.stopPropagation(),className:"bg-gray-900 rounded-t-3xl sm:rounded-3xl w-full max-w-lg max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-800 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold",children:"Swap Exercise"}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Find alternatives for ",h]})]}),e.jsx("button",{onClick:j,className:"p-2 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(Ds,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:N?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(he,{className:"w-8 h-8 text-blue-400 animate-spin mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Finding similar exercises..."})]}):y?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Pe,{className:"w-8 h-8 text-orange-400 mb-4"}),e.jsx("p",{className:"text-gray-400 text-center",children:y}),e.jsx("button",{onClick:j,className:"mt-4 px-4 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-sm",children:"Keep Current Exercise"})]}):e.jsx("div",{className:"space-y-3",children:x.map(o=>e.jsx(re.button,{whileTap:{scale:.98},onClick:()=>f(o),className:`w-full text-left p-4 rounded-xl border transition-all ${_===o.exercise.id?"bg-green-500/20 border-green-500/50":"bg-gray-800/50 border-gray-700 hover:border-gray-600"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(we,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"font-medium",children:o.exercise.name})]}),o.exercise.equipment&&o.exercise.equipment.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:o.exercise.equipment.slice(0,3).map(O=>e.jsx("span",{className:"text-xs bg-gray-700/50 text-gray-300 px-2 py-0.5 rounded",children:O},O))}),o.matchedMuscles&&o.matchedMuscles.length>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400 mb-1",children:[e.jsx(Qe,{className:"w-3 h-3"}),e.jsxs("span",{children:["Targets: ",o.matchedMuscles.join(", ")]})]}),o.missingMuscles&&o.missingMuscles.length>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-orange-400",children:[e.jsx(Pe,{className:"w-3 h-3"}),e.jsxs("span",{children:["Missing: ",o.missingMuscles.join(", ")]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs("div",{className:`text-sm font-medium ${A(o.similarityScore)}`,children:[Math.round(o.similarityScore*100),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:i(o.similarityScore)}),_===o.exercise.id?e.jsx(Ys,{className:"w-5 h-5 text-green-400 mt-2"}):e.jsx(es,{className:"w-5 h-5 text-gray-600 mt-2"})]})]})},o.exercise.id))})}),!N&&!y&&e.jsx("div",{className:"p-4 border-t border-gray-800",children:e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(Ae,{className:"w-3 h-3"}),e.jsx("span",{children:"Alternatives sorted by muscle similarity"})]})})]})})}function ut({sessions:r,onRecover:h,onDiscard:d,onDismiss:p}){const[j,x]=a.useState(null),[R,N]=a.useState(!1),[k,y]=a.useState(!1),{recoverSession:E,abandonSession:_}=ke(),I=i=>{const o=new Date(i),W=new Date().getTime()-o.getTime(),H=Math.round(W/6e4),L=Math.round(W/36e5),z=Math.round(W/864e5);return H<60?`${H} min ago`:L<24?`${L} hours ago`:`${z} days ago`},$=i=>i>=1e3?`${(i/1e3).toFixed(1)}k lbs`:`${Math.round(i)} lbs`,f=async i=>{x(i),N(!0),await E(i)?h(i):(N(!1),x(null))},A=async i=>{x(i),y(!0),await _(i)&&d(i),y(!1),x(null)};return r.length===0?null:e.jsx(re.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(re.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-gray-900 rounded-2xl w-full max-w-md overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-800",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-xl bg-orange-500/20",children:e.jsx(Pe,{className:"w-6 h-6 text-orange-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold",children:"Unfinished Workout"}),e.jsx("p",{className:"text-sm text-gray-400",children:r.length===1?"You have an incomplete session":`You have ${r.length} incomplete sessions`})]})]})}),e.jsx("div",{className:"p-4 max-h-[400px] overflow-y-auto space-y-3",children:r.map(i=>e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mb-1",children:[e.jsx(Us,{className:"w-4 h-4"}),e.jsx("span",{children:I(i.lastActivityAt)})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(we,{className:"w-4 h-4 text-blue-400"}),e.jsxs("span",{className:"font-medium",children:[i.exerciseCount," exercises"]})]}),e.jsxs("span",{className:"text-gray-400",children:[i.setCount," sets"]}),e.jsx("span",{className:"text-purple-400",children:$(i.totalVolume)})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(i.id),disabled:R||k,className:"flex-1 flex items-center justify-center gap-2 py-2.5 rounded-lg bg-green-600 hover:bg-green-500 text-white font-medium transition-colors disabled:opacity-50",children:R&&j===i.id?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"w-4 h-4 animate-spin"}),"Resuming..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"w-4 h-4"}),"Resume"]})}),e.jsx("button",{onClick:()=>A(i.id),disabled:R||k,className:"flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg bg-gray-700 hover:bg-gray-600 text-gray-300 font-medium transition-colors disabled:opacity-50",children:k&&j===i.id?e.jsx(he,{className:"w-4 h-4 animate-spin"}):e.jsx(Hs,{className:"w-4 h-4"})})]})]},i.id))}),e.jsx("div",{className:"p-4 border-t border-gray-800",children:e.jsxs("button",{onClick:p,disabled:R||k,className:"w-full py-3 rounded-xl bg-gray-800 hover:bg-gray-700 text-gray-300 font-medium transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:[e.jsx("span",{children:"Start Fresh Instead"}),e.jsx(es,{className:"w-4 h-4"})]})})]})})}Xe`
  query GetRPETrends($exerciseId: ID!, $days: Int) {
    rpeTrends(exerciseId: $exerciseId, days: $days) {
      exerciseId
      exerciseName
      trends {
        date
        avgRpe
        avgRir
        setCount
        avgWeight
        maxWeight
        avgReps
      }
      summary {
        avgRpe
        totalSets
        daysWithData
        trend
      }
    }
  }
`;Xe`
  query GetFatigue {
    rpeFatigue {
      fatigueScore
      classification
      indicators
      recommendation
      suggestedIntensity
      recentRpeTrend
    }
  }
`;const mt=a.lazy(()=>Fs(()=>import("./index-6FSOh2tj.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(r=>({default:r.ExerciseIllustration}))),xt={"chest-upper":"chest","chest-mid":"chest","chest-lower":"chest",pectoralis:"chest",pec:"chest","back-upper":"upper_back","back-mid":"lats","back-lower":"lower_back",latissimus:"lats",rhomboids:"upper_back",trapezius:"traps",traps:"traps","rear-delts":"rear_delts","front-delts":"front_delts","side-delts":"side_delts",shoulders:"front_delts",deltoid:"front_delts",biceps:"biceps",triceps:"triceps",forearms:"forearms",quadriceps:"quads",quads:"quads",hamstrings:"hamstrings",glutes:"glutes",calves:"calves",abs:"abs",obliques:"obliques",core:"abs","hip-flexors":"hip_flexors",adductors:"adductors",erector:"lower_back"};function ue(r){const h=r.toLowerCase().replace(/[_\s]/g,"-");return xt[h]||h.replace(/-/g,"_")}const gt=[{value:15,label:"15 min",description:"Quick session"},{value:30,label:"30 min",description:"Standard"},{value:45,label:"45 min",description:"Extended"},{value:60,label:"60 min",description:"Full workout"}],Te=[{value:"gym",label:"Gym",icon:"ðŸ‹ï¸"},{value:"home",label:"Home",icon:"ðŸ "},{value:"park",label:"Park",icon:"ðŸŒ³"},{value:"hotel",label:"Hotel",icon:"ðŸ¨"},{value:"office",label:"Office",icon:"ðŸ¢"}],ht={gym:[{value:"barbell",label:"Barbell",icon:"ðŸ‹ï¸"},{value:"dumbbells",label:"Dumbbells",icon:"ðŸ”©"},{value:"cable_machine",label:"Cable Machine",icon:"âš™ï¸"},{value:"leg_press",label:"Leg Press",icon:"ðŸ¦µ"},{value:"lat_pulldown",label:"Lat Pulldown",icon:"ðŸ“"},{value:"bench",label:"Bench",icon:"ðŸª‘"},{value:"squat_rack",label:"Squat Rack",icon:"ðŸ—ï¸"},{value:"smith_machine",label:"Smith Machine",icon:"ðŸ”§"},{value:"rowing_machine",label:"Row Machine",icon:"ðŸš£"},{value:"treadmill",label:"Treadmill",icon:"ðŸƒ"},{value:"elliptical",label:"Elliptical",icon:"â­•"},{value:"kettlebell",label:"Kettlebell",icon:"ðŸ””"}],home:[{value:"dumbbells",label:"Dumbbells",icon:"ðŸ”©"},{value:"pullup_bar",label:"Pull-up Bar",icon:"ðŸ”²"},{value:"kettlebell",label:"Kettlebell",icon:"ðŸ””"},{value:"bands",label:"Resistance Bands",icon:"âž°"},{value:"yoga_mat",label:"Yoga Mat",icon:"ðŸ§˜"},{value:"foam_roller",label:"Foam Roller",icon:"ðŸ›¼"},{value:"jump_rope",label:"Jump Rope",icon:"ðŸª¢"},{value:"stability_ball",label:"Stability Ball",icon:"âšª"}],park:[{value:"pullup_bar",label:"Pull-up Bar",icon:"ðŸ”²"},{value:"parallel_bars",label:"Parallel Bars",icon:"â¸ï¸"},{value:"bench",label:"Park Bench",icon:"ðŸª‘"},{value:"bands",label:"Resistance Bands",icon:"âž°"},{value:"jump_rope",label:"Jump Rope",icon:"ðŸª¢"},{value:"stairs",label:"Stairs",icon:"ðŸ“¶"}],hotel:[{value:"bands",label:"Resistance Bands",icon:"âž°"},{value:"dumbbells",label:"Hotel Dumbbells",icon:"ðŸ”©"},{value:"yoga_mat",label:"Yoga Mat",icon:"ðŸ§˜"},{value:"chair",label:"Chair",icon:"ðŸ’º"},{value:"treadmill",label:"Treadmill",icon:"ðŸƒ"}],office:[{value:"bands",label:"Resistance Bands",icon:"âž°"},{value:"chair",label:"Office Chair",icon:"ðŸ’º"},{value:"desk",label:"Desk",icon:"ðŸ–¥ï¸"},{value:"stairs",label:"Stairs",icon:"ðŸ“¶"}]},pt=[{value:"dumbbells",label:"Dumbbells",icon:"ðŸ”©"},{value:"pullup_bar",label:"Pull-up Bar",icon:"ðŸ”²"},{value:"kettlebell",label:"Kettlebell",icon:"ðŸ””"},{value:"bands",label:"Resistance Bands",icon:"âž°"},{value:"barbell",label:"Barbell",icon:"ðŸ‹ï¸"}],bt=[{value:"strength",label:"Strength",icon:"ðŸ’ª"},{value:"hypertrophy",label:"Muscle Growth",icon:"ðŸ“ˆ"},{value:"endurance",label:"Endurance",icon:"ðŸƒ"},{value:"fat_loss",label:"Fat Loss",icon:"ðŸ”¥"}],ss=[{id:"chest",name:"Chest",icon:"ðŸª¶",match:["ch_","pec","chest"]},{id:"back",name:"Back",icon:"ðŸ”§",match:["bk_","lat","romboid","trap","back"]},{id:"shoulders",name:"Shoulders",icon:"ðŸ’ª",match:["sh_","delt","shoulder"]},{id:"arms",name:"Arms",icon:"ðŸ’ª",match:["ar_","bicep","tricep","forearm"]},{id:"legs",name:"Legs",icon:"ðŸ¦µ",match:["lg_","quad","hamstring","calf","leg"]},{id:"glutes",name:"Glutes",icon:"ðŸ‘",match:["glute"]},{id:"core",name:"Core",icon:"ðŸ¤³",match:["core","ab","oblique"]}];function _e(r){if(!r||!r.length)return null;const h=(r[0]||"").toLowerCase();for(const d of ss)if(d.match.some(p=>h.includes(p)))return d;return null}const He={barbell:{c:"from-red-500 to-orange-500"},dumbbell:{c:"from-blue-500 to-purple-500"},bodyweight:{c:"from-green-500 to-teal-500"},kettlebell:{c:"from-yellow-500 to-orange-500"},machine:{c:"from-gray-500 to-gray-700"},cable:{c:"from-purple-500 to-pink-500"},default:{c:"from-gray-600 to-gray-700"}};function Vt(){const{token:r}=$s(),h=Bs(),[d,p]=a.useState("select"),[j,x]=a.useState(!0),[R,N]=a.useState(30),[k,y]=a.useState("gym"),[E,_]=a.useState([]),[I,$]=a.useState(["strength"]),[f,A]=a.useState(null),[i,o]=a.useState(0),[O,W]=a.useState([]),[H,L]=a.useState(""),[z,le]=a.useState(null),[M,D]=a.useState([]),[ne,K]=a.useState(!1),[F,U]=a.useState(null),[T,B]=a.useState(3),[V,b]=a.useState(!1),[Q,J]=a.useState(null),[G,ee]=a.useState(10),[Y,u]=a.useState(0),[w,v]=a.useState(null),[ce,pe]=a.useState(null),X=a.useRef(null),oe=a.useRef(null),[Oe,Le]=a.useState(!1),[Ce,me]=a.useState(!1),[Me,de]=a.useState(!1),[xe,n]=a.useState([]),{activeSession:m,isSessionActive:C,startSession:q,completeSession:ts,recoverSession:as,abandonSession:rs,recoverableSessions:be,totalSets:ls,registerCallbacks:We}=ke();a.useEffect(()=>{We({onPR:s=>{v(`NEW ${s.prType.toUpperCase()} PR! ${s.exerciseName}`),setTimeout(()=>v(null),3e3)},onLevelUp:s=>{v(`LEVEL UP! You're now level ${s}!`),setTimeout(()=>v(null),4e3)}})},[We]),a.useEffect(()=>{be&&be.length>0&&(n(be),de(!0))},[be]),a.useEffect(()=>{(d==="workout"||d==="manual")&&!X.current&&(X.current=`session-${Date.now()}-${Math.random().toString(36).slice(2)}`,oe.current=Date.now())},[d]);const De=a.useCallback(async s=>{if(!r||!X.current||s.length===0)return;const t={sessionId:X.current,isActive:!0,startTime:oe.current||Date.now(),pausedAt:null,totalPausedTime:0,exercises:s.map(c=>({id:c.id,name:c.name,primaryMuscles:c.primaryMuscles||c.primary_muscles||[],secondaryMuscles:c.secondaryMuscles||c.secondary_muscles||[]})),currentExercise:s[s.length-1]||null,currentExerciseIndex:s.length-1,currentSetIndex:0,sets:s.map((c,l)=>({id:`set-${l}`,exerciseId:c.id,exerciseName:c.name,weight:c.weight||0,reps:c.reps||0,tag:"working",timestamp:Date.now()})),totalVolume:s.reduce((c,l)=>c+(l.weight||0)*(l.reps||0)*(l.sets||1),0),totalReps:s.reduce((c,l)=>c+(l.reps||0)*(l.sets||1),0),estimatedCalories:s.length*50,musclesWorked:[...new Set(s.flatMap(c=>c.primaryMuscles||c.primary_muscles||[]))],sessionPRs:[],exerciseGroups:[],activeGroupExerciseIndex:0,activeGroupRound:1,groupSets:[],clientVersion:1};try{await st(t,!1)}catch{}},[r]);a.useEffect(()=>{M.length>0&&(d==="workout"||d==="manual")&&De(M)},[M,d,De]),a.useEffect(()=>{_([])},[k]);const ns=ht[k]||pt,se=()=>{if(!f)return[];const s=[];return f.warmup&&s.push(...f.warmup.map(t=>({...t,phase:"warmup"}))),f.exercises&&s.push(...f.exercises.map(t=>({...t,phase:"main"}))),f.cooldown&&s.push(...f.cooldown.map(t=>({...t,phase:"cooldown"}))),s},fe=a.useMemo(()=>{const s={};return M.forEach(t=>{const c=t.primaryMuscles||t.primary_muscles||[],l=t.secondaryMuscles||t.secondary_muscles||[],g=t.sets||3,S=t.reps||10,P=Math.min(1,g*S/50);c.forEach(te=>{const ie=ue(te),ge=s[ie]||{intensity:0};s[ie]={intensity:Math.min(1,ge.intensity+P*.4),isPrimary:!0}}),l.forEach(te=>{const ie=ue(te),ge=s[ie]||{intensity:0,isPrimary:!1};ge.isPrimary?s[ie].intensity=Math.min(1,ge.intensity+P*.2):s[ie]={intensity:Math.min(1,ge.intensity+P*.2),isPrimary:!1}})}),Object.entries(s).map(([t,{intensity:c,isPrimary:l}])=>({id:t,intensity:c,isPrimary:l}))},[M]),is=a.useMemo(()=>{if(!f)return[];const t=se()[i];if(!t)return[];const c=[],l=t.primaryMuscles||t.primary_muscles||[],g=t.secondaryMuscles||t.secondary_muscles||[];return l.forEach(S=>{c.push({id:ue(S),intensity:1,isPrimary:!0})}),g.forEach(S=>{c.push({id:ue(S),intensity:.5,isPrimary:!1})}),c},[f,i]);a.useEffect(()=>{d==="manual"&&O.length===0&&(K(!0),fetch("/api/exercises").then(s=>s.json()).then(s=>{const c=(s.data||s.exercises||[]).map(l=>({...l,primary_muscles:typeof l.primaryMuscles=="string"?l.primaryMuscles.split(",").map(g=>g.trim()).filter(Boolean):l.primaryMuscles||[]}));W(c),K(!1)}).catch(()=>K(!1)))},[d,O.length]);const cs=async()=>{K(!0),pe(null);try{const s=await fetch("/api/prescription/generate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({timeAvailable:R,location:k,equipment:E,goals:I})}),t=await s.json();if(!s.ok)throw new Error(t.error?.message||"Failed to generate workout");const c=t.data;A(c),o(0),p("workout");const l=[...c.warmup||[],...c.exercises||[],...c.cooldown||[]].filter(g=>g.id||g.exerciseId).map(g=>({exerciseId:g.id||g.exerciseId,name:g.name,plannedSets:g.sets||3,plannedReps:typeof g.reps=="number"?g.reps:10}));l.length>0&&await q(l)}catch(s){pe(s.message||"Failed to generate workout. Try different constraints.")}finally{K(!1)}},os=s=>{_(t=>t.includes(s)?t.filter(c=>c!==s):[...t,s])},ds=s=>{$(t=>t.includes(s)?t.length>1?t.filter(c=>c!==s):t:[...t,s])},ye=a.useRef(!1),Ue=async()=>{if(ye.current||M.length===0)return;ye.current=!0,b(!0);const s=[...M];try{if(C&&m){const t=await ts();t?(X.current&&(await Ye("completed",t.workout?.id),X.current=null,oe.current=null),J({tuEarned:t.tuEarned||0,xpEarned:t.xpEarned||0,characterStats:t.characterStats,exerciseCount:t.sessionSummary?.exerciseCount||s.length,totalSets:t.sessionSummary?.totalSets||ls,exercises:s,levelUp:t.levelUp,newLevel:t.newLevel,achievements:t.achievements,sessionSummary:t.sessionSummary}),D([])):alert("Failed to complete workout. Please try again.")}else{const t=s.filter(S=>{const P=S.id&&typeof S.id=="string"&&!S.id.startsWith("activity-"),te=!S.isActivity;return P&&te}).map(S=>({exerciseId:S.id,sets:S.sets||3,reps:typeof S.reps=="number"?S.reps:10,weight:S.weight||void 0}));if(t.length===0){alert("No exercises to log. Complete at least one exercise (not just warmup/cooldown) to save your workout."),ye.current=!1,b(!1);return}const c=`workout-${Date.now()}-${Math.random().toString(36).slice(2)}`,l=await fetch("/api/workouts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+r},body:JSON.stringify({exercises:t,idempotencyKey:c,notes:`${M.length} exercises completed`})}),g=await l.json();if(l.ok&&g.data){X.current&&(await Ye("completed",g.data.id),X.current=null,oe.current=null);const S=s.length,P=s.reduce((te,ie)=>te+(ie.sets||0),0);J({tuEarned:g.data.totalTU,characterStats:g.data.characterStats,exerciseCount:S,totalSets:P,exercises:s}),D([])}else alert(g.error?.message||g.error||"Failed to complete workout")}}catch{alert("Error completing workout. Please try again.")}finally{ye.current=!1,b(!1)}},us=O.filter(s=>{const t=!H||s.name.toLowerCase().includes(H.toLowerCase()),c=_e(s.primary_muscles),l=!z||c&&c.id===z;return t&&l}).slice(0,24);async function ms(){if(F)try{await fetch("/api/workouts/exercise",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+r},body:JSON.stringify({exerciseId:F.id,sets:T,reps:G,weight:Y})}),D([...M,{...F,sets:T,reps:G,weight:Y}]),v(F.name),setTimeout(()=>v(null),2e3),U(null)}catch{}}const xs=s=>He[s.type]||He.default,Ee=s=>{const t=_e(s.primary_muscles||s.primaryMuscles);return t?t.icon:"ðŸ’ª"},$e=s=>{const t=_e(s.primary_muscles||s.primaryMuscles);return t?t.name:""},gs=async s=>{const t=s.id||s.exerciseId;if(s.isActivity||!t){D([...M,{id:`activity-${Date.now()}`,name:s.name||s.description||"Activity",sets:s.sets||1,reps:s.reps||1,weight:0,isActivity:!0}]),v(s.name||s.description),setTimeout(()=>v(null),2e3);const l=se();i<l.length-1&&o(i+1);return}try{await fetch("/api/workouts/exercise",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+r},body:JSON.stringify({exerciseId:t,sets:s.sets,reps:typeof s.reps=="number"?s.reps:10,weight:0})}),D([...M,{id:t,name:s.name,sets:s.sets,reps:s.reps,weight:0,primaryMuscles:s.primaryMuscles}]),v(s.name),setTimeout(()=>v(null),2e3);const l=se();i<l.length-1&&o(i+1)}catch{}},hs=()=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 text-white pb-24",children:[e.jsx("header",{className:"bg-gray-900/80 backdrop-blur-lg p-4 sticky top-0 z-10 border-b border-gray-700/30",children:e.jsxs("div",{className:"max-w-5xl mx-auto flex items-center justify-between",children:[e.jsxs(Gs,{to:"/dashboard",className:"flex items-center gap-2 text-blue-400 hover:text-blue-300 transition-colors",children:[e.jsx("span",{children:"â†"}),e.jsx("img",{src:"/logo.png",alt:"MuscleMap",className:"w-6 h-6 rounded-md"})]}),e.jsx("h1",{className:"text-xl font-bold",children:"Start Workout"}),e.jsx("div",{})]})}),e.jsxs("main",{className:"max-w-lg mx-auto p-4 space-y-6",children:[ce&&e.jsx("div",{className:"bg-red-500/20 border border-red-500 rounded-xl p-4 text-red-200",children:ce}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm text-gray-400 uppercase mb-3",children:"How long do you have?"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:gt.map(s=>e.jsxs("button",{onClick:()=>N(s.value),className:`p-3 rounded-xl text-center transition-all ${R===s.value?"bg-purple-600 ring-2 ring-purple-400":"bg-gray-800 hover:bg-gray-700"}`,children:[e.jsx("div",{className:"font-bold",children:s.label}),e.jsx("div",{className:"text-xs text-gray-400",children:s.description})]},s.value))})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm text-gray-400 uppercase mb-3",children:"Where are you?"}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:Te.map(s=>e.jsxs("button",{onClick:()=>y(s.value),className:`p-3 rounded-xl text-center transition-all ${k===s.value?"bg-purple-600 ring-2 ring-purple-400":"bg-gray-800 hover:bg-gray-700"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:s.icon}),e.jsx("div",{className:"text-xs",children:s.label})]},s.value))})]}),e.jsxs("section",{children:[e.jsxs("h2",{className:"text-sm text-gray-400 uppercase mb-3",children:["Available at ",Te.find(s=>s.value===k)?.label||"Location"," (optional)"]}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-2 max-h-48 overflow-y-auto",children:ns.map(s=>e.jsxs("button",{onClick:()=>os(s.value),className:`p-3 rounded-xl text-center transition-all ${E.includes(s.value)?"bg-green-600 ring-2 ring-green-400":"bg-gray-800 hover:bg-gray-700"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:s.icon}),e.jsx("div",{className:"text-xs leading-tight",children:s.label})]},s.value))}),E.length===0&&e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"No equipment selected = bodyweight exercises"}),E.length>0&&e.jsxs("p",{className:"text-xs text-green-400 mt-2",children:[E.length," item",E.length>1?"s":""," selected"]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm text-gray-400 uppercase mb-3",children:"Your Goal"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:bt.map(s=>e.jsxs("button",{onClick:()=>ds(s.value),className:`p-3 rounded-xl text-left transition-all ${I.includes(s.value)?"bg-blue-600 ring-2 ring-blue-400":"bg-gray-800 hover:bg-gray-700"}`,children:[e.jsx("span",{className:"text-xl mr-2",children:s.icon}),e.jsx("span",{className:"font-medium",children:s.label})]},s.value))})]}),e.jsx("button",{onClick:cs,disabled:ne,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 py-4 rounded-2xl font-bold text-lg transition-all disabled:opacity-50",children:ne?"Generating...":"Generate Workout"}),e.jsx("button",{onClick:()=>p("manual"),className:"w-full bg-gray-800 hover:bg-gray-700 py-3 rounded-xl text-gray-400 text-sm",children:"Or browse all exercises manually"})]})]}),ps=()=>{const s=se(),t=s[i],c=s.length>0?(i+1)/s.length*100:0;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 text-white pb-24",children:[w&&e.jsxs("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-50 bg-green-500 px-8 py-4 rounded-2xl font-bold animate-bounce",children:["Done: ",w]}),e.jsx("header",{className:"bg-gray-900/80 backdrop-blur-lg p-4 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("button",{onClick:()=>{p("select"),A(null)},className:"text-blue-400",children:"â† Exit"}),e.jsx("h1",{className:"text-xl font-bold",children:"Your Workout"}),e.jsxs("div",{className:"bg-green-600 px-3 py-1 rounded-full text-sm font-bold",children:[M.length,"/",s.length]})]}),e.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-emerald-400 transition-all duration-300",style:{width:`${c}%`}})})]})}),e.jsxs("main",{className:"max-w-lg mx-auto p-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl overflow-hidden mb-6 border border-white/5",children:[e.jsxs("button",{onClick:()=>x(!j),className:"w-full p-3 flex items-center justify-between text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:"ðŸ”¥"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:"Muscle Activation"}),e.jsxs("div",{className:"text-xs text-gray-400",children:[fe.length," muscle groups worked"]})]})]}),e.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform ${j?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),j&&e.jsx("div",{className:"p-4 pt-0",children:e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase mb-2",children:"Current Exercise"}),e.jsx(Be,{muscles:is,mode:"compact",interactive:!1,showLabels:!1,autoRotate:!1,className:"w-full",style:{height:140}}),t&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2 justify-center",children:t.primaryMuscles?.slice(0,3).map(l=>e.jsx("span",{className:"bg-purple-500/30 text-purple-200 px-2 py-0.5 rounded text-xs",children:l},l))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase mb-2",children:"Workout Total"}),e.jsx(Be,{muscles:fe,mode:"compact",interactive:!1,showLabels:!1,autoRotate:!1,className:"w-full",style:{height:140}}),fe.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2 justify-center",children:fe.slice(0,3).map(l=>e.jsx("span",{className:"bg-green-500/30 text-green-200 px-2 py-0.5 rounded text-xs",children:l.id.replace(/_/g," ")},l.id))})]})]})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-400 mb-2",children:[e.jsxs("span",{children:[f?.actualDuration||R," min"]}),e.jsxs("span",{children:[Te.find(l=>l.value===k)?.icon," ",k]}),e.jsxs("span",{children:[s.length," exercises"]})]}),f?.muscleCoverage&&e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.keys(f.muscleCoverage).slice(0,6).map(l=>e.jsx("span",{className:"bg-gray-700 px-2 py-1 rounded text-xs",children:l},l))})]}),t&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-blue-600 rounded-3xl overflow-hidden mb-6 shadow-2xl",children:[t.id&&qs(t.id)&&e.jsx("div",{className:"h-40 bg-black/20",children:e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-white/5 to-white/10 animate-pulse"}),children:e.jsx(mt,{exerciseId:t.id,exerciseName:t.name,primaryMuscles:t.primaryMuscles,size:"md",showMuscleLabels:!1,interactive:!1,className:"w-full h-full"})})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide opacity-70 mb-2",children:t.phase==="warmup"?"Warm-up":t.phase==="cooldown"?"Cool-down":`Exercise ${i+1-(f?.warmup?.length||0)}`}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:t.name}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:t.sets}),e.jsx("div",{className:"text-xs opacity-80",children:"Sets"})]}),e.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:t.reps}),e.jsx("div",{className:"text-xs opacity-80",children:"Reps"})]}),e.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center",children:[e.jsxs("div",{className:"text-3xl font-bold",children:[t.restSeconds,"s"]}),e.jsx("div",{className:"text-xs opacity-80",children:"Rest"})]})]}),t.notes&&e.jsx("p",{className:"text-sm opacity-80 mb-4",children:t.notes}),e.jsx("div",{className:"flex gap-2 text-xs opacity-70 flex-wrap",children:t.primaryMuscles?.map(l=>e.jsx("span",{className:"bg-white/10 px-2 py-1 rounded",children:l},l))})]})]}),t&&e.jsx("div",{className:"mb-6",children:e.jsx(at,{exerciseId:t.exerciseId,delay:1500})}),t&&t.id&&!t.isActivity&&e.jsxs("div",{className:"mb-6 bg-gray-800/50 rounded-2xl p-4 border border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"Log Your Sets"}),e.jsx("button",{onClick:()=>me(!0),className:"text-xs text-blue-400 hover:text-blue-300",children:"Swap Exercise"})]}),e.jsx(ot,{exerciseId:t.id,exerciseName:t.name,suggestedSets:t.sets||3,suggestedReps:typeof t.reps=="number"?t.reps:10,onSetLogged:l=>{D(g=>g.find(P=>P.id===t.id)?g.map(P=>P.id===t.id?{...P,sets:(P.sets||0)+1,tu:(P.tu||0)+(l.tu||0)}:P):[...g,{id:t.id,name:t.name,sets:1,reps:l.reps,weight:Math.round((l.weightKg||0)*2.205),tu:l.tu||0,primaryMuscles:t.primaryMuscles}])},onAllSetsComplete:()=>{const l=se();i<l.length-1&&o(i+1),v(`${t.name} completed!`),setTimeout(()=>v(null),2e3)},compact:!1})]}),t&&(t.isActivity||!t.id)&&e.jsxs("div",{className:"flex gap-3 mb-6",children:[e.jsx("button",{onClick:()=>i>0&&o(i-1),disabled:i===0,className:"flex-1 bg-gray-700 hover:bg-gray-600 disabled:opacity-50 py-4 rounded-xl font-bold",children:"Previous"}),e.jsx("button",{onClick:()=>gs(t),className:"flex-[2] bg-green-600 hover:bg-green-500 py-4 rounded-xl font-bold text-lg",children:"Done"}),e.jsx("button",{onClick:()=>i<s.length-1&&o(i+1),disabled:i===s.length-1,className:"flex-1 bg-gray-700 hover:bg-gray-600 disabled:opacity-50 py-4 rounded-xl font-bold",children:"Skip"})]}),t&&t.id&&!t.isActivity&&e.jsxs("div",{className:"flex gap-3 mb-6",children:[e.jsx("button",{onClick:()=>i>0&&o(i-1),disabled:i===0,className:"flex-1 bg-gray-700 hover:bg-gray-600 disabled:opacity-50 py-3 rounded-xl font-medium",children:"Previous"}),e.jsx("button",{onClick:()=>{const l=se();i<l.length-1&&o(i+1)},disabled:i===s.length-1,className:"flex-1 bg-gray-700 hover:bg-gray-600 disabled:opacity-50 py-3 rounded-xl font-medium",children:"Next Exercise"})]}),M.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm text-gray-400 uppercase mb-3",children:"Completed"}),e.jsx("div",{className:"space-y-2",children:M.map((l,g)=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-3 flex items-center gap-3",children:[e.jsx("div",{className:"bg-green-600 w-8 h-8 rounded-full flex items-center justify-center text-sm",children:"âœ“"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:l.name}),e.jsxs("div",{className:"text-xs text-gray-400",children:[l.sets," x ",l.reps]})]})]},g))})]}),M.length>0&&e.jsx("button",{onClick:Ue,disabled:V,className:"w-full bg-gradient-to-r from-green-600 to-emerald-500 hover:from-green-500 hover:to-emerald-400 py-4 rounded-2xl font-bold text-lg transition-all",children:V?"Completing...":`Complete Workout (${M.length} exercises)`}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-sm text-gray-400 uppercase mb-3",children:"All Exercises"}),e.jsx("div",{className:"space-y-2",children:s.map((l,g)=>{const S=M.some(te=>te.name===l.name),P=g===i;return e.jsxs("button",{onClick:()=>o(g),className:`w-full text-left rounded-xl p-3 flex items-center gap-3 transition-all ${P?"bg-purple-600":S?"bg-gray-800 opacity-60":"bg-gray-800 hover:bg-gray-700"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm ${S?"bg-green-600":P?"bg-white/20":"bg-gray-700"}`,children:S?"âœ“":g+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:l.name}),e.jsxs("div",{className:"text-xs text-gray-400",children:[l.sets," x ",l.reps," | ",l.phase]})]})]},g)})})]})]})]})},bs=()=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 text-white pb-24",children:[w&&e.jsxs("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-50 bg-green-500 px-8 py-4 rounded-2xl font-bold animate-bounce",children:[w,"!"]}),F&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-end justify-center",onClick:()=>U(null),children:e.jsxs("div",{className:"bg-gray-800 rounded-t-3xl p-6 w-full max-w-lg",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("span",{className:"text-5xl",children:Ee(F)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:F.name}),e.jsx("p",{className:"text-gray-400",children:$e(F)})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Sets"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[e.jsx("button",{onClick:()=>B(Math.max(1,T-1)),className:"bg-gray-700 w-10 h-10 rounded-full text-xl",children:"-"}),e.jsx("span",{className:"text-3xl font-bold w-12 text-center",children:T}),e.jsx("button",{onClick:()=>B(T+1),className:"bg-gray-700 w-10 h-10 rounded-full text-xl",children:"+"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Reps"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[e.jsx("button",{onClick:()=>ee(Math.max(1,G-1)),className:"bg-gray-700 w-10 h-10 rounded-full text-xl",children:"-"}),e.jsx("span",{className:"text-3xl font-bold w-12 text-center",children:G}),e.jsx("button",{onClick:()=>ee(G+1),className:"bg-gray-700 w-10 h-10 rounded-full text-xl",children:"+"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"lbs"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[e.jsx("button",{onClick:()=>u(Math.max(0,Y-5)),className:"bg-gray-700 w-10 h-10 rounded-full text-xl",children:"-"}),e.jsx("span",{className:"text-3xl font-bold w-12 text-center",children:Y}),e.jsx("button",{onClick:()=>u(Y+5),className:"bg-gray-700 w-10 h-10 rounded-full text-xl",children:"+"})]})]})]}),e.jsx("button",{onClick:ms,className:"w-full bg-green-600 hover:bg-green-700 py-4 rounded-2xl font-bold text-lg",children:"Log Exercise"})]})}),e.jsx("header",{className:"bg-gray-900/80 backdrop-blur-lg p-4 sticky top-0 z-10 border-b border-gray-700/30",children:e.jsxs("div",{className:"max-w-5xl mx-auto flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>p("select"),className:"flex items-center gap-2 text-blue-400 hover:text-blue-300 transition-colors",children:[e.jsx("span",{children:"â†"}),e.jsx("img",{src:"/logo.png",alt:"MuscleMap",className:"w-6 h-6 rounded-md"})]}),e.jsx("h1",{className:"text-xl font-bold",children:"Browse Exercises"}),e.jsxs("div",{className:"bg-green-600 px-3 py-1 rounded-full text-sm font-bold",children:[M.length," logged"]})]})}),e.jsxs("main",{className:"max-w-5xl mx-auto p-4",children:[M.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-sm text-gray-400 mb-2 uppercase",children:"Today's Workout"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:M.map((s,t)=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:Ee(s)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-sm truncate",children:s.name}),e.jsxs("div",{className:"text-xs text-gray-400",children:[s.sets,"x",s.reps," ",s.weight>0?`${s.weight}lb`:""]})]})]},t))}),e.jsx("button",{onClick:Ue,disabled:V,className:"w-full bg-green-600 hover:bg-green-500 py-4 rounded-2xl font-bold text-lg mt-4 transition-all",children:V?"Completing...":"Complete Workout"})]}),e.jsx("input",{type:"text",placeholder:"Search exercises...",value:H,onChange:s=>L(s.target.value),className:"w-full bg-gray-800 rounded-2xl p-4 mb-4 text-lg"}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-4 mb-4",children:[e.jsx("button",{onClick:()=>le(null),className:`px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap ${z?"bg-gray-700":"bg-purple-600"}`,children:"All"}),ss.map(s=>e.jsxs("button",{onClick:()=>le(s.id),className:`px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap ${z===s.id?"bg-purple-600":"bg-gray-700"}`,children:[s.icon," ",s.name]},s.id))]}),ne?e.jsx("div",{className:"text-center py-12 text-gray-400",children:"Loading exercises..."}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:us.map(s=>{const t=[...(s.primary_muscles||[]).map(c=>({id:ue(c),intensity:1,isPrimary:!0})),...(s.secondary_muscles||[]).slice(0,2).map(c=>({id:ue(c),intensity:.5,isPrimary:!1}))];return e.jsxs("button",{onClick:()=>U(s),className:`bg-gradient-to-br ${xs(s).c} rounded-2xl p-3 text-left hover:scale-105 active:scale-95 transition-all shadow-lg relative`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("div",{className:"text-3xl",children:Ee(s)}),t.length>0&&e.jsx(zs,{muscles:t,size:"xs",className:"opacity-90"})]}),e.jsx("div",{className:"font-bold text-sm truncate mt-1",children:s.name}),e.jsx("div",{className:"text-xs opacity-80",children:$e(s)})]},s.id)})})]})]}),fs=()=>Q&&e.jsx(nt,{workout:{duration:R,exerciseCount:Q.exerciseCount||0,totalSets:Q.totalSets||0,totalTU:Q.tuEarned||0,exercises:Q.exercises||[],goals:I},onClose:()=>{J(null),p("select"),A(null),D([]),h("/dashboard")}}),ys=async s=>{await as(s)&&m&&(p("workout"),de(!1))},vs=async s=>{await rs(s),n(t=>t.filter(c=>c.id!==s)),xe.length<=1&&de(!1)},js=s=>{const c=se()[i];if(f&&c){const l=g=>g.map(S=>S.id===c.id||S.exerciseId===c.exerciseId?{...S,id:s.id,exerciseId:s.id,name:s.name,primaryMuscles:s.primaryMuscles}:S);A({...f,warmup:f.warmup?l(f.warmup):void 0,exercises:f.exercises?l(f.exercises):void 0,cooldown:f.cooldown?l(f.cooldown):void 0})}me(!1),v(`Switched to ${s.name}`),setTimeout(()=>v(null),2e3)};return e.jsxs(e.Fragment,{children:[fs(),d==="select"&&hs(),d==="workout"&&ps(),d==="manual"&&bs(),(d==="workout"||d==="manual")&&C&&e.jsx(Vs,{}),Ce&&i>=0&&e.jsx(dt,{exerciseId:se()[i]?.id||"",exerciseName:se()[i]?.name||"",availableEquipment:E,onSelect:js,onCancel:()=>me(!1)}),Me&&xe.length>0&&e.jsx(ut,{sessions:xe,onRecover:ys,onDiscard:vs,onDismiss:()=>de(!1)})]})}export{Vt as default};
