import{a as S,j as t,u as E,r as p,L as j}from"./react-vendor-D847gc3Q.js";import{d as C,g as L,r as O,m as v,C as A,e as M,f as P,t as R,s as D}from"./index-CC5Z0mJC.js";import{S as F}from"./SEO-B-NXRDHI.js";import{L as I}from"./Logo-u5Pq-Syc.js";import{s as T}from"./sanitize-CfVRSXz9.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./apollo-vendor-BNHFeEEc.js";import"./reactflow-vendor-CYb5nRwM.js";import"./d3-vendor-mcDw60ct.js";import"./recharts-vendor-CxtoZpzE.js";function _({message:e,category:o,httpStatus:s,onDismiss:n,onRetry:a,shouldReport:r=!0,context:l}){const d=o||C(new Error(e),s),u=L(d);return S.useEffect(()=>{r&&O({type:d,message:e,httpStatus:s,url:window.location.href,userAgent:navigator.userAgent,timestamp:new Date().toISOString(),context:{...l,isToast:!0}})},[e,d,s,r,l]),t.jsxs(v.div,{initial:{opacity:0,y:50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},transition:{type:"spring",stiffness:400,damping:25},className:"pointer-events-auto px-4 py-3 rounded-2xl backdrop-blur-xl border border-rose-500/30 bg-rose-500/10 shadow-lg flex items-center gap-4 max-w-md",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(A,{state:u.mood,size:"sm"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-white font-medium text-sm truncate",children:u.title}),t.jsx("p",{className:"text-gray-400 text-xs truncate",children:e.length>60?`${e.slice(0,60)}...`:e})]}),t.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a&&t.jsx("button",{onClick:a,className:"px-3 py-1.5 min-h-[36px] bg-white/20 hover:bg-white/30 rounded-lg text-white text-sm font-medium transition-colors active:scale-95",children:"Retry"}),n&&t.jsx("button",{onClick:n,className:"p-1.5 hover:bg-white/10 rounded-lg transition-colors","aria-label":"Dismiss",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})}const h="Something went wrong";function w(e,o=2e3){try{const s=new WeakSet,n=JSON.stringify(e,(a,r)=>{if(typeof r=="bigint")return r.toString();if(typeof r=="object"&&r!==null){if(s.has(r))return"[Circular]";s.add(r)}return typeof r=="function"?`[Function ${r.name||"anonymous"}]`:r},2);return n?n.length>o?n.slice(0,o)+"â€¦":n:""}catch{try{return String(e)}catch{return""}}}function i(e){if(typeof e!="string")return"";const o=e.trim();return!o||o==="[object Object]"?"":o}function x(e){if(!e||typeof e!="object")return"";const o=e,s=i(o.message)||i(o.error)||i(o.err)||i(o.detail)||i(o.title);if(s)return s;const n=[o.error,o.err,o.data,o.response,o.body];for(const a of n){if(typeof a=="string"){const r=i(a);if(r)return r}if(a&&typeof a=="object"){const r=x(a);if(r)return r}}return""}const W=e=>!!e&&typeof e=="object"&&!Array.isArray(e)&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)&&Object.keys(e).length===0,z=e=>Array.isArray(e)&&e.length===0;function k(e,o=h){const s=i(o)||h;if(e==null)return s;const n=i(e);if(n)return n;if(e instanceof Error){const a=i(e.message);if(a)return a;const r=x(e);return r||i(w({name:e.name,message:e.message,stack:e.stack}))||s}if(typeof e=="object"){if(W(e)||z(e))return s;const a=x(e);if(a)return a;if(s!==h)return s;const r=i(w(e));return!r||r==="{}"||r==="[]"?s:r}try{return i(String(e))||s}catch{return s}}function V(){const e=E(),{login:o}=M(),[s,n]=p.useState({email:"",password:""}),[a,r]=p.useState(""),[l,d]=p.useState(!1),u=async m=>{m.preventDefault(),r(""),d(!0);try{const g=await P("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:T(s.email),password:s.password})});let f=null;try{f=await g.json()}catch{f=null}if(!g.ok)throw new Error(k(f,`Login failed (${g.status})`));const b=f?.data??f,y=b?.token,c=b?.user;if(!y||!c)throw new Error("Login response missing token/user (API contract mismatch).");o(c,y),R("email"),D(c.id,{archetype:c.archetype||"none",has_completed_onboarding:!!c.onboardingCompletedAt||!!c.archetype});const N=!!c.onboardingCompletedAt||!!c.archetype;e(N?"/dashboard":"/onboarding")}catch(g){r(k(g,"Login failed"))}finally{d(!1)}};return t.jsxs(t.Fragment,{children:[t.jsx(F,{title:"Log In",description:"Log in to your MuscleMap account. Access your workouts, progress, and community features."}),t.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{backgroundColor:"#0a0a0f",backgroundImage:"radial-gradient(circle at 30% 20%, rgba(99, 102, 241, 0.12), transparent 40%), radial-gradient(circle at 70% 80%, rgba(168, 85, 247, 0.12), transparent 40%)"},children:t.jsxs("div",{className:"w-full max-w-md",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsxs(j,{to:"/",className:"inline-block",children:[t.jsx("div",{className:"mx-auto mb-4 w-20 h-20 rounded-2xl shadow-lg shadow-purple-500/20 hover:shadow-purple-500/40 transition-shadow duration-300 overflow-hidden",children:t.jsx(I,{size:"xl",priority:!0,className:"rounded-2xl"})}),t.jsx("h1",{className:"text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500",children:"MuscleMap"})]}),t.jsx("p",{className:"text-gray-400 mt-2",children:"Welcome back"})]}),t.jsxs("form",{onSubmit:u,className:"bg-gray-800/80 backdrop-blur-sm border border-gray-700/50 rounded-xl p-6 space-y-4",children:[a&&t.jsx(_,{message:a,category:"auth",onDismiss:()=>r(""),onRetry:u,shouldReport:a.includes("500")||a.includes("server")}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-gray-300 text-sm mb-1",children:"Email"}),t.jsx("input",{type:"email",value:s.email,onChange:m=>n({...s,email:m.target.value}),className:"w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",placeholder:"you@example.com",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-gray-300 text-sm mb-1",children:"Password"}),t.jsx("input",{type:"password",value:s.password,onChange:m=>n({...s,password:m.target.value}),className:"w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",placeholder:"Your password",required:!0})]}),t.jsx("button",{type:"submit",disabled:l,className:"w-full p-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white font-bold rounded-lg disabled:opacity-50",children:l?"Logging in...":"Log In"}),t.jsxs("p",{className:"text-center text-gray-400 text-sm",children:["Don't have an account? ",t.jsx(j,{to:"/signup",className:"text-blue-400 hover:text-blue-300",children:"Sign up"})]})]})]})})]})}export{V as default};
