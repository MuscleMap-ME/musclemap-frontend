import{l as M,d as W,r,j as e,L as x}from"./react-vendor-D1NxaRNd.js";import{c as h}from"./recharts-vendor-BziRPEEi.js";import{y as I,m as w}from"./index-D_LgOQCi.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./d3-vendor-mcDw60ct.js";import"./apollo-vendor-BMQ75Ycx.js";import"./reactflow-vendor-Dz2P_-Qa.js";const i={Back:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 19l-7-7 7-7"})}),Check:()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),X:()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),User:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),Shield:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),AlertTriangle:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})},N={bronze:{label:"Bronze",color:"from-amber-700 to-amber-900",text:"text-amber-500"},silver:{label:"Silver",color:"from-gray-400 to-gray-600",text:"text-gray-400"},gold:{label:"Gold",color:"from-amber-400 to-yellow-600",text:"text-amber-400"},platinum:{label:"Platinum",color:"from-cyan-400 to-blue-600",text:"text-cyan-400"},diamond:{label:"Diamond",color:"from-violet-400 to-purple-600",text:"text-violet-400"}};function G(){const{verificationId:m}=M();W();const{token:u}=I(),[s,k]=r.useState(null),[L,C]=r.useState(!0),[l,f]=r.useState(!1),[c,d]=r.useState(null),[o,S]=r.useState(null),[a,B]=r.useState(""),[b,P]=r.useState(""),[p,T]=r.useState(""),[j,A]=r.useState(!0);r.useEffect(()=>{z()},[m]);const z=async()=>{try{const t=await fetch(`/api/verifications/${m}`,{headers:{Authorization:`Bearer ${u}`}});if(!t.ok)throw new Error("Verification not found");const n=await t.json();k(n.data)}catch(t){d(t.message)}finally{C(!1)}},g=async t=>{if(t&&!a.trim()){d("Please provide attestation text when confirming");return}f(!0),d(null);try{const n=await fetch(`/api/verifications/${m}/witness`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({confirm:t,attestation_text:a,relationship:b,location_description:p,is_public:j})}),y=await n.json();if(!n.ok)throw new Error(y.error?.message||"Failed to submit attestation");S({confirmed:t,message:y.message})}catch(n){d(n.message)}finally{f(!1)}};if(L)return e.jsx("div",{className:"min-h-screen bg-[#0a0a0f] flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-violet-500 border-t-transparent rounded-full animate-spin"})});if(o)return e.jsx("div",{className:"min-h-screen bg-[#0a0a0f] flex items-center justify-center",children:e.jsxs(w.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"text-center p-8 max-w-md",children:[e.jsx("div",{className:h("w-20 h-20 mx-auto mb-4 rounded-full flex items-center justify-center",o.confirmed?"bg-green-500/20":"bg-red-500/20"),children:o.confirmed?e.jsx(i.Check,{}):e.jsx(i.X,{})}),e.jsx("h2",{className:"text-2xl font-semibold text-white mb-2",children:o.confirmed?"Achievement Verified!":"Request Declined"}),e.jsx("p",{className:"text-gray-400 mb-6",children:o.message}),e.jsx(x,{to:"/achievements/my-verifications",className:"inline-block px-6 py-3 bg-violet-600 rounded-xl hover:bg-violet-500 transition-colors",children:"Back to Verifications"})]})});if(c&&!s)return e.jsx("div",{className:"min-h-screen bg-[#0a0a0f] flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-red-500/20 flex items-center justify-center",children:e.jsx(i.AlertTriangle,{})}),e.jsx("p",{className:"text-red-400 mb-4",children:c}),e.jsx(x,{to:"/achievements/my-verifications",className:"text-violet-400 hover:underline",children:"Back to Verifications"})]})});const v=N[s?.achievementTier]||N.bronze;return e.jsxs("div",{className:"min-h-screen bg-[#0a0a0f] text-white pb-8",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-[#0a0a0f]/80 backdrop-blur-xl border-b border-white/5",children:e.jsx("div",{className:"max-w-2xl mx-auto px-4 h-16 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{to:"/achievements/my-verifications",className:"p-2 -ml-2 rounded-xl hover:bg-white/5",children:e.jsx(i.Back,{})}),e.jsx("h1",{className:"text-xl font-semibold",children:"Witness Request"})]})})}),e.jsxs("main",{className:"max-w-2xl mx-auto px-4 py-6",children:[e.jsx(w.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:h("rounded-2xl p-6 mb-6 bg-gradient-to-br",v.color),children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl bg-white/20 flex items-center justify-center",children:e.jsx(i.Shield,{})}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-semibold uppercase tracking-wider opacity-80",children:[v.label," Tier"]}),e.jsx("h2",{className:"text-2xl font-bold",children:s?.achievementName})]})]})}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-4 mb-6 border border-white/5",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Submitted by"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-violet-500/20 flex items-center justify-center",children:s?.avatarUrl?e.jsx("img",{src:s.avatarUrl,alt:"",className:"w-full h-full rounded-full"}):e.jsx(i.User,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-lg",children:s?.displayName||s?.username}),e.jsxs("p",{className:"text-gray-400",children:["@",s?.username]})]})]})]}),s?.videoUrl&&e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Video Proof"}),e.jsx("video",{src:s.videoUrl,className:"w-full rounded-xl bg-black",controls:!0})]}),s?.notes&&e.jsxs("div",{className:"bg-white/5 rounded-xl p-4 mb-6",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Their Description"}),e.jsxs("p",{className:"text-white",children:['"',s.notes,'"']})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(i.AlertTriangle,{}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-400",children:"Important"}),e.jsx("p",{className:"text-sm text-yellow-400/80 mt-1",children:"Only confirm if you have personally witnessed this person perform this achievement in real life. Your name will be publicly associated with this verification."})]})]})}),e.jsxs("form",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Your Attestation ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("textarea",{value:a,onChange:t=>B(t.target.value),placeholder:"I confirm that I personally witnessed [Name] perform this achievement on [date] at [location]...",rows:4,maxLength:500,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500/50 resize-none"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.length,"/500 characters"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Your Relationship (optional)"}),e.jsxs("select",{value:b,onChange:t=>P(t.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-violet-500/50",children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"friend",children:"Friend"}),e.jsx("option",{value:"gym_buddy",children:"Gym Buddy"}),e.jsx("option",{value:"training_partner",children:"Training Partner"}),e.jsx("option",{value:"coach",children:"Coach/Trainer"}),e.jsx("option",{value:"family",children:"Family Member"}),e.jsx("option",{value:"coworker",children:"Coworker"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Where did you witness this? (optional)"}),e.jsx("input",{type:"text",value:p,onChange:t=>T(t.target.value),placeholder:"e.g., Gold's Gym Downtown, Central Park...",maxLength:200,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500/50"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"isPublic",checked:j,onChange:t=>A(t.target.checked),className:"w-5 h-5 rounded bg-white/5 border-white/10 text-violet-600 focus:ring-violet-500"}),e.jsx("label",{htmlFor:"isPublic",className:"text-sm text-gray-300",children:"Show my name publicly as the witness for this achievement"})]}),c&&e.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/30 rounded-xl",children:e.jsx("p",{className:"text-red-400 text-sm",children:c})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:()=>g(!1),disabled:l,className:"flex-1 py-4 bg-red-500/20 border border-red-500/30 text-red-400 rounded-xl font-semibold hover:bg-red-500/30 transition-colors disabled:opacity-50",children:l?"Processing...":"Decline"}),e.jsx("button",{type:"button",onClick:()=>g(!0),disabled:l||!a.trim(),className:h("flex-1 py-4 rounded-xl font-semibold transition-colors",l||!a.trim()?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-500 text-white"),children:l?"Processing...":"Confirm & Verify"})]})]})]})]})}export{G as default};
