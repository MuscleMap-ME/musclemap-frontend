import{k as me,r,j as e,L as g}from"./react-vendor-D1NxaRNd.js";import{c as d}from"./recharts-vendor-BziRPEEi.js";import{K as he,A as D,m as T}from"./index-CfuVQjw9.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./d3-vendor-mcDw60ct.js";import"./apollo-vendor-BMQ75Ycx.js";import"./reactflow-vendor-Dz2P_-Qa.js";const l={Back:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 19l-7-7 7-7"})}),Search:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Filter:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),Plus:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),Heart:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),HeartFilled:()=>e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),Clock:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),Tag:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),Sparkle:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),Close:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})}),ShoppingBag:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),Gavel:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),Exchange:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),Gift:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"})}),Eye:()=>e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})},z={common:{label:"Common",color:"from-gray-500 to-gray-600",border:"border-gray-500/30",bg:"bg-gray-500/10",textColor:"text-gray-400"},uncommon:{label:"Uncommon",color:"from-green-500 to-emerald-600",border:"border-green-500/30",bg:"bg-green-500/10",textColor:"text-green-400"},rare:{label:"Rare",color:"from-blue-500 to-cyan-600",border:"border-blue-500/30",bg:"bg-blue-500/10",textColor:"text-blue-400"},epic:{label:"Epic",color:"from-purple-500 to-violet-600",border:"border-purple-500/30",bg:"bg-purple-500/10",textColor:"text-purple-400"},legendary:{label:"Legendary",color:"from-amber-400 to-orange-500",border:"border-amber-500/30",bg:"bg-amber-500/10",textColor:"text-amber-400"},mythic:{label:"Mythic",color:"from-pink-500 to-rose-600",border:"border-pink-500/30",bg:"bg-pink-500/10",textColor:"text-pink-400"},divine:{label:"Divine",color:"from-cyan-400 to-sky-500",border:"border-cyan-400/30",bg:"bg-cyan-400/10",textColor:"text-cyan-400"}},ue=[{key:"all",label:"All",icon:e.jsx(l.ShoppingBag,{})},{key:"buy_now",label:"Buy Now",icon:e.jsx(l.Tag,{})},{key:"auction",label:"Auctions",icon:e.jsx(l.Gavel,{})},{key:"offer_only",label:"Offers",icon:e.jsx(l.Exchange,{})}],pe=[{key:"newest",label:"Newest First"},{key:"ending_soon",label:"Ending Soon"},{key:"price_asc",label:"Price: Low to High"},{key:"price_desc",label:"Price: High to Low"},{key:"popular",label:"Most Popular"}],be=[{key:"all",label:"All Categories"},{key:"skin",label:"Skins"},{key:"frame",label:"Profile Frames"},{key:"badge",label:"Badges"},{key:"effect",label:"Effects"},{key:"theme",label:"Themes"},{key:"emote",label:"Emotes"},{key:"title",label:"Titles"}];function Le(){const{token:s}=he(),[c,f]=me(),[o,p]=r.useState([]),[i,u]=r.useState(null),[x,P]=r.useState([]),[j,O]=r.useState(null),[m,W]=r.useState(!0),[h,y]=r.useState(null),[B,b]=r.useState(!1),[A,G]=r.useState(""),[V,Y]=r.useState(""),[Z,$]=r.useState(!1),[R,U]=r.useState({show:!1,message:"",type:"success"}),[v,ee]=r.useState(c.get("search")||""),[N,te]=r.useState(c.get("type")||"all"),[k,se]=r.useState(c.get("category")||"all"),[S,ae]=r.useState(c.get("rarity")||"all"),[L,re]=r.useState(c.get("sort")||"newest"),[C,le]=r.useState(c.get("minPrice")||""),[_,oe]=r.useState(c.get("maxPrice")||""),[F,J]=r.useState(null),[ie,ne]=r.useState(!0),E=r.useCallback(async(t=!0)=>{t&&(W(!0),J(null));try{const a=new URLSearchParams;v&&a.set("search",v),N!=="all"&&a.set("listingType",N),k!=="all"&&a.set("category",k),S!=="all"&&a.set("rarity",S),L&&a.set("sortBy",L),C&&a.set("minPrice",C),_&&a.set("maxPrice",_),!t&&F&&a.set("cursor",F),a.set("limit","24");const w=await(await fetch(`/api/marketplace?${a}`,{headers:{Authorization:`Bearer ${s}`}})).json();p(t?w.data?.listings||[]:I=>[...I,...w.data?.listings||[]]),J(w.data?.nextCursor||null),ne(!!w.data?.nextCursor)}catch{}finally{W(!1)}},[s,v,N,k,S,L,C,_,F]),H=r.useCallback(async()=>{try{const[t,a,n]=await Promise.all([fetch("/api/wallet",{headers:{Authorization:`Bearer ${s}`}}),fetch("/api/marketplace/watchlist",{headers:{Authorization:`Bearer ${s}`}}),fetch("/api/marketplace/my-stats",{headers:{Authorization:`Bearer ${s}`}})]),[w,I,xe]=await Promise.all([t.json(),a.json(),n.json()]);u(w.data),P(I.data||[]),O(xe.data)}catch{}},[s]);r.useEffect(()=>{H(),E(!0)},[H,E]),r.useEffect(()=>{const t=new URLSearchParams;v&&t.set("search",v),N!=="all"&&t.set("type",N),k!=="all"&&t.set("category",k),S!=="all"&&t.set("rarity",S),L!=="newest"&&t.set("sort",L),C&&t.set("minPrice",C),_&&t.set("maxPrice",_),f(t)},[v,N,k,S,L,C,_,f]);const M=(t,a="success")=>{U({show:!0,message:t,type:a}),setTimeout(()=>U({show:!1,message:"",type:"success"}),3e3)},ce=async t=>{$(!0);try{const n=await(await fetch(`/api/marketplace/listings/${t}/buy`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}})).json();n.data?.success?(M("Purchase successful!","success"),y(null),E(!0),H()):M(n.error?.message||"Purchase failed","error")}catch{M("Purchase failed","error")}finally{$(!1)}},de=async t=>{if(!A||parseInt(A)<=0){M("Please enter a valid offer amount","error");return}$(!0);try{const n=await(await fetch(`/api/marketplace/listings/${t}/offer`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({amount:parseInt(A),message:V||void 0})})).json();n.data?(M("Offer submitted!","success"),G(""),Y(""),y(null)):M(n.error?.message||"Failed to submit offer","error")}catch{M("Failed to submit offer","error")}finally{$(!1)}},K=async t=>{const a=x.some(n=>n.listing_id===t);try{a?(await fetch(`/api/marketplace/watchlist/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}}),P(n=>n.filter(w=>w.listing_id!==t))):(await fetch("/api/marketplace/watchlist",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({listingId:t})}),P(n=>[...n,{listing_id:t}]))}catch{}},q=t=>x.some(a=>a.listing_id===t),Q=t=>(i?.balance||0)>=t;return m&&o.length===0?e.jsx("div",{className:"min-h-screen bg-[#0a0a0f] flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-violet-500 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"min-h-screen bg-[#0a0a0f] text-white pb-8",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-[#0a0a0f]/80 backdrop-blur-xl border-b border-white/5",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 h-16 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{to:"/dashboard",className:"p-2 -ml-2 rounded-xl hover:bg-white/5",children:e.jsx(l.Back,{})}),e.jsx("h1",{className:"text-xl font-semibold",children:"Marketplace"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{to:"/marketplace/my-listings",className:"px-3 py-2 text-sm bg-white/5 hover:bg-white/10 rounded-xl transition-colors",children:"My Listings"}),e.jsxs(g,{to:"/wallet",className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-violet-600 to-purple-600 rounded-xl transition-all hover:opacity-90",children:[e.jsx(l.Sparkle,{}),e.jsx("span",{className:"font-bold",children:(i?.balance||0).toLocaleString()})]})]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 py-6",children:[j&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-white/5 rounded-xl",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Total Sales"}),e.jsx("p",{className:"text-xl font-bold",children:j.totalSales||0})]}),e.jsxs("div",{className:"p-4 bg-white/5 rounded-xl",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Revenue"}),e.jsx("p",{className:"text-xl font-bold",children:(j.totalRevenue||0).toLocaleString()})]}),e.jsxs("div",{className:"p-4 bg-white/5 rounded-xl",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Purchases"}),e.jsx("p",{className:"text-xl font-bold",children:j.totalPurchases||0})]}),e.jsxs("div",{className:"p-4 bg-white/5 rounded-xl",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Seller Level"}),e.jsx("p",{className:"text-xl font-bold",children:j.sellerLevel||1})]})]}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(l.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search marketplace...",value:v,onChange:t=>ee(t.target.value),className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl focus:outline-none focus:border-violet-500"})]}),e.jsx("button",{onClick:()=>b(!B),className:d("px-4 py-3 rounded-xl transition-colors",B?"bg-violet-600":"bg-white/5 hover:bg-white/10"),children:e.jsx(l.Filter,{})}),e.jsxs(g,{to:"/marketplace/create",className:"flex items-center gap-2 px-4 py-3 bg-violet-600 hover:bg-violet-700 rounded-xl transition-colors",children:[e.jsx(l.Plus,{}),e.jsx("span",{className:"hidden sm:inline",children:"Sell Item"})]})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 mb-4 scrollbar-hide",children:ue.map(t=>e.jsxs("button",{onClick:()=>te(t.key),className:d("flex items-center gap-2 px-4 py-2 rounded-xl whitespace-nowrap transition-all",N===t.key?"bg-violet-600 text-white":"bg-white/5 text-gray-400 hover:text-white hover:bg-white/10"),children:[t.icon,e.jsx("span",{className:"text-sm font-medium",children:t.label})]},t.key))}),e.jsx(D,{children:B&&e.jsx(T.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 p-4 bg-white/5 rounded-xl mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Category"}),e.jsx("select",{value:k,onChange:t=>se(t.target.value),className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-violet-500",children:be.map(t=>e.jsx("option",{value:t.key,children:t.label},t.key))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Rarity"}),e.jsxs("select",{value:S,onChange:t=>ae(t.target.value),className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-violet-500",children:[e.jsx("option",{value:"all",children:"All Rarities"}),Object.entries(z).map(([t,a])=>e.jsx("option",{value:t,children:a.label},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Sort By"}),e.jsx("select",{value:L,onChange:t=>re(t.target.value),className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-violet-500",children:pe.map(t=>e.jsx("option",{value:t.key,children:t.label},t.key))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400 mb-1 block",children:"Price Range"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",placeholder:"Min",value:C,onChange:t=>le(t.target.value),className:"w-1/2 px-3 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-violet-500"}),e.jsx("input",{type:"number",placeholder:"Max",value:_,onChange:t=>oe(t.target.value),className:"w-1/2 px-3 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-violet-500"})]})]})]})})}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:o.map(t=>e.jsx(ge,{listing:t,isWatched:q(t.id),canAfford:Q(t.price),onWatchlistToggle:()=>K(t.id),onClick:()=>y(t)},t.id))}),o.length===0&&!m&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx(l.ShoppingBag,{className:"w-12 h-12 mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No listings found"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Try adjusting your filters"})]}),ie&&o.length>0&&e.jsx("div",{className:"text-center mt-8",children:e.jsx("button",{onClick:()=>E(!1),disabled:m,className:"px-6 py-3 bg-white/5 hover:bg-white/10 rounded-xl transition-colors disabled:opacity-50",children:m?"Loading...":"Load More"})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mt-8",children:[e.jsxs(g,{to:"/trades",className:"p-4 bg-white/5 hover:bg-white/10 rounded-xl transition-colors text-center",children:[e.jsx(l.Exchange,{className:"w-8 h-8 mx-auto mb-2 text-blue-400"}),e.jsx("p",{className:"font-medium",children:"Trading"}),e.jsx("p",{className:"text-sm text-gray-400",children:"P2P Trades"})]}),e.jsxs(g,{to:"/collection",className:"p-4 bg-white/5 hover:bg-white/10 rounded-xl transition-colors text-center",children:[e.jsx(l.Eye,{className:"w-8 h-8 mx-auto mb-2 text-green-400"}),e.jsx("p",{className:"font-medium",children:"Collection"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Your Items"})]}),e.jsxs(g,{to:"/mystery-boxes",className:"p-4 bg-white/5 hover:bg-white/10 rounded-xl transition-colors text-center",children:[e.jsx(l.Gift,{className:"w-8 h-8 mx-auto mb-2 text-purple-400"}),e.jsx("p",{className:"font-medium",children:"Mystery Boxes"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Open Boxes"})]}),e.jsxs(g,{to:"/marketplace/watchlist",className:"p-4 bg-white/5 hover:bg-white/10 rounded-xl transition-colors text-center",children:[e.jsx(l.Heart,{className:"w-8 h-8 mx-auto mb-2 text-pink-400"}),e.jsx("p",{className:"font-medium",children:"Watchlist"}),e.jsxs("p",{className:"text-sm text-gray-400",children:[x.length," items"]})]})]})]}),e.jsx(D,{children:h&&e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>y(null),children:e.jsx(T.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:t=>t.stopPropagation(),className:"bg-[#12121a] border border-white/10 rounded-2xl w-full max-w-lg overflow-hidden max-h-[90vh] overflow-y-auto",children:e.jsx(fe,{listing:h,wallet:i,canAfford:Q(h.price),isWatched:q(h.id),onWatchlistToggle:()=>K(h.id),onBuyNow:()=>ce(h.id),onMakeOffer:()=>de(h.id),offerAmount:A,setOfferAmount:G,offerMessage:V,setOfferMessage:Y,submitting:Z,onClose:()=>y(null)})})})}),e.jsx(D,{children:R.show&&e.jsx(T.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},className:d("fixed bottom-4 left-4 right-4 mx-auto max-w-md px-4 py-3 rounded-xl text-center font-medium z-50",R.type==="success"?"bg-green-600":"bg-red-600"),children:R.message})})]})}function ge({listing:s,isWatched:c,canAfford:f,onWatchlistToggle:o,onClick:p}){const i=z[s.rarity]||z.common,u=X(s.expires_at);return e.jsxs(T.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},whileHover:{scale:1.02},onClick:p,className:d("relative overflow-hidden rounded-2xl border cursor-pointer transition-all",i.border,i.bg),children:[e.jsx("button",{onClick:x=>{x.stopPropagation(),o()},className:"absolute top-2 right-2 z-10 p-2 rounded-full bg-black/20 hover:bg-black/40 transition-colors",children:c?e.jsx(l.HeartFilled,{className:"text-pink-500"}):e.jsx(l.Heart,{})}),e.jsx("div",{className:"absolute top-2 left-2 z-10",children:e.jsx("span",{className:d("px-2 py-0.5 text-xs font-medium rounded-full",s.listing_type==="auction"?"bg-amber-500 text-black":s.listing_type==="offer_only"?"bg-blue-500 text-white":"bg-green-500 text-black"),children:s.listing_type==="auction"?"Auction":s.listing_type==="offer_only"?"Offers":"Buy Now"})}),e.jsx("div",{className:d("h-24 bg-gradient-to-br flex items-center justify-center",i.color,"opacity-30"),children:e.jsx("span",{className:"text-5xl",children:s.cosmetic_icon||"ðŸŽ¨"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:d("px-2 py-0.5 text-xs font-medium rounded-full bg-gradient-to-r text-white",i.color),children:i.label})}),e.jsx("h3",{className:"font-semibold mb-1 line-clamp-1",children:s.cosmetic_name||s.name}),s.listing_type==="auction"&&u&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-amber-400 mb-2",children:[e.jsx(l.Clock,{className:"w-4 h-4"}),e.jsx("span",{children:u})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l.Sparkle,{className:d("w-4 h-4",f?"text-violet-400":"text-red-400")}),e.jsx("span",{className:d("font-bold",f?"text-white":"text-red-400"),children:(s.price||0).toLocaleString()})]}),s.bid_count>0&&e.jsxs("span",{className:"text-xs text-gray-400",children:[s.bid_count," bids"]})]})]})]})}function fe({listing:s,wallet:c,canAfford:f,isWatched:o,onWatchlistToggle:p,onBuyNow:i,onMakeOffer:u,offerAmount:x,setOfferAmount:P,offerMessage:j,setOfferMessage:O,submitting:m,onClose:W}){const h=z[s.rarity]||z.common,[y,B]=r.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:d("h-40 bg-gradient-to-br relative",h.color),children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:"text-8xl opacity-50",children:s.cosmetic_icon||"ðŸŽ¨"})}),e.jsx("button",{onClick:W,className:"absolute top-4 right-4 p-2 rounded-xl bg-black/20 hover:bg-black/40 transition-all",children:e.jsx(l.Close,{})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:[e.jsx("span",{className:d("px-2 py-0.5 text-xs font-medium rounded-full bg-gradient-to-r text-white",h.color),children:h.label}),e.jsx("span",{className:d("px-2 py-0.5 text-xs font-medium rounded-full",s.listing_type==="auction"?"bg-amber-500/20 text-amber-400":s.listing_type==="offer_only"?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"),children:s.listing_type==="auction"?"Auction":s.listing_type==="offer_only"?"Offers Only":"Buy Now"}),e.jsxs("button",{onClick:p,className:d("px-2 py-0.5 text-xs font-medium rounded-full flex items-center gap-1",o?"bg-pink-500/20 text-pink-400":"bg-white/10 text-gray-400"),children:[o?e.jsx(l.HeartFilled,{className:"w-3 h-3"}):e.jsx(l.Heart,{className:"w-3 h-3"}),o?"Watching":"Watch"]})]}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:s.cosmetic_name||s.name}),e.jsx("p",{className:"text-gray-400 mb-4",children:s.cosmetic_description||s.description}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-xl mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-600 rounded-full flex items-center justify-center text-lg font-bold",children:(s.seller_username||"S")[0].toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.seller_username||"Seller"}),e.jsx("p",{className:"text-sm text-gray-400",children:s.seller_rating?`${s.seller_rating}% positive`:"New seller"})]})]}),e.jsxs("div",{className:"p-4 bg-white/5 rounded-xl mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400",children:s.listing_type==="auction"?"Current Bid":"Price"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l.Sparkle,{className:"text-violet-400"}),e.jsx("span",{className:"text-2xl font-bold",children:(s.price||0).toLocaleString()})]})]}),s.listing_type==="auction"&&e.jsxs("div",{className:"flex items-center justify-between mt-2 text-sm text-gray-400",children:[e.jsxs("span",{children:["Min bid increment: ",s.bid_increment]}),e.jsxs("span",{children:[s.bid_count||0," bids"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-xl mb-4",children:[e.jsx("span",{className:"text-gray-400",children:"Your Balance"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l.Sparkle,{className:"text-violet-400 w-4 h-4"}),e.jsx("span",{className:"font-bold",children:(c?.balance||0).toLocaleString()})]})]}),s.listing_type==="buy_now"&&e.jsxs("div",{className:"space-y-3",children:[f?e.jsx("button",{onClick:i,disabled:m,className:"w-full py-3 bg-green-600 hover:bg-green-700 disabled:opacity-50 rounded-xl font-semibold transition-all",children:m?"Processing...":`Buy Now for ${s.price.toLocaleString()}`}):e.jsxs("div",{className:"p-4 bg-red-500/10 border border-red-500/30 rounded-xl text-center",children:[e.jsx("p",{className:"text-red-400 font-medium",children:"Insufficient credits"}),e.jsxs("p",{className:"text-sm text-gray-400",children:["You need ",(s.price-(c?.balance||0)).toLocaleString()," more credits"]})]}),s.allow_offers&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>B(!y),className:"w-full py-3 bg-white/5 hover:bg-white/10 rounded-xl font-semibold transition-all",children:"Make an Offer"}),y&&e.jsxs("div",{className:"space-y-3 p-4 bg-white/5 rounded-xl",children:[e.jsx("input",{type:"number",placeholder:"Offer amount",value:x,onChange:b=>P(b.target.value),className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-violet-500"}),e.jsx("textarea",{placeholder:"Message (optional)",value:j,onChange:b=>O(b.target.value),rows:2,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-violet-500 resize-none"}),e.jsx("button",{onClick:u,disabled:m||!x,className:"w-full py-2 bg-violet-600 hover:bg-violet-700 disabled:opacity-50 rounded-lg font-semibold transition-all",children:m?"Submitting...":"Submit Offer"})]})]})]}),s.listing_type==="offer_only"&&e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"space-y-3 p-4 bg-white/5 rounded-xl",children:[e.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:["This item is only available via offers. Min offer: ",s.min_offer?.toLocaleString()||0]}),e.jsx("input",{type:"number",placeholder:"Offer amount",value:x,onChange:b=>P(b.target.value),min:s.min_offer||0,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-violet-500"}),e.jsx("textarea",{placeholder:"Message (optional)",value:j,onChange:b=>O(b.target.value),rows:2,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-violet-500 resize-none"}),e.jsx("button",{onClick:u,disabled:m||!x||parseInt(x)<(s.min_offer||0),className:"w-full py-3 bg-violet-600 hover:bg-violet-700 disabled:opacity-50 rounded-xl font-semibold transition-all",children:m?"Submitting...":"Submit Offer"})]})}),s.listing_type==="auction"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm text-gray-400",children:["Auction ends in ",X(s.expires_at)]}),e.jsx(g,{to:`/marketplace/auction/${s.id}`,className:"block w-full py-3 bg-amber-600 hover:bg-amber-700 rounded-xl font-semibold text-center transition-all",children:"View Auction & Place Bid"})]})]})]})}function X(s){if(!s)return null;const c=new Date,o=new Date(s)-c;if(o<=0)return"Ended";const p=Math.floor(o/(1e3*60*60*24)),i=Math.floor(o%(1e3*60*60*24)/(1e3*60*60)),u=Math.floor(o%(1e3*60*60)/(1e3*60));return p>0?`${p}d ${i}h`:i>0?`${i}h ${u}m`:`${u}m`}export{Le as default};
