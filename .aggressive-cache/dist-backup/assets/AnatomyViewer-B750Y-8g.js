import{r as i,j as e}from"./react-vendor-D847gc3Q.js";import{C as H,u as I}from"./react-three-fiber.esm-BEHpZAxY.js";import{C as A,M as L,a as B}from"./three-vendor-y9bq9ss_.js";import{a as w,C as T,O as _,u as $}from"./registry-jDNYOzK3.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./recharts-vendor-CxtoZpzE.js";import"./d3-vendor-mcDw60ct.js";function V(m,p,d={}){const{highlightColor:x=new A(65280),baseColor:l=new A(13395558),highlightOpacity:o=1,baseOpacity:h=.7,emissiveIntensity:a=.3}=d;i.useEffect(()=>{m.forEach((t,r)=>{const n=p.some(b=>r.toLowerCase().includes(b.toLowerCase())||b.toLowerCase().includes(r.toLowerCase()));t.material instanceof L&&(n?(t.material.color.copy(x),t.material.emissive.copy(x),t.material.emissiveIntensity=a,t.material.opacity=o):(t.material.color.copy(l),t.material.emissive.setHex(0),t.material.emissiveIntensity=0,t.material.opacity=h),t.material.needsUpdate=!0)})},[m,p,x,l,o,h,a])}function q({filePath:m,asset:p,autoRotate:d,highlightedMuscles:x,onMeshClick:l,onMeshHover:o}){const h=i.useRef(null),a=i.useRef(new Map),{scene:t}=$(m);return i.useEffect(()=>{t&&(a.current.clear(),t.traverse(r=>{r instanceof B&&(a.current.set(r.name,r),r.material instanceof L&&(r.material=r.material.clone(),r.material.transparent=!0))}))},[t]),V(a.current,x),I((r,n)=>{d&&h.current&&(h.current.rotation.y+=n*.2)}),e.jsx("group",{ref:h,children:e.jsx("primitive",{object:t,scale:.01,position:[0,-1,0],onClick:r=>{r.stopPropagation();const n=r.object;n.name&&l&&l(n.name)},onPointerOver:r=>{r.stopPropagation();const n=r.object;n.name&&o&&(o(n.name),document.body.style.cursor="pointer")},onPointerOut:()=>{o?.(null),document.body.style.cursor="auto"}})})}function Q(){return e.jsxs("mesh",{children:[e.jsx("boxGeometry",{args:[.5,1,.3]}),e.jsx("meshStandardMaterial",{color:"#333",wireframe:!0})]})}function U({assetKey:m,lod:p="low",autoRotate:d=!1,showControls:x=!0,highlightedMuscles:l=[],onMeshClick:o,onMeshHover:h,className:a="",style:t}){const[r,n]=i.useState(null),b=m||"male_muscles",u=w.getAsset(b),v=u?w.getFilePath(u,p):null;return u?v?error?e.jsx("div",{className:`flex items-center justify-center bg-gray-900 text-red-400 ${a}`,style:t,children:e.jsxs("p",{children:["Error loading model: ",error]})}):e.jsx("div",{className:`w-full h-full ${a}`,style:t,children:e.jsxs(H,{camera:{position:[0,0,3],fov:45},dpr:[1,2],gl:{antialias:!0,alpha:!0,powerPreference:"high-performance"},onCreated:({gl:y})=>{y.setClearColor(0,0)},children:[e.jsx("ambientLight",{intensity:.5}),e.jsx("directionalLight",{position:[5,5,5],intensity:.8}),e.jsx("directionalLight",{position:[-5,5,-5],intensity:.4}),e.jsx("pointLight",{position:[0,10,0],intensity:.3}),e.jsxs(i.Suspense,{fallback:e.jsx(Q,{}),children:[e.jsx(q,{filePath:v,asset:u,autoRotate:d,highlightedMuscles:l,onMeshClick:o,onMeshHover:h}),e.jsx(T,{position:[0,-1.5,0],opacity:.4,scale:10,blur:2})]}),x&&e.jsx(_,{enablePan:!1,minDistance:1,maxDistance:10,minPolarAngle:0,maxPolarAngle:Math.PI})]})}):e.jsx("div",{className:`flex items-center justify-center bg-gray-900 text-red-400 ${a}`,style:t,children:e.jsxs("p",{children:["No ",p," LOD available for this asset"]})}):e.jsx("div",{className:`flex items-center justify-center bg-gray-900 text-red-400 ${a}`,style:t,children:e.jsxs("p",{children:["Asset not found: ",b]})})}const M={chest:["Pectoralis major.l","Pectoralis major.r","Pectoralis minor.l","Pectoralis minor.r"],back:["Latissimus dorsi.l","Latissimus dorsi.r","Trapezius.l","Trapezius.r","Rhomboid major.l","Rhomboid major.r"],shoulders:["Deltoid.l","Deltoid.r","Acromial part of deltoid muscle.l","Acromial part of deltoid muscle.r"],arms:["Biceps brachii.l","Biceps brachii.r","Triceps brachii.l","Triceps brachii.r","Brachialis.l","Brachialis.r"],forearms:["Brachioradialis.l","Brachioradialis.r","Pronator teres.l","Pronator teres.r"],core:["Rectus abdominis.l","Rectus abdominis.r","External oblique muscle.l","External oblique muscle.r","Internal oblique muscle.l","Internal oblique muscle.r"],legs:["Quadriceps femoris.l","Quadriceps femoris.r","Rectus femoris.l","Rectus femoris.r","Vastus lateralis.l","Vastus lateralis.r","Vastus medialis.l","Vastus medialis.r","Biceps femoris.l","Biceps femoris.r","Semitendinosus.l","Semitendinosus.r","Semimembranosus.l","Semimembranosus.r"],glutes:["Gluteus maximus.l","Gluteus maximus.r","Gluteus medius.l","Gluteus medius.r","Gluteus minimus.l","Gluteus minimus.r"],calves:["Gastrocnemius.l","Gastrocnemius.r","Soleus.l","Soleus.r","Tibialis anterior.l","Tibialis anterior.r"]};function Z(){const[m,p]=i.useState("low"),[d,x]=i.useState(!0),[l,o]=i.useState([]),[h,a]=i.useState([]),[t,r]=i.useState(null),[n,b]=i.useState(null),[u,v]=i.useState(""),y=i.useMemo(()=>w.listAssets(),[]),[g,P]=i.useState(y[0]?.key||"male_muscles"),N=i.useMemo(()=>w.getMuscleNames(g),[g]),k=i.useMemo(()=>{if(!u)return N.slice(0,50);const s=u.toLowerCase();return N.filter(c=>c.toLowerCase().includes(s)).slice(0,50)},[N,u]),G=i.useCallback(s=>{a(c=>{if(c.includes(s)){const j=c.filter(f=>f!==s),S=M[s]||[];return o(f=>f.filter(E=>!S.includes(E))),j}else{const j=[...c,s],S=M[s]||[];return o(f=>[...new Set([...f,...S])]),j}})},[]),C=i.useCallback(s=>{o(c=>c.includes(s)?c.filter(j=>j!==s):[...c,s])},[]),R=i.useCallback(()=>{o([]),a([])},[]),O=i.useCallback(s=>{b(s),C(s)},[C]);return e.jsxs("div",{className:"min-h-screen bg-[#0a0a0f] text-white",children:[e.jsx("div",{className:"border-b border-white/10 bg-black/40 backdrop-blur-xl",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Anatomy Model Viewer"}),e.jsx("p",{className:"text-sm text-white/60",children:"Development tool for testing 3D anatomy models"})]}),e.jsx("a",{href:"/dashboard",className:"px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors",children:"Back to Dashboard"})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-black/40 rounded-xl border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"h-[600px]",children:e.jsx(U,{assetKey:g,lod:m,autoRotate:d,highlightedMuscles:l,onMeshClick:O,onMeshHover:r,className:"w-full h-full"})}),e.jsxs("div",{className:"p-4 border-t border-white/10 bg-black/20",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-white/60 mb-1",children:"Asset"}),e.jsx("select",{value:g,onChange:s=>P(s.target.value),className:"bg-white/10 border border-white/20 rounded px-3 py-1.5 text-sm",children:y.map(({key:s,asset:c})=>e.jsxs("option",{value:s,children:[c.id," (",c.type,")"]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-white/60 mb-1",children:"Quality (LOD)"}),e.jsx("div",{className:"flex gap-1",children:["low","medium","high"].map(s=>e.jsx("button",{onClick:()=>p(s),className:`px-3 py-1.5 text-sm rounded transition-colors ${m===s?"bg-violet-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-white/60 mb-1",children:"Auto Rotate"}),e.jsx("button",{onClick:()=>x(!d),className:`px-3 py-1.5 text-sm rounded transition-colors ${d?"bg-green-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:d?"On":"Off"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-white/60 mb-1",children:"Highlights"}),e.jsxs("button",{onClick:R,className:"px-3 py-1.5 text-sm rounded bg-red-600/20 hover:bg-red-600/40 text-red-400 transition-colors",children:["Clear All (",l.length,")"]})]})]}),(t||n)&&e.jsxs("div",{className:"mt-4 p-3 bg-white/5 rounded-lg",children:[t&&e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-white/60",children:"Hovering:"})," ",e.jsx("span",{className:"text-violet-400",children:t})]}),n&&e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-white/60",children:"Last Clicked:"})," ",e.jsx("span",{className:"text-green-400",children:n})]})]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-black/40 rounded-xl border border-white/10 p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Muscle Groups"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.keys(M).map(s=>e.jsx("button",{onClick:()=>G(s),className:`px-3 py-2 text-sm rounded-lg transition-colors ${h.includes(s)?"bg-violet-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]}),e.jsxs("div",{className:"bg-black/40 rounded-xl border border-white/10 p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Individual Muscles"}),e.jsx("input",{type:"text",value:u,onChange:s=>v(s.target.value),placeholder:"Search muscles...",className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-sm mb-3"}),e.jsxs("div",{className:"max-h-64 overflow-y-auto space-y-1",children:[k.map(s=>e.jsx("button",{onClick:()=>C(s),className:`w-full text-left px-3 py-1.5 text-xs rounded transition-colors ${l.includes(s)?"bg-violet-600/40 text-violet-200":"bg-white/5 hover:bg-white/10"}`,children:s},s)),k.length===0&&e.jsx("p",{className:"text-sm text-white/40 text-center py-4",children:"No muscles found"})]}),e.jsxs("p",{className:"text-xs text-white/40 mt-2",children:["Showing ",k.length," of ",N.length," muscles"]})]}),l.length>0&&e.jsxs("div",{className:"bg-black/40 rounded-xl border border-white/10 p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-3",children:["Highlighted (",l.length,")"]}),e.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:l.map(s=>e.jsxs("div",{className:"flex items-center justify-between px-2 py-1 bg-violet-600/20 rounded",children:[e.jsx("span",{className:"text-xs text-violet-200 truncate",children:s}),e.jsx("button",{onClick:()=>C(s),className:"text-violet-400 hover:text-red-400 ml-2",children:"Ã—"})]},s))})]}),e.jsxs("div",{className:"bg-black/40 rounded-xl border border-white/10 p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Asset Info"}),(()=>{const s=w.getAsset(g);return s?e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-white/60",children:"ID:"})," ",s.id]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-white/60",children:"Type:"})," ",s.type]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-white/60",children:"Sex:"})," ",s.sex]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-white/60",children:"Meshes:"})," ",s.metadata.meshCount]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-white/60",children:"Triangles (high):"})," ",s.metadata.triangleCount.high?.toLocaleString()]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-white/60",children:"License:"})," ",e.jsx("a",{href:s.license.url,target:"_blank",rel:"noopener noreferrer",className:"text-violet-400 hover:underline",children:s.license.spdxId})]}),e.jsx("p",{className:"text-xs text-white/40 mt-2",children:s.license.attribution})]}):e.jsx("p",{className:"text-sm text-white/40",children:"Asset not found"})})()]})]})]})})]})}export{Z as default};
