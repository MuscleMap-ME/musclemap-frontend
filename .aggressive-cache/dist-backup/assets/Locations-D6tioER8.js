import{j as e,r as l,L as J}from"./react-vendor-D1NxaRNd.js";import{y as U}from"./index-ChmNk_hk.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./apollo-vendor-BMQ75Ycx.js";import"./reactflow-vendor-Dz2P_-Qa.js";import"./d3-vendor-mcDw60ct.js";import"./recharts-vendor-BziRPEEi.js";const _=({hangout:a,onJoin:n,onClick:h,isJoined:x=!1,className:y=""})=>{const c=a.memberAvatars?.slice(0,3)||[],p=a.members-c.length;return e.jsxs("div",{className:`rounded-2xl bg-slate-800/50 border border-slate-700/50 p-4 hover:border-slate-600 transition-all ${h?"cursor-pointer":""} ${y}`,onClick:()=>h?.(a),children:[e.jsxs("div",{className:"flex items-start gap-4 mb-3",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-gradient-to-br from-teal-500/20 to-blue-500/20 flex items-center justify-center text-2xl flex-shrink-0",children:"ðŸƒ"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-white truncate",children:a.name}),e.jsxs("p",{className:"text-sm text-slate-400",children:["ðŸ“ ",a.location," â€¢ ",a.distance]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx("span",{className:"px-2 py-1 rounded-lg bg-slate-700/50 text-slate-300 text-sm",children:a.activity}),e.jsxs("span",{className:"px-2 py-1 rounded-lg bg-slate-700/50 text-slate-300 text-sm",children:["â° ",a.time]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex -space-x-2",children:c.length>0?c.map((t,d)=>e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-slate-600 to-slate-700 border-2 border-slate-800 flex items-center justify-center text-xs text-white font-medium",children:t},d)):Array.from({length:Math.min(a.members,3)}).map((t,d)=>e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-slate-600 to-slate-700 border-2 border-slate-800 flex items-center justify-center text-xs text-white font-medium",children:String.fromCharCode(65+d)},d))}),e.jsx("span",{className:"text-sm text-slate-400",children:p>0?`+${p} more`:`${a.members} member${a.members!==1?"s":""}`})]}),n&&e.jsx("button",{onClick:t=>{t.stopPropagation(),n(a)},className:`px-4 py-2 rounded-xl font-medium text-sm transition-all ${x?"bg-slate-700 text-slate-400 cursor-default":"bg-teal-500 text-white hover:bg-teal-400"}`,disabled:x,children:x?"Joined":"Join"})]})]})},S=[{id:"gym",name:"Gym",icon:"ðŸ‹ï¸"},{id:"park",name:"Park",icon:"ðŸŒ³"},{id:"outdoor",name:"Outdoor",icon:"ðŸŒ„"},{id:"studio",name:"Studio",icon:"ðŸ§˜"},{id:"home",name:"Home",icon:"ðŸ "}];function Y(){const{token:a}=U(),[n,h]=l.useState("nearby"),[x,y]=l.useState([]),[c,p]=l.useState(null),[t,d]=l.useState(null),[R,f]=l.useState(!1),[k,F]=l.useState(""),[m,A]=l.useState(null),[o,O]=l.useState(null),[D,j]=l.useState(!1),[r,u]=l.useState({name:"",type:"gym",city:"",description:""}),[E,N]=l.useState(!1),[g,T]=l.useState({rating:5,safety_rating:5,crowd_level:3,cleanliness:5,comment:""}),v={"Content-Type":"application/json",Authorization:"Bearer "+a};l.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(s=>O({lat:s.coords.latitude,lng:s.coords.longitude}),()=>{})},[]),l.useEffect(()=>{n==="nearby"&&o?M():n==="search"&&w()},[n,o,m]);const M=async()=>{if(!o)return;f(!0);const s="/api/locations/nearby?lat="+o.lat+"&lng="+o.lng+(m?"&type="+m:""),i=await fetch(s).then(b=>b.json());y(i.locations||[]),f(!1)},w=async()=>{f(!0);const s="/api/locations/search?q="+encodeURIComponent(k)+(m?"&type="+m:""),i=await fetch(s).then(b=>b.json());y(i.locations||[]),f(!1)},C=async s=>{const i=await fetch("/api/locations/"+s).then(b=>b.json());d(i),p(s)},P=async()=>{if(!r.name)return alert("Name required");const s={...r};o&&(s.lat=o.lat,s.lng=o.lng),await fetch("/api/locations",{method:"POST",headers:v,body:JSON.stringify(s)}),j(!1),u({name:"",type:"gym",city:"",description:""}),w()},$=async()=>{await fetch("/api/locations/"+c+"/rate",{method:"POST",headers:v,body:JSON.stringify(g)}),N(!1),C(c)},L=async(s,i)=>{await fetch("/api/locations/comment/"+s+"/vote",{method:"POST",headers:v,body:JSON.stringify({vote:i})}),C(c)},z=s=>S.find(i=>i.id===s)?.icon||"ðŸ“";return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white pb-24",children:[e.jsx("header",{className:"bg-gray-800 p-4 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[e.jsx(J,{to:"/dashboard",className:"text-blue-400",children:"â† Back"}),e.jsx("h1",{className:"text-xl font-bold",children:"ðŸ“ Locations"}),e.jsx("button",{onClick:()=>j(!0),className:"bg-green-600 px-3 py-1 rounded",children:"+ Add"})]})}),e.jsxs("main",{className:"max-w-4xl mx-auto p-4",children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>h("nearby"),className:"px-4 py-2 rounded-full "+(n==="nearby"?"bg-purple-600":"bg-gray-700"),children:"ðŸ“ Nearby"}),e.jsx("button",{onClick:()=>h("search"),className:"px-4 py-2 rounded-full "+(n==="search"?"bg-purple-600":"bg-gray-700"),children:"ðŸ” Search"})]}),n==="search"&&e.jsx("input",{type:"text",placeholder:"Search by name or city...",value:k,onChange:s=>F(s.target.value),onKeyUp:s=>s.key==="Enter"&&w(),className:"w-full bg-gray-800 p-3 rounded-xl mb-4"}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-4 mb-4",children:[e.jsx("button",{onClick:()=>A(null),className:"px-3 py-1 rounded-full whitespace-nowrap "+(m?"bg-gray-700":"bg-purple-600"),children:"All"}),S.map(s=>e.jsxs("button",{onClick:()=>A(s.id),className:"px-3 py-1 rounded-full whitespace-nowrap "+(m===s.id?"bg-purple-600":"bg-gray-700"),children:[s.icon," ",s.name]},s.id))]}),n==="nearby"&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-3",children:"Upcoming Hangouts"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(_,{hangout:{id:"demo-1",name:"Morning Leg Day",location:"Iron Fitness Gym, Downtown",distance:"0.5 mi",members:5,activity:"Strength Training",time:"Tomorrow, 7:00 AM",memberAvatars:["JD","MK"]},onJoin:()=>{}}),e.jsx(_,{hangout:{id:"demo-2",name:"CrossFit WOD",location:"CrossFit Box, Midtown",distance:"1.2 mi",members:8,activity:"CrossFit",time:"Saturday, 9:00 AM",memberAvatars:["TR","AK"]},onJoin:()=>{}})]})]}),R?e.jsx("div",{className:"text-center py-8",children:"Loading..."}):e.jsxs("div",{className:"space-y-3",children:[x.length===0&&e.jsx("div",{className:"text-center text-gray-400 py-8",children:n==="nearby"&&!o?"Enable location to see nearby spots":"No locations found"}),x.map(s=>e.jsx("div",{onClick:()=>C(s.id),className:"bg-gray-800 rounded-2xl p-4 cursor-pointer hover:bg-gray-700 "+(c===s.id?"ring-2 ring-purple-500":""),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:z(s.type)}),e.jsx("span",{className:"font-bold",children:s.name})]}),e.jsx("div",{className:"text-sm text-gray-400",children:s.city})]}),s.avg_rating&&e.jsxs("div",{className:"text-yellow-400",children:["â­ ",Number(s.avg_rating).toFixed(1)]})]})},s.id))]}),t&&c&&e.jsxs("div",{className:"mt-6 bg-gray-800 rounded-2xl p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:t.location?.name}),e.jsx("button",{onClick:()=>{p(null),d(null)},className:"text-gray-400",children:"âœ•"})]}),t.ratings&&e.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-4",children:[e.jsxs("div",{className:"bg-gray-700 p-2 rounded text-center",children:[e.jsx("div",{className:"text-yellow-400 font-bold",children:t.ratings.avg_rating?.toFixed(1)||"-"}),e.jsx("div",{className:"text-xs text-gray-400",children:"Rating"})]}),e.jsxs("div",{className:"bg-gray-700 p-2 rounded text-center",children:[e.jsx("div",{className:"text-green-400 font-bold",children:t.ratings.avg_safety?.toFixed(1)||"-"}),e.jsx("div",{className:"text-xs text-gray-400",children:"Safety"})]}),e.jsxs("div",{className:"bg-gray-700 p-2 rounded text-center",children:[e.jsx("div",{className:"text-orange-400 font-bold",children:t.ratings.avg_crowd?.toFixed(1)||"-"}),e.jsx("div",{className:"text-xs text-gray-400",children:"Crowd"})]}),e.jsxs("div",{className:"bg-gray-700 p-2 rounded text-center",children:[e.jsx("div",{className:"text-blue-400 font-bold",children:t.ratings.avg_clean?.toFixed(1)||"-"}),e.jsx("div",{className:"text-xs text-gray-400",children:"Clean"})]})]}),t.amenities?.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Amenities"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.amenities.map(s=>e.jsx("span",{className:"bg-gray-600 px-2 py-1 rounded text-sm",children:s.amenity},s.amenity))})]}),t.comments?.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Tips & Reviews"}),t.comments.map(s=>e.jsxs("div",{className:"bg-gray-700 p-3 rounded-xl mb-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-400",children:s.username||"Anon"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("button",{onClick:()=>L(s.id,1),className:"text-green-400",children:"â–²"}),e.jsx("span",{children:s.upvotes}),e.jsx("button",{onClick:()=>L(s.id,-1),className:"text-red-400",children:"â–¼"})]})]}),e.jsx("div",{className:"mt-1",children:s.comment})]},s.id))]}),e.jsx("button",{onClick:()=>N(!0),className:"w-full bg-purple-600 py-3 rounded-xl font-bold",children:"â­ Rate This Spot"})]})]}),D&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Location"}),e.jsx("input",{placeholder:"Name",value:r.name,onChange:s=>u({...r,name:s.target.value}),className:"w-full bg-gray-700 p-3 rounded-xl mb-3"}),e.jsx("input",{placeholder:"City",value:r.city,onChange:s=>u({...r,city:s.target.value}),className:"w-full bg-gray-700 p-3 rounded-xl mb-3"}),e.jsx("select",{value:r.type,onChange:s=>u({...r,type:s.target.value}),className:"w-full bg-gray-700 p-3 rounded-xl mb-3",children:S.map(s=>e.jsxs("option",{value:s.id,children:[s.icon," ",s.name]},s.id))}),e.jsx("textarea",{placeholder:"Description",value:r.description,onChange:s=>u({...r,description:s.target.value}),className:"w-full bg-gray-700 p-3 rounded-xl mb-3 h-20"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>j(!1),className:"flex-1 bg-gray-600 py-3 rounded-xl",children:"Cancel"}),e.jsx("button",{onClick:P,className:"flex-1 bg-green-600 py-3 rounded-xl font-bold",children:"Add"})]})]})}),E&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Rate This Spot"}),["rating","safety_rating","crowd_level","cleanliness"].map(s=>e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"text-sm text-gray-400 capitalize",children:s.replace("_"," ")}),e.jsx("input",{type:"range",min:"1",max:"5",value:g[s],onChange:i=>T({...g,[s]:Number(i.target.value)}),className:"w-full"}),e.jsxs("div",{className:"text-center",children:[g[s]," / 5"]})]},s)),e.jsx("textarea",{placeholder:"Add a tip or comment...",value:g.comment,onChange:s=>T({...g,comment:s.target.value}),className:"w-full bg-gray-700 p-3 rounded-xl mb-3 h-20"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>N(!1),className:"flex-1 bg-gray-600 py-3 rounded-xl",children:"Cancel"}),e.jsx("button",{onClick:$,className:"flex-1 bg-purple-600 py-3 rounded-xl font-bold",children:"Submit"})]})]})})]})}export{Y as default};
