import{d as W,r as o,j as e,L as u}from"./react-vendor-D1NxaRNd.js";import{c}from"./recharts-vendor-BziRPEEi.js";import{y as z,m as y}from"./index-VPOrxyVC.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./d3-vendor-mcDw60ct.js";import"./apollo-vendor-D9c7jRvS.js";import"./reactflow-vendor-Dz2P_-Qa.js";const n={Back:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 19l-7-7 7-7"})}),Check:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),Clock:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),X:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})}),Eye:()=>e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),User:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),Trash:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Shield:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})},d={bronze:{label:"Bronze",color:"bg-amber-700/20 text-amber-500 border-amber-700/30"},silver:{label:"Silver",color:"bg-gray-400/20 text-gray-400 border-gray-400/30"},gold:{label:"Gold",color:"bg-amber-400/20 text-amber-400 border-amber-400/30"},platinum:{label:"Platinum",color:"bg-cyan-400/20 text-cyan-400 border-cyan-400/30"},diamond:{label:"Diamond",color:"bg-violet-400/20 text-violet-400 border-violet-400/30"}},w={pending_witness:{label:"Awaiting Witness",color:"bg-yellow-500/20 text-yellow-400",icon:n.Clock},verified:{label:"Verified",color:"bg-green-500/20 text-green-400",icon:n.Check},rejected:{label:"Rejected",color:"bg-red-500/20 text-red-400",icon:n.X},expired:{label:"Expired",color:"bg-gray-500/20 text-gray-400",icon:n.Clock}},f=a=>{try{return new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return a}},v=a=>{const i=new Date,x=new Date(a),l=Math.ceil((x-i)/(1e3*60*60*24));return l<=0?"Expired":l===1?"1 day left":`${l} days left`};function _(){const{token:a}=z();W();const[i,x]=o.useState("my"),[l,p]=o.useState([]),[m,N]=o.useState([]),[k,C]=o.useState(!0),[b,j]=o.useState(null);o.useEffect(()=>{L()},[]);const L=async()=>{try{const s={Authorization:`Bearer ${a}`},[r,t]=await Promise.all([fetch("/api/me/verifications",{headers:s}),fetch("/api/me/witness-requests",{headers:s})]),[h,B]=await Promise.all([r.json(),t.json()]);p(h.data||[]),N(B.data||[])}catch{}finally{C(!1)}},A=async s=>{if(confirm("Are you sure you want to cancel this verification request?")){j(s);try{await fetch(`/api/verifications/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}}),p(l.filter(r=>r.id!==s))}catch{}finally{j(null)}}};if(k)return e.jsx("div",{className:"min-h-screen bg-[#0a0a0f] flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-violet-500 border-t-transparent rounded-full animate-spin"})});const g=m.filter(s=>s.witness?.status==="pending").length;return e.jsxs("div",{className:"min-h-screen bg-[#0a0a0f] text-white pb-8",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-[#0a0a0f]/80 backdrop-blur-xl border-b border-white/5",children:e.jsx("div",{className:"max-w-3xl mx-auto px-4 h-16 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{to:"/achievements",className:"p-2 -ml-2 rounded-xl hover:bg-white/5",children:e.jsx(n.Back,{})}),e.jsx("h1",{className:"text-xl font-semibold",children:"Verifications"})]})})}),e.jsxs("main",{className:"max-w-3xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsx("button",{onClick:()=>x("my"),className:c("flex-1 py-3 px-4 rounded-xl font-medium transition-colors",i==="my"?"bg-violet-600 text-white":"bg-white/5 text-gray-400 hover:bg-white/10"),children:"My Submissions"}),e.jsxs("button",{onClick:()=>x("witness"),className:c("flex-1 py-3 px-4 rounded-xl font-medium transition-colors relative",i==="witness"?"bg-violet-600 text-white":"bg-white/5 text-gray-400 hover:bg-white/10"),children:["Witness Requests",g>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full text-xs flex items-center justify-center",children:g})]})]}),i==="my"&&e.jsx("div",{className:"space-y-4",children:l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx(n.Shield,{})}),e.jsx("p",{className:"text-gray-400 mb-4",children:"No verification submissions yet"}),e.jsx(u,{to:"/achievements",className:"inline-block px-6 py-3 bg-violet-600 rounded-xl hover:bg-violet-500 transition-colors",children:"Browse Achievements"})]}):l.map(s=>{const r=d[s.achievementTier]||d.bronze,t=w[s.status]||w.pending_witness,h=t.icon;return e.jsxs(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-[#1a1a2e] rounded-xl p-4 border border-white/5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:c("text-xs px-2 py-0.5 rounded border",r.color),children:d[s.achievementTier]?.label||"Bronze"}),e.jsx("h3",{className:"text-lg font-semibold mt-1",children:s.achievementName})]}),e.jsxs("span",{className:c("flex items-center gap-1 text-xs px-2 py-1 rounded",t.color),children:[e.jsx(h,{}),t.label]})]}),s.witness&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mb-3",children:[e.jsx(n.User,{}),e.jsxs("span",{children:["Witness: @",s.witness.witnessUsername||"Unknown",s.witness.status==="pending"&&e.jsx("span",{className:"text-yellow-400 ml-2",children:"• Waiting for response"}),s.witness.status==="confirmed"&&e.jsx("span",{className:"text-green-400 ml-2",children:"• Confirmed"})]})]}),s.videoUrl&&e.jsx("div",{className:"mb-3",children:e.jsx("video",{src:s.videoUrl,className:"w-full max-h-48 rounded-lg bg-black",controls:!0})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("span",{children:["Submitted ",f(s.submittedAt)]}),s.status==="pending_witness"&&e.jsx("span",{className:"text-yellow-400",children:v(s.expiresAt)})]}),s.status==="pending_witness"&&e.jsx("div",{className:"mt-4 pt-4 border-t border-white/5",children:e.jsxs("button",{onClick:()=>A(s.id),disabled:b===s.id,className:"flex items-center gap-2 text-sm text-red-400 hover:text-red-300",children:[b===s.id?e.jsx("div",{className:"w-4 h-4 border-2 border-red-400 border-t-transparent rounded-full animate-spin"}):e.jsx(n.Trash,{}),"Cancel Request"]})})]},s.id)})}),i==="witness"&&e.jsx("div",{className:"space-y-4",children:m.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx(n.Eye,{})}),e.jsx("p",{className:"text-gray-400",children:"No witness requests"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"When someone asks you to verify their achievement, it will appear here."})]}):m.map(s=>{const r=d[s.achievementTier]||d.bronze,t=s.witness?.status==="pending";return e.jsxs(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:c("bg-[#1a1a2e] rounded-xl p-4 border",t?"border-violet-500/30":"border-white/5"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:c("text-xs px-2 py-0.5 rounded border",r.color),children:d[s.achievementTier]?.label||"Bronze"}),e.jsx("h3",{className:"text-lg font-semibold mt-1",children:s.achievementName})]}),t&&e.jsx("span",{className:"text-xs px-2 py-1 bg-yellow-500/20 text-yellow-400 rounded",children:"Action Required"})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-violet-500/20 flex items-center justify-center",children:s.avatarUrl?e.jsx("img",{src:s.avatarUrl,alt:"",className:"w-full h-full rounded-full"}):e.jsx(n.User,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.displayName||s.username}),e.jsxs("p",{className:"text-sm text-gray-400",children:["@",s.username]})]})]}),s.videoUrl&&e.jsx("div",{className:"mb-3",children:e.jsx("video",{src:s.videoUrl,className:"w-full max-h-48 rounded-lg bg-black",controls:!0})}),s.notes&&e.jsxs("p",{className:"text-sm text-gray-400 mb-3 bg-white/5 rounded-lg p-3",children:['"',s.notes,'"']}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[e.jsxs("span",{children:["Requested ",f(s.submittedAt)]}),t&&e.jsx("span",{className:"text-yellow-400",children:v(s.expiresAt)})]}),t&&e.jsx("div",{className:"flex gap-3",children:e.jsx(u,{to:`/verifications/${s.id}/witness`,className:"flex-1 py-3 bg-violet-600 text-center rounded-xl font-medium hover:bg-violet-500 transition-colors",children:"Review & Respond"})})]},s.id)})})]})]})}export{_ as default};
