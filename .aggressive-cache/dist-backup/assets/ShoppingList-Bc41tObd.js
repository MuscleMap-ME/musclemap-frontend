import{l as Z,r as b,a as F,j as e,L as V}from"./react-vendor-D847gc3Q.js";import{G as g}from"./GlassSurface-CuHevRGA.js";import{G as v}from"./GlassButton-Bs2TSsLg.js";import{G as I}from"./GlassNav-BklnGJvT.js";import{G,a as O}from"./GlassMobileNav-yj1ol6Oo.js";import{M as P}from"./MeshBackground-BlECXEOF.js";import{g as W}from"./useNutrition-Yh3meWce.js";import{A as H}from"./arrow-left-BMhOQ8O4.js";import{S as Q}from"./share-2-UtZ2i38P.js";import{c as k,m as C,S as U,ab as Y,A as J}from"./index-CNQdMB_L.js";import{R as A}from"./refresh-cw-qihnzhKo.js";import{C as E}from"./check-DA8aN32j.js";import{S as R}from"./shopping-cart-Y8DcAuf8.js";import{P as K}from"./package-B0c0C1Yx.js";import{C as X}from"./chevron-up-DSWeysIq.js";import{C as q}from"./chevron-down-DBQBFo4Q.js";import{T as ee}from"./trash-2-DL3RdFof.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./recharts-vendor-CxtoZpzE.js";import"./d3-vendor-mcDw60ct.js";import"./nutritionStore-LnFmFNF2.js";import"./apollo-vendor-BNHFeEEc.js";import"./reactflow-vendor-CYb5nRwM.js";const te=[["path",{d:"M16.4 13.7A6.5 6.5 0 1 0 6.28 6.6c-1.1 3.13-.78 3.9-3.18 6.08A3 3 0 0 0 5 18c4 0 8.4-1.8 11.4-4.3",key:"cisjcv"}],["path",{d:"m18.5 6 2.19 4.5a6.48 6.48 0 0 1-2.29 7.2C15.4 20.2 11 22 7 22a3 3 0 0 1-2.68-1.66L2.4 16.5",key:"5byaag"}],["circle",{cx:"12.5",cy:"8.5",r:"2.5",key:"9738u8"}]],se=k("beef",te);const ae=[["path",{d:"M12 2C8 2 4 8 4 14a8 8 0 0 0 16 0c0-6-4-12-8-12",key:"1le142"}]],ne=k("egg",ae);const ie=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],re=k("printer",ie);const oe=[["path",{d:"M2 22 16 8",key:"60hf96"}],["path",{d:"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1rdhi6"}],["path",{d:"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1sdzmb"}],["path",{d:"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"eoatbi"}],["path",{d:"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z",key:"19rau1"}],["path",{d:"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"tc8ph9"}],["path",{d:"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"2m8kc5"}],["path",{d:"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"vex3ng"}]],ce=k("wheat",oe),_={Produce:{icon:Y,color:"text-green-400",bg:"bg-green-500/20"},"Meat & Seafood":{icon:se,color:"text-red-400",bg:"bg-red-500/20"},"Dairy & Eggs":{icon:ne,color:"text-yellow-400",bg:"bg-yellow-500/20"},"Grains & Bread":{icon:ce,color:"text-amber-400",bg:"bg-amber-500/20"},"Canned & Dry Goods":{icon:K,color:"text-orange-400",bg:"bg-orange-500/20"},"Spices & Condiments":{icon:U,color:"text-purple-400",bg:"bg-purple-500/20"},Other:{icon:R,color:"text-gray-400",bg:"bg-gray-500/20"}};function le({category:t,items:i,onToggleItem:c,onDeleteItem:f,defaultExpanded:d=!0}){const[o,u]=b.useState(d),N=_[t]||_.Other,j=N.icon,w=i.filter(l=>l.checked).length,h=i.length;return e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{onClick:()=>u(!o),className:"w-full flex items-center justify-between p-4 bg-white/5 rounded-xl hover:bg-white/10 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl ${N.bg} flex items-center justify-center`,children:e.jsx(j,{className:`w-5 h-5 ${N.color}`})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-white font-medium",children:t}),e.jsxs("p",{className:"text-xs text-gray-400",children:[w," of ",h," items"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[w===h&&h>0&&e.jsx("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 text-xs rounded-full",children:"Complete"}),o?e.jsx(X,{className:"w-5 h-5 text-gray-400"}):e.jsx(q,{className:"w-5 h-5 text-gray-400"})]})]}),e.jsx(J,{children:o&&e.jsx(C.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsx("div",{className:"py-2 space-y-1",children:i.map((l,x)=>e.jsx(de,{item:l,onToggle:()=>c(t,x),onDelete:()=>f(t,x)},`${l.name}-${x}`))})})})]})}function de({item:t,onToggle:i,onDelete:c}){return e.jsxs(C.div,{layout:!0,initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:`flex items-center justify-between p-3 rounded-lg hover:bg-white/5 transition-colors group ${t.checked?"opacity-60":""}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("button",{onClick:i,className:"flex-shrink-0 w-6 h-6 rounded border border-white/20 flex items-center justify-center hover:border-green-400 transition-colors",children:t.checked&&e.jsx(E,{className:"w-4 h-4 text-green-400"})}),e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx("p",{className:`text-white truncate ${t.checked?"line-through text-gray-400":""}`,children:t.name})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm text-gray-400 whitespace-nowrap",children:[S(t.quantity)," ",t.unit]}),e.jsx("button",{onClick:c,className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-red-500/20 rounded transition-all",children:e.jsx(ee,{className:"w-4 h-4 text-red-400"})})]})]})}function S(t){if(t===Math.floor(t))return t.toString();const i={.25:"1/4",.33:"1/3",.5:"1/2",.67:"2/3",.75:"3/4"},c=t-Math.floor(t),f=Math.floor(t);for(const[d,o]of Object.entries(i))if(Math.abs(c-parseFloat(d))<.05)return f>0?`${f} ${o}`:o;return t.toFixed(1)}function he({checked:t,total:i}){const c=i>0?Math.round(t/i*100):0;return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Shopping Progress"}),e.jsxs("span",{className:"text-sm text-white font-medium",children:[c,"% complete"]})]}),e.jsx("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:e.jsx(C.div,{className:"h-full bg-gradient-to-r from-green-500 to-emerald-400 rounded-full",initial:{width:0},animate:{width:`${c}%`},transition:{duration:.5,ease:"easeOut"}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[t," of ",i," items checked off"]})]})}function _e(){const{planId:t}=Z(),{getShoppingList:i,generateShoppingList:c,isLoading:f}=W(),[d,o]=b.useState([]),[u,N]=b.useState(""),[j,w]=b.useState(!1),h=F.useMemo(()=>{const s={};for(const a of d){const n=a.category||"Other";s[n]||(s[n]=[]),s[n].push(a)}return["Produce","Meat & Seafood","Dairy & Eggs","Grains & Bread","Canned & Dry Goods","Spices & Condiments","Other"].filter(a=>s[a]).map(a=>({category:a,items:s[a]}))},[d]),l=d.length,x=d.filter(s=>s.checked).length,$=b.useCallback(async()=>{if(t)try{const s=await i(t);o(s.shoppingList||[]),N(s.planName||"Meal Plan")}catch{}},[t,i]);b.useEffect(()=>{$()},[$]);const L=async()=>{w(!0);try{const s=await c(t);o(s)}catch{}finally{w(!1)}},D=(s,r)=>{o(a=>{const n=[...a],p=n.filter(y=>(y.category||"Other")===s)[r];if(p){const y=n.findIndex(M=>M.name===p.name&&M.unit===p.unit);y>=0&&(n[y]={...n[y],checked:!n[y].checked})}return n})},T=(s,r)=>{o(a=>{const m=a.filter(p=>(p.category||"Other")===s)[r];return m?a.filter(p=>!(p.name===m.name&&p.unit===m.unit)):a})},z=async()=>{const s=h.map(({category:r,items:a})=>`${r}:
${a.map(n=>`  [ ] ${n.name} - ${S(n.quantity)} ${n.unit}`).join(`
`)}`).join(`

`);if(navigator.share)try{await navigator.share({title:`Shopping List - ${u}`,text:s})}catch{}else await navigator.clipboard.writeText(s),alert("Shopping list copied to clipboard!")},B=()=>{const s=`
      <html>
        <head>
          <title>Shopping List - ${u}</title>
          <style>
            body { font-family: system-ui, sans-serif; padding: 20px; }
            h1 { font-size: 24px; margin-bottom: 20px; }
            h2 { font-size: 18px; margin: 20px 0 10px; border-bottom: 1px solid #ccc; padding-bottom: 5px; }
            ul { list-style: none; padding: 0; margin: 0; }
            li { padding: 8px 0; border-bottom: 1px dotted #eee; display: flex; justify-content: space-between; }
            .checkbox { width: 16px; height: 16px; border: 1px solid #333; margin-right: 10px; display: inline-block; }
            .quantity { color: #666; }
          </style>
        </head>
        <body>
          <h1>Shopping List - ${u}</h1>
          ${h.map(({category:a,items:n})=>`
            <h2>${a}</h2>
            <ul>
              ${n.map(m=>`
                <li>
                  <span><span class="checkbox"></span> ${m.name}</span>
                  <span class="quantity">${S(m.quantity)} ${m.unit}</span>
                </li>
              `).join("")}
            </ul>
          `).join("")}
        </body>
      </html>
    `,r=window.open("","_blank");r.document.write(s),r.document.close(),r.print()};return f&&d.length===0?e.jsxs("div",{className:"min-h-screen bg-gray-950",children:[e.jsx(P,{}),e.jsx(I,{}),e.jsx(G,{}),e.jsx("main",{className:"lg:pl-64 pt-16 pb-24 lg:pb-8",children:e.jsx("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"space-y-4",children:[1,2,3,4].map(s=>e.jsx(g,{className:"h-20 animate-pulse"},s))})})}),e.jsx(O,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-950",children:[e.jsx(P,{}),e.jsx(I,{}),e.jsx(G,{}),e.jsx("main",{className:"lg:pl-64 pt-16 pb-24 lg:pb-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(V,{to:t?`/nutrition/plans/${t}`:"/nutrition/plans",children:e.jsx(v,{variant:"ghost",size:"sm",children:e.jsx(H,{className:"w-4 h-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Shopping List"}),e.jsx("p",{className:"text-sm text-gray-400",children:u})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{variant:"ghost",size:"sm",onClick:z,title:"Share list",children:e.jsx(Q,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:B,title:"Print list",children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:L,disabled:j,title:"Refresh list",children:e.jsx(A,{className:`w-4 h-4 ${j?"animate-spin":""}`})})]})]}),e.jsxs(g,{className:"p-6 mb-6",children:[e.jsx(he,{checked:x,total:l}),x===l&&l>0&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-500/20 rounded-lg",children:[e.jsx(E,{className:"w-5 h-5 text-green-400"}),e.jsx("span",{className:"text-green-400 font-medium",children:"All items checked off!"})]})]}),h.length>0?e.jsx(g,{className:"p-4",children:h.map(({category:s,items:r})=>e.jsx(le,{category:s,items:r,onToggleItem:D,onDeleteItem:T},s))}):e.jsxs(g,{className:"p-12 text-center",children:[e.jsx(R,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 mb-2",children:"No items in shopping list"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Add meals to your plan to generate a shopping list"}),e.jsxs(v,{variant:"primary",onClick:L,disabled:j,children:[e.jsx(A,{className:`w-4 h-4 mr-2 ${j?"animate-spin":""}`}),"Generate Shopping List"]})]}),l>0&&e.jsxs("div",{className:"mt-6 grid grid-cols-3 gap-4",children:[e.jsxs(g,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:l}),e.jsx("p",{className:"text-xs text-gray-400",children:"Total Items"})]}),e.jsxs(g,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:x}),e.jsx("p",{className:"text-xs text-gray-400",children:"Checked Off"})]}),e.jsxs(g,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:h.length}),e.jsx("p",{className:"text-xs text-gray-400",children:"Categories"})]})]})]})}),e.jsx(O,{})]})}export{_e as default};
