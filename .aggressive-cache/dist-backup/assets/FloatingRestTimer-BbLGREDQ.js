import{r as s,j as e}from"./react-vendor-D1NxaRNd.js";import{k as U,af as X,a7 as G,ag as K,h as c,m as i,A as T,X as Y}from"./index-DJKXoZu6.js";import{u as B}from"./use-drag-controls-CMaHHAxC.js";import{T as Q}from"./timer-8pIu4Nao.js";import{M as Z,a as ee}from"./minimize-2-DNGvp5Et.js";import{S as te}from"./skip-forward-CNWxvEfB.js";import{V as se,a as ae}from"./volume-x-f75xQ3as.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./apollo-vendor-BMQ75Ycx.js";import"./reactflow-vendor-Dz2P_-Qa.js";import"./d3-vendor-mcDw60ct.js";import"./recharts-vendor-BziRPEEi.js";const re=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],ie=U("grip-vertical",re),P="musclemap-floating-timer-position",$={x:-20,y:-120};function pe({enabled:I=!0,onTimerEnd:g,className:R=""}){const h=X(),{time:r,isActive:m,totalDuration:y,defaultDuration:u,presets:M,start:b,stop:p,adjust:d,progress:q,formatted:f}=G(),{settings:a,toggleSound:j}=K(),[z,D]=s.useState(!1),[w,k]=s.useState(!1),[n,E]=s.useState(()=>{try{const t=localStorage.getItem(P);return t?JSON.parse(t):$}catch{return $}}),N=B(),O=s.useRef(null),x=s.useRef(!1);s.useEffect(()=>{r===0&&m&&!x.current&&(x.current=!0,g?.()),r>0&&(x.current=!1)},[r,m,g]);const F=s.useCallback((t,S)=>{const C={x:n.x+S.offset.x,y:n.y+S.offset.y};E(C),localStorage.setItem(P,JSON.stringify(C))},[n]),V=s.useCallback(()=>{d(a.quickAdjustAmount),c("light")},[d,a.quickAdjustAmount]),_=s.useCallback(()=>{d(-a.quickAdjustAmount),c("light")},[d,a.quickAdjustAmount]),v=s.useCallback(()=>{p(),c("light")},[p]),H=s.useCallback(()=>{j(),c("light")},[j]),A=s.useCallback(()=>{D(t=>!t),c("light")},[]),W=s.useCallback(()=>{k(t=>!t),c("light")},[]),J=s.useCallback(t=>{b(t),k(!1),c("medium")},[b]);if(!I||!m||!a.showFloatingTimer)return null;const o=r>0&&r<=a.countdownWarningAt,l=r>0&&r<=5,L=y>0?q:u>0?(u-r)/u*100:0;return z?e.jsxs(i.button,{className:"fixed bottom-4 right-4 z-50 flex items-center gap-2 px-3 py-2 rounded-full bg-gray-900/95 backdrop-blur-lg border border-gray-700 shadow-lg",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},onClick:A,whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(Q,{className:`w-4 h-4 ${l?"text-red-400":o?"text-yellow-400":"text-blue-400"}`}),e.jsx("span",{className:`font-mono font-bold text-sm ${l?"text-red-400":o?"text-yellow-400":"text-white"}`,children:f}),e.jsx(Z,{className:"w-3 h-3 text-gray-400"})]}):e.jsx(T,{children:e.jsx(i.div,{ref:O,className:`fixed z-50 ${R}`,style:{bottom:0,right:0},initial:{x:n.x,y:n.y,scale:.8,opacity:0},animate:{x:n.x,y:n.y,scale:1,opacity:1},exit:{scale:.8,opacity:0},drag:!0,dragControls:N,dragMomentum:!1,dragElastic:.1,onDragEnd:F,dragConstraints:{top:-window.innerHeight+150,bottom:0,left:-window.innerWidth+200,right:0},children:e.jsxs("div",{className:`relative bg-gray-900/95 backdrop-blur-lg rounded-2xl border shadow-2xl overflow-hidden ${l?"border-red-500/50":o?"border-yellow-500/50":"border-gray-700"}`,style:{width:200},children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-800 cursor-move",onPointerDown:t=>N.start(t),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-xs font-medium text-gray-400 uppercase tracking-wide",children:"Rest Timer"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:A,className:"p-1 rounded hover:bg-gray-800 text-gray-400 hover:text-gray-300",children:e.jsx(ee,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:v,className:"p-1 rounded hover:bg-gray-800 text-gray-400 hover:text-gray-300",children:e.jsx(Y,{className:"w-3.5 h-3.5"})})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-1 bg-gray-800 rounded-full overflow-hidden mb-4",children:e.jsx(i.div,{className:`h-full ${l?"bg-red-500":o?"bg-yellow-500":"bg-blue-500"}`,initial:{width:"0%"},animate:{width:`${L}%`},transition:{duration:.5}})}),e.jsx(i.div,{className:"text-center mb-4",animate:o&&!h?{scale:[1,1.02,1]}:{},transition:{repeat:1/0,duration:.5},children:e.jsx("span",{className:`text-4xl font-mono font-bold tabular-nums ${l?"text-red-400":o?"text-yellow-400":"text-white"}`,style:o?{textShadow:`0 0 20px ${l?"rgba(239, 68, 68, 0.5)":"rgba(234, 179, 8, 0.5)"}`}:{},children:f})}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs(i.button,{whileTap:{scale:.9},onClick:_,className:"p-2 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-300 font-medium text-sm min-w-[48px]","aria-label":`Subtract ${a.quickAdjustAmount} seconds`,children:["-",a.quickAdjustAmount]}),e.jsx(i.button,{whileTap:{scale:.9},onClick:v,className:"p-2 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-300","aria-label":"Skip rest",children:e.jsx(te,{className:"w-5 h-5"})}),e.jsxs(i.button,{whileTap:{scale:.9},onClick:V,className:"p-2 rounded-lg bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 font-medium text-sm min-w-[48px]","aria-label":`Add ${a.quickAdjustAmount} seconds`,children:["+",a.quickAdjustAmount]})]}),e.jsx("button",{onClick:W,className:"w-full mt-3 py-1.5 text-xs text-gray-500 hover:text-gray-400 transition-colors",children:w?"Hide presets":"Show presets"}),e.jsx(T,{children:w&&e.jsx(i.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsx("div",{className:"flex flex-wrap justify-center gap-1 pt-2",children:M.map(t=>e.jsx("button",{onClick:()=>J(t.seconds),className:`px-2 py-1 rounded text-xs font-medium transition-colors ${r===t.seconds||y===t.seconds?"bg-blue-500/30 text-blue-400 border border-blue-500/40":"bg-gray-800 text-gray-400 hover:text-gray-300 hover:bg-gray-700"}`,children:t.label},t.seconds))})})})]}),e.jsxs("div",{className:"px-3 py-2 border-t border-gray-800 flex items-center justify-between",children:[e.jsx("button",{onClick:H,className:"flex items-center gap-1.5 text-xs text-gray-400 hover:text-gray-300",children:a.soundEnabled?e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"w-3.5 h-3.5"}),"Sound On"]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"w-3.5 h-3.5"}),"Sound Off"]})}),e.jsx("span",{className:"text-xs text-gray-500",children:"Drag to move"})]}),o&&!h&&e.jsx(i.div,{className:`absolute inset-0 rounded-2xl border-2 pointer-events-none ${l?"border-red-500/50":"border-yellow-500/50"}`,animate:{opacity:[.3,.8,.3]},transition:{repeat:1/0,duration:l?.3:.5}})]})})})}export{pe as FloatingRestTimer,pe as default};
