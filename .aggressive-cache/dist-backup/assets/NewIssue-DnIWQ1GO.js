import{d as w,r as o,j as e,L as N}from"./react-vendor-D1NxaRNd.js";import{y as k}from"./index-HEJJGvd8.js";import{c as I,a as S}from"./sanitize-CfVRSXz9.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./apollo-vendor-D9c7jRvS.js";import"./reactflow-vendor-Dz2P_-Qa.js";import"./d3-vendor-mcDw60ct.js";import"./recharts-vendor-BziRPEEi.js";const u={Back:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 19l-7-7 7-7"})}),Info:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Check:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})},C=[{value:0,label:"Bug Report",icon:"ðŸ›",description:"Something is broken or not working correctly"},{value:1,label:"Feature Request",icon:"âœ¨",description:"Suggest a new feature or functionality"},{value:2,label:"Enhancement",icon:"ðŸ’¡",description:"Improve an existing feature"},{value:3,label:"Account Issue",icon:"ðŸ‘¤",description:"Problems with your account or settings"},{value:4,label:"Question",icon:"â“",description:"General questions or need help"},{value:5,label:"Other",icon:"ðŸ“",description:"Anything else"}],b=[{value:0,label:"Low",description:"Minor issue, no rush"},{value:1,label:"Medium",description:"Standard priority"},{value:2,label:"High",description:"Important, needs attention soon"},{value:3,label:"Critical",description:"Urgent, blocking work or major bug"}];function c(){const r=navigator.userAgent;let n="Unknown",i="";return r.includes("Firefox/")?(n="Firefox",i=r.match(/Firefox\/([0-9.]+)/)?.[1]||""):r.includes("Edg/")?(n="Edge",i=r.match(/Edg\/([0-9.]+)/)?.[1]||""):r.includes("Chrome/")?(n="Chrome",i=r.match(/Chrome\/([0-9.]+)/)?.[1]||""):r.includes("Safari/")&&(n="Safari",i=r.match(/Version\/([0-9.]+)/)?.[1]||""),{browser:`${n} ${i}`.trim(),platform:navigator.platform,language:navigator.language,screenSize:`${window.screen.width}x${window.screen.height}`,viewportSize:`${window.innerWidth}x${window.innerHeight}`,userAgent:r.substring(0,200)}}function f(){const r=navigator.userAgent;let n="Desktop",i="Unknown";return/iPhone|iPad|iPod/.test(r)?(n=/iPad/.test(r)?"Tablet":"Mobile",i="iOS"):/Android/.test(r)?(n=/Mobile/.test(r)?"Mobile":"Tablet",i="Android"):/Windows/.test(r)?i="Windows":/Mac OS/.test(r)?i="macOS":/Linux/.test(r)&&(i="Linux"),{device:n,os:i}}function z(){const{token:r}=k(),n=w(),[i,y]=o.useState([]),[x,h]=o.useState(!1),[m,d]=o.useState(""),[s,a]=o.useState({type:0,priority:1,title:"",description:"",labelIds:[],includeEnvironment:!0});o.useEffect(()=>{r||n("/login")},[r,n]),o.useEffect(()=>{fetch("/api/issues/labels").then(t=>t.json()).then(t=>y(t.data||[])).catch(console.error)},[]);const v=async t=>{if(t.preventDefault(),d(""),s.title.length<5){d("Title must be at least 5 characters");return}if(s.description.length<20){d("Description must be at least 20 characters");return}h(!0);try{const l={type:s.type,priority:s.priority,title:S(s.title),description:I(s.description),labelIds:s.labelIds,pageUrl:window.location.origin+window.location.pathname};s.includeEnvironment&&(l.browserInfo=c(),l.deviceInfo=f());const p=await fetch("/api/issues",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(l)}),g=await p.json();if(!p.ok)throw new Error(g.error?.message||"Failed to create issue");n(`/issues/${g.data.issueNumber}`)}catch(l){d(l.message)}finally{h(!1)}},j=t=>{s.labelIds.includes(t)?a({...s,labelIds:s.labelIds.filter(l=>l!==t)}):s.labelIds.length<5&&a({...s,labelIds:[...s.labelIds,t]})};return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white pb-24",children:[e.jsx("header",{className:"bg-gray-800 border-b border-gray-700 sticky top-0 z-20",children:e.jsx("div",{className:"max-w-3xl mx-auto px-4 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(N,{to:"/issues",className:"text-gray-400 hover:text-white flex items-center gap-2",children:[e.jsx(u.Back,{}),e.jsx("span",{children:"Back to Issues"})]})})})}),e.jsxs("main",{className:"max-w-3xl mx-auto px-4 py-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-6",children:"Create New Issue"}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"What type of issue is this?"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:C.map(t=>e.jsxs("button",{type:"button",onClick:()=>a({...s,type:t.value}),className:`p-4 rounded-xl border-2 text-left transition-all ${s.type===t.value?"border-purple-500 bg-purple-500/10":"border-gray-700 bg-gray-800/50 hover:border-gray-600"}`,children:[e.jsx("div",{className:"text-2xl mb-2",children:t.icon}),e.jsx("div",{className:"font-medium text-white",children:t.label}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:t.description})]},t.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Title ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:s.title,onChange:t=>a({...s,title:t.target.value}),placeholder:"Brief summary of the issue...",maxLength:200,className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500"}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:s.title.length<5?`${5-s.title.length} more characters needed`:""}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.title.length,"/200"]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Description ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("textarea",{value:s.description,onChange:t=>a({...s,description:t.target.value}),placeholder:s.type===0?`Please describe the bug in detail:

1. What were you trying to do?
2. What happened instead?
3. What did you expect to happen?
4. Steps to reproduce the issue`:s.type===1?`Please describe your feature request:

1. What problem does this solve?
2. How would this feature work?
3. Any examples from other apps?`:"Please provide as much detail as possible...",rows:8,maxLength:1e4,className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 resize-none"}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:s.description.length<20?`${20-s.description.length} more characters needed`:""}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.description.length,"/10000"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Priority"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:b.map(t=>e.jsx("button",{type:"button",onClick:()=>a({...s,priority:t.value}),className:`px-4 py-2 rounded-lg border transition-all ${s.priority===t.value?"border-purple-500 bg-purple-500/20 text-white":"border-gray-700 bg-gray-800/50 text-gray-400 hover:border-gray-600"}`,children:t.label},t.value))}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:b.find(t=>t.value===s.priority)?.description})]}),i.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Labels (optional, max 5)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(t=>e.jsxs("button",{type:"button",onClick:()=>j(t.id),className:`px-3 py-1.5 rounded-full text-sm transition-all flex items-center gap-1 ${s.labelIds.includes(t.id)?"ring-2 ring-white/50":"opacity-70 hover:opacity-100"}`,style:{backgroundColor:`${t.color}20`,color:t.color},children:[s.labelIds.includes(t.id)&&e.jsx(u.Check,{}),t.icon," ",t.name]},t.id))})]}),e.jsx("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700/50",children:e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.includeEnvironment,onChange:t=>a({...s,includeEnvironment:t.target.checked}),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-700 text-purple-500 focus:ring-purple-500 focus:ring-offset-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-white",children:"Include environment info"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Automatically include your browser, screen size, and operating system. This helps us debug issues faster."}),s.includeEnvironment&&e.jsx("div",{className:"mt-3 p-3 bg-gray-700/50 rounded-lg text-xs text-gray-400",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:["Browser: ",c().browser]}),e.jsxs("div",{children:["Platform: ",c().platform]}),e.jsxs("div",{children:["Screen: ",c().screenSize]}),e.jsxs("div",{children:["OS: ",f().os]})]})})]})]})}),m&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4 text-red-400",children:m}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>n("/issues"),className:"px-6 py-3 rounded-lg bg-gray-700 hover:bg-gray-600 text-white font-medium transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:x||s.title.length<5||s.description.length<20,className:"flex-1 px-6 py-3 rounded-lg bg-purple-600 hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium transition-colors",children:x?"Creating...":"Create Issue"})]}),e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-xl p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(u.Info,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-400 mb-1",children:"Tips for a great issue report"}),e.jsxs("ul",{className:"text-sm text-gray-400 space-y-1",children:[e.jsx("li",{children:"Be specific and provide concrete examples"}),e.jsx("li",{children:"Include steps to reproduce the issue"}),e.jsx("li",{children:"Search existing issues first to avoid duplicates"}),e.jsx("li",{children:"One issue per report - don't combine multiple problems"})]})]})]})})]})]})]})}export{z as default};
