import{l as R,d as M,r,j as e,L as S}from"./react-vendor-D1NxaRNd.js";import{c as O,y as z,ab as P,aY as W,b1 as I,b6 as _,b4 as X,a$ as H,Z as J,a3 as Z,a1 as q}from"./index-VPOrxyVC.js";import{G as l}from"./GlassSurface-BMiMerMg.js";import{L as m}from"./loader-circle-DqAqkw56.js";import{A as L}from"./arrow-left-BALoXPjp.js";import{R as Y}from"./refresh-cw-CkLQQkM5.js";import{B as U}from"./ban-CRQ4rIBF.js";import{M as K,G as u}from"./mail-INoyheM2.js";import{A as Q}from"./award-DiykSfsM.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./apollo-vendor-D9c7jRvS.js";import"./reactflow-vendor-Dz2P_-Qa.js";import"./d3-vendor-mcDw60ct.js";import"./recharts-vendor-BziRPEEi.js";const V=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],ee=O("user-x",V);function pe(){const{userId:i}=R(),B=M(),{token:f}=z(),[E,j]=r.useState(!0),[N,b]=r.useState(null),[y,G]=r.useState(null),[c,d]=r.useState(null),[T,h]=r.useState(!1),[n,v]=r.useState(100),x=r.useCallback(()=>({Authorization:`Bearer ${f}`}),[f]),o=r.useCallback(async()=>{if(i)try{j(!0),b(null);const s=await fetch(`/api/admin-control/users/${i}`,{headers:x()});if(!s.ok){const p=await s.json().catch(()=>({}));throw new Error(p.error?.message||"Failed to fetch user data")}const a=await s.json();G(a.data||a)}catch(s){b(s instanceof Error?s.message:"Failed to load user data")}finally{j(!1)}},[i,x]);r.useEffect(()=>{o()},[o]);const w=async s=>{if(i){d(s);try{const a=await fetch(`/api/admin-control/users/${i}/${s}`,{method:"POST",headers:{...x(),"Content-Type":"application/json"}});if(a.ok)await o();else{const p=await a.json();alert(p.error?.message||`Failed to ${s} user`)}}catch{alert(`Failed to ${s} user`)}finally{d(null)}}},$=async()=>{if(!(!i||!n)){d("gift");try{const s=await fetch("/api/owner/gift-credits",{method:"POST",headers:{...x(),"Content-Type":"application/json"},body:JSON.stringify({targetUserId:i,amount:n,reason:"Admin gift from Empire Control"})});if(s.ok)h(!1),await o(),alert(`Successfully gifted ${n} credits!`);else{const a=await s.json();alert(a.error?.message||"Failed to gift credits")}}catch{alert("Failed to gift credits")}finally{d(null)}}},k=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),D=s=>{const a=["text-gray-400","text-amber-700","text-gray-300","text-yellow-400","text-cyan-300","text-blue-300","text-purple-500"];return a[s]||a[0]},F=s=>["Broke","Bronze","Silver","Gold","Platinum","Diamond","Obsidian"][s]||"Unknown";if(E)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-950 to-gray-900 text-white flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m,{className:"w-8 h-8 animate-spin text-violet-400"}),e.jsx("span",{className:"text-lg",children:"Loading user data..."})]})});if(N||!y)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-950 to-gray-900 text-white p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs(S,{to:"/empire",className:"inline-flex items-center gap-2 text-violet-400 hover:text-violet-300 mb-6",children:[e.jsx(L,{className:"w-4 h-4"}),"Back to Empire"]}),e.jsxs(l,{className:"p-8 text-center",children:[e.jsx(ee,{className:"w-16 h-16 mx-auto text-red-400 mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:"User Not Found"}),e.jsx("p",{className:"text-gray-400",children:N||"Unable to load user data"})]})]})});const{user:t,stats:C,recentActivity:g}=y,A=t.status==="banned";return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-950 to-gray-900 text-white p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(S,{to:"/empire",className:"inline-flex items-center gap-2 text-violet-400 hover:text-violet-300",children:[e.jsx(L,{className:"w-4 h-4"}),"Back to Empire"]}),e.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-gray-400 hover:text-white",children:[e.jsx(Y,{className:"w-4 h-4"}),"Refresh"]})]}),e.jsx(l,{className:"p-6 mb-6",children:e.jsxs("div",{className:"flex items-start justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-violet-500 to-fuchsia-500 flex items-center justify-center text-white text-3xl font-bold",children:t.avatarUrl?e.jsx("img",{src:t.avatarUrl,alt:t.username,className:"w-full h-full rounded-full object-cover"}):t.username?.charAt(0).toUpperCase()||"?"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1 flex-wrap",children:[e.jsx("h1",{className:"text-2xl font-bold",children:t.displayName||t.username}),A&&e.jsxs("span",{className:"px-2 py-1 bg-red-500/20 text-red-400 text-xs rounded-full flex items-center gap-1",children:[e.jsx(U,{className:"w-3 h-3"}),"Banned"]}),t.roles?.includes("admin")&&e.jsxs("span",{className:"px-2 py-1 bg-violet-500/20 text-violet-400 text-xs rounded-full flex items-center gap-1",children:[e.jsx(P,{className:"w-3 h-3"}),"Admin"]})]}),e.jsxs("p",{className:"text-gray-400",children:["@",t.username]}),e.jsxs("p",{className:"text-gray-500 text-sm flex items-center gap-2 mt-1",children:[e.jsx(K,{className:"w-3 h-3"}),t.email]}),e.jsxs("p",{className:"text-gray-500 text-sm flex items-center gap-2",children:[e.jsx(W,{className:"w-3 h-3"}),"Joined ",k(t.createdAt)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg transition-colors",children:[e.jsx(u,{className:"w-4 h-4"}),"Gift Credits"]}),e.jsxs("button",{onClick:()=>B(`/messages?user=${t.id}`),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:[e.jsx(I,{className:"w-4 h-4"}),"Message"]}),A?e.jsxs("button",{onClick:()=>w("unban"),disabled:c==="unban",className:"flex items-center gap-2 px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg transition-colors",children:[c==="unban"?e.jsx(m,{className:"w-4 h-4 animate-spin"}):e.jsx(_,{className:"w-4 h-4"}),"Unban"]}):e.jsxs("button",{onClick:()=>w("ban"),disabled:c==="ban",className:"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:[c==="ban"?e.jsx(m,{className:"w-4 h-4 animate-spin"}):e.jsx(U,{className:"w-4 h-4"}),"Ban"]})]})]})}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-6",children:[e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-violet-500/20 rounded-lg",children:e.jsx(X,{className:"w-5 h-5 text-violet-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Total XP"}),e.jsx("p",{className:"text-xl font-bold",children:(t.totalXp||0).toLocaleString()}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Level ",t.level||1," - ",t.currentRank||"Unranked"]})]})]})}),e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-500/20 rounded-lg",children:e.jsx(H,{className:"w-5 h-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Credits"}),e.jsx("p",{className:"text-xl font-bold",children:(t.creditBalance||0).toLocaleString()}),e.jsx("p",{className:`text-xs ${D(t.wealthTier)}`,children:F(t.wealthTier)})]})]})}),e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-500/20 rounded-lg",children:e.jsx(J,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Total Workouts"}),e.jsx("p",{className:"text-xl font-bold",children:C?.totalWorkouts||0}),e.jsxs("p",{className:"text-xs text-gray-500",children:[C?.recentWorkouts||0," in last 30 days"]})]})]})}),e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-amber-500/20 rounded-lg",children:e.jsx(Q,{className:"w-5 h-5 text-amber-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Level"}),e.jsx("p",{className:"text-xl font-bold",children:t.level||1}),e.jsx("p",{className:"text-xs text-gray-500",children:t.currentRank||"Recruit"})]})]})})]}),e.jsxs(l,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-violet-400"}),"Recent Activity"]}),g&&g.length>0?e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-3",children:g.map((s,a)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-white/5",children:[e.jsx("div",{className:"p-2 bg-white/10 rounded-lg",children:e.jsx(q,{className:"w-4 h-4 text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.feature_id}),e.jsx("p",{className:"text-xs text-gray-400",children:s.action}),e.jsx("p",{className:"text-xs text-gray-500",children:k(s.created_at)})]})]},a))}):e.jsx("p",{className:"text-center text-gray-400 py-8",children:"No recent activity recorded"})]}),T&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs(l,{depth:"solid-elevated",className:"p-6 max-w-md w-full",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5 text-green-400"}),"Gift Credits to ",t.username]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Amount"}),e.jsx("input",{type:"number",value:n,onChange:s=>v(parseInt(s.target.value)||0),min:"1",className:"w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-lg",placeholder:"Enter amount"})]}),e.jsx("div",{className:"flex gap-3",children:[100,500,1e3,5e3].map(s=>e.jsx("button",{onClick:()=>v(s),className:`flex-1 py-2 rounded-lg transition-colors ${n===s?"bg-green-600 text-white":"bg-white/10 hover:bg-white/20"}`,children:s},s))}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>h(!1),className:"flex-1 px-4 py-3 bg-white/10 hover:bg-white/20 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:$,disabled:c==="gift"||n<1,className:"flex-1 px-4 py-3 bg-green-600 hover:bg-green-700 rounded-lg flex items-center justify-center gap-2 disabled:opacity-50",children:c==="gift"?e.jsx(m,{className:"w-5 h-5 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"w-5 h-5"}),"Gift ",n," Credits"]})})]})]})})]})})}export{pe as default};
