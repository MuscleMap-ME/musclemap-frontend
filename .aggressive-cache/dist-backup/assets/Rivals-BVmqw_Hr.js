import{r as a,j as e}from"./react-vendor-D847gc3Q.js";import{e as P,i,A as $,m as v}from"./index-CF1yimBQ.js";import{G as U,a as c}from"./GlassSurface-CuHevRGA.js";import{G as d}from"./GlassButton-gdlFXfDa.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./apollo-vendor-BNHFeEEc.js";import"./reactflow-vendor-CYb5nRwM.js";import"./d3-vendor-mcDw60ct.js";import"./recharts-vendor-CxtoZpzE.js";const r={Swords:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})}),Trophy:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),Search:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),UserPlus:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),Check:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 13l4 4L19 7"})}),X:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})}),TrendingUp:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),TrendingDown:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"})}),Minus:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 12H4"})}),Zap:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 10V3L4 14h7v7l9-11h-7z"})})};function q(){const{user:t}=P(),[f,T]=a.useState([]),[g,M]=a.useState([]),[h,R]=a.useState(null),[W,B]=a.useState(!0),[N,l]=a.useState(null),[x,b]=a.useState(!1),[m,w]=a.useState(""),[y,u]=a.useState([]),[k,L]=a.useState(!1),o=a.useCallback(async()=>{try{l(null);const[s,n,p]=await Promise.all([i.get("/rivals?status=active"),i.get("/rivals/pending"),i.get("/rivals/stats")]);T(s.data?.rivals||[]),M(n.data||[]),R(p.data)}catch(s){l(s.message||"Failed to load rivals data")}finally{B(!1)}},[]);a.useEffect(()=>{o()},[o]);const C=a.useCallback(async s=>{if(s.length<2){u([]);return}L(!0);try{const n=await i.get(`/rivals/search?q=${encodeURIComponent(s)}`);u(n.data||[])}catch{}finally{L(!1)}},[]);a.useEffect(()=>{const s=setTimeout(()=>{C(m)},300);return()=>clearTimeout(s)},[m,C]);const z=async s=>{try{await i.post("/rivals/challenge",{opponentId:s}),w(""),u([]),b(!1),o()}catch(n){l(n.message||"Failed to send challenge")}},A=async s=>{try{await i.post(`/rivals/${s}/accept`),o()}catch(n){l(n.message||"Failed to accept rivalry")}},E=async s=>{try{await i.post(`/rivals/${s}/decline`),o()}catch(n){l(n.message||"Failed to decline rivalry")}},F=async s=>{if(window.confirm("Are you sure you want to end this rivalry?"))try{await i.post(`/rivals/${s}/end`),o()}catch(n){l(n.message||"Failed to end rivalry")}};return W?e.jsx("div",{className:"min-h-screen bg-[#0a0a0f]",children:e.jsx(U,{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-2 border-violet-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white/60",children:"Loading rivals..."})]})})}):e.jsx("div",{className:"min-h-screen bg-[#0a0a0f]",children:e.jsx(U,{className:"min-h-screen p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Rivals"}),e.jsx("p",{className:"text-white/60",children:"1v1 competition to push your limits"})]}),N&&e.jsxs("div",{className:"bg-red-500/20 border border-red-500/50 rounded-xl p-4 text-red-400 flex justify-between items-center",children:[e.jsx("span",{children:N}),e.jsx("button",{onClick:()=>l(null),className:"text-red-400 hover:text-red-300",children:e.jsx(r.X,{className:"w-5 h-5"})})]}),h&&e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex justify-around text-center",children:[e.jsxs("div",{children:[e.jsx(r.Trophy,{className:"w-8 h-8 text-yellow-400 mx-auto mb-2"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:h.wins||0}),e.jsx("div",{className:"text-white/50 text-sm",children:"Wins"})]}),e.jsxs("div",{children:[e.jsx(r.Swords,{className:"w-8 h-8 text-blue-400 mx-auto mb-2"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:h.activeRivals||0}),e.jsx("div",{className:"text-white/50 text-sm",children:"Active"})]}),e.jsxs("div",{children:[e.jsx(r.Zap,{className:"w-8 h-8 text-orange-400 mx-auto mb-2"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:(h.totalTUEarned||0).toLocaleString()}),e.jsx("div",{className:"text-white/50 text-sm",children:"TU Earned"})]})]})}),e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Find Rivals"}),e.jsxs(d,{onClick:()=>{b(!x),w(""),u([])},size:"sm",className:"flex items-center gap-2",children:[x?e.jsx(r.X,{className:"w-4 h-4"}):e.jsx(r.Search,{className:"w-4 h-4"}),x?"Close":"Search"]})]}),e.jsx($,{children:x&&e.jsxs(v.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:[e.jsx("input",{type:"text",value:m,onChange:s=>w(s.target.value),placeholder:"Search by username...",className:"w-full bg-white/10 text-white rounded-lg px-4 py-2 border border-white/10 focus:border-violet-500 outline-none mb-4",autoFocus:!0}),k&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"w-6 h-6 border-2 border-violet-500 border-t-transparent rounded-full animate-spin"})}),e.jsxs("div",{className:"space-y-2",children:[y.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5 hover:bg-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold",children:s.username?.charAt(0).toUpperCase()||"?"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:s.username}),s.archetype&&e.jsx("div",{className:"text-white/50 text-sm",children:s.archetype})]})]}),e.jsxs(d,{onClick:()=>z(s.id),size:"sm",className:"flex items-center gap-2",children:[e.jsx(r.UserPlus,{className:"w-4 h-4"}),"Challenge"]})]},s.id)),m.length>=2&&y.length===0&&!k&&e.jsx("p",{className:"text-white/50 text-center py-4",children:"No users found"})]})]})})]}),g.length>0&&e.jsxs(c,{className:"p-6 border border-yellow-500/30",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Pending Requests"}),e.jsx("div",{className:"space-y-3",children:g.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold",children:s.opponent?.username?.charAt(0).toUpperCase()||"?"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:s.opponent?.username}),e.jsx("div",{className:"text-white/50 text-sm",children:s.isChallenger?"Waiting for response":"Wants to compete"})]})]}),!s.isChallenger&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{onClick:()=>A(s.id),size:"sm",className:"bg-green-500/20 hover:bg-green-500/30 border-green-500/50",children:e.jsx(r.Check,{className:"w-4 h-4"})}),e.jsx(d,{onClick:()=>E(s.id),size:"sm",className:"bg-red-500/20 hover:bg-red-500/30 border-red-500/50",children:e.jsx(r.X,{className:"w-4 h-4"})})]})]},s.id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Active Rivalries"}),f.length===0?e.jsxs(c,{className:"p-8 text-center",children:[e.jsx(r.Swords,{className:"w-12 h-12 text-white/30 mx-auto mb-4"}),e.jsxs("p",{className:"text-white/50",children:["No active rivalries yet.",e.jsx("br",{}),"Challenge someone to compete!"]})]}):f.map(s=>{const n=(s.myTU||0)+(s.opponentTU||0),p=n>0?s.myTU/n*100:50,S=s.myTU>s.opponentTU,j=s.myTU-s.opponentTU;return e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:s.opponent?.username?.charAt(0).toUpperCase()||"?"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-bold text-lg",children:s.opponent?.username}),e.jsx("div",{className:"text-white/50 text-sm",children:"vs You"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[S?e.jsx(r.TrendingUp,{className:"w-5 h-5 text-green-400"}):j<0?e.jsx(r.TrendingDown,{className:"w-5 h-5 text-red-400"}):e.jsx(r.Minus,{className:"w-5 h-5 text-white/50"}),e.jsxs("span",{className:`font-bold text-lg ${S?"text-green-400":j<0?"text-red-400":"text-white/50"}`,children:[j>0?"+":"",j," TU"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsxs("span",{className:"text-blue-400",children:["You: ",(s.myTU||0).toLocaleString()," TU"]}),e.jsxs("span",{className:"text-red-400",children:[s.opponent?.username,": ",(s.opponentTU||0).toLocaleString()," TU"]})]}),e.jsxs("div",{className:"h-3 flex rounded-full overflow-hidden",children:[e.jsx(v.div,{className:"bg-blue-500",initial:{width:"50%"},animate:{width:`${p}%`},transition:{duration:.5}}),e.jsx(v.div,{className:"bg-red-500",initial:{width:"50%"},animate:{width:`${100-p}%`},transition:{duration:.5}})]})]}),e.jsx(d,{onClick:()=>F(s.id),className:"w-full bg-red-500/20 hover:bg-red-500/30 border-red-500/50 text-red-400",children:"End Rivalry"})]})},s.id)})]})]})})})}export{q as default};
