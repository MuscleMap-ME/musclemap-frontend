import{d as T,u as W,r as t,j as e}from"./react-vendor-D847gc3Q.js";import{H as D,P as E}from"./reactflow-vendor-CYb5nRwM.js";const z={search:"",categories:[],protection:[],showHidden:!1},j=t.createContext(null);function Q({children:c}){const o=T(),r=W(),[m,v]=t.useState(null),[x,i]=t.useState(null),[u,p]=t.useState(null),[d,w]=t.useState(null),[f,s]=t.useState(null),[b,h]=t.useState(!0),[k,N]=t.useState(null),[y,M]=t.useState(null),[C,$]=t.useState(""),[A,H]=t.useState(z),g=t.useCallback(async()=>{h(!0),N(null);try{const n=await fetch("/atlases/route-atlas.json");if(n.ok){const a=await n.json();v(a)}try{const a=await fetch("/atlases/docs-atlas.json");if(a.ok){const l=await a.json();i(l)}}catch{}try{const a=await fetch("/atlases/roadmap-atlas.json");if(a.ok){const l=await a.json();p(l)}}catch{}try{const a=localStorage.getItem("musclemap_token");if(a){const l=await fetch("/api/atlas/user-context",{headers:{Authorization:`Bearer ${a}`}});if(l.ok){const S=await l.json();s(S.data||S)}}}catch{}}catch(n){N(n instanceof Error?n:new Error("Failed to load atlas data"))}finally{h(!1)}},[]);t.useEffect(()=>{g()},[g]);const L=t.useCallback(n=>{r(n)},[r]),R=t.useCallback((n,a)=>{const l=a?`/docs/${n}#${a}`:`/docs/${n}`;r(l)},[r]),B=t.useMemo(()=>({routeAtlas:m,docsAtlas:x,roadmapAtlas:u,architectureAtlas:d,userContext:f,loading:b,error:k,selectedNodeId:y,setSelectedNodeId:M,searchQuery:C,setSearchQuery:$,activeFilters:A,setActiveFilters:H,currentPath:o.pathname,navigateToRoute:L,navigateToDoc:R,refreshData:g}),[m,x,u,d,f,b,k,y,C,A,o.pathname,L,R,g]);return e.jsx(j.Provider,{value:B,children:c})}function q(){const c=t.useContext(j);if(!c)throw new Error("useAtlas must be used within an AtlasProvider");return c}function G(){return t.useContext(j)}const P={public:null,protected:e.jsx("svg",{className:"w-3.5 h-3.5 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),admin:e.jsx("svg",{className:"w-3.5 h-3.5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})},F={public:"Public",protected:"Login required",admin:"Admin only"};function I({data:c}){const{route:o,category:r,isHighlighted:m,isCurrentRoute:v,onNavigate:x}=c,[i,u]=t.useState(!1),p=t.useRef(null),d=t.useRef(null);t.useEffect(()=>{if(!i)return;const s=h=>{p.current&&!p.current.contains(h.target)&&d.current&&!d.current.contains(h.target)&&u(!1)},b=setTimeout(()=>{document.addEventListener("click",s)},10);return()=>{clearTimeout(b),document.removeEventListener("click",s)}},[i]);const w=s=>{s.stopPropagation(),s.preventDefault(),u(!i)},f=s=>{s.stopPropagation(),s.preventDefault(),o.external?window.open(o.path,"_blank","noopener,noreferrer"):x(o.path)};return e.jsxs(e.Fragment,{children:[e.jsx(D,{type:"target",position:E.Top,className:"!bg-white/20 !border-white/30 !pointer-events-none"}),e.jsxs("div",{ref:d,onClick:w,onMouseDown:s=>s.stopPropagation(),role:"button",tabIndex:0,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&w(s)},className:`
          atlas-route-node group cursor-pointer relative
          px-3 py-2 rounded-lg min-w-[120px]
          bg-white/5 backdrop-blur-md
          border border-white/10
          transition-all duration-200
          hover:bg-white/10 hover:border-white/20 hover:-translate-y-0.5
          select-none
          ${m?"ring-2 ring-blue-400/50":""}
          ${v?"ring-2 ring-pink-500/50 animate-pulse":""}
          ${i?"ring-2 ring-white/30":""}
        `,style:{borderLeftColor:r.color,borderLeftWidth:"3px",pointerEvents:"all"},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[P[o.protection],e.jsx("span",{className:"font-medium text-white text-sm truncate",children:o.label}),o.external&&e.jsx("svg",{className:"w-3 h-3 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),o.badge&&e.jsx("span",{className:"px-1.5 py-0.5 text-[10px] bg-pink-500/30 text-pink-300 rounded font-medium",children:o.badge})]}),e.jsx("div",{className:"text-[11px] text-gray-400 mt-0.5 truncate max-w-[150px] opacity-70 group-hover:opacity-100",children:o.description}),i&&e.jsxs("div",{ref:p,className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 z-50 w-56",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"bg-gray-900/95 backdrop-blur-xl border border-white/20 rounded-xl p-4 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:r.color}}),e.jsx("span",{className:"text-xs text-gray-400",children:r.label})]}),e.jsx("h4",{className:"font-semibold text-white text-base mb-1",children:o.label}),e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:o.description}),e.jsx("div",{className:"text-xs text-gray-500 font-mono mb-3",children:o.path}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[P[o.protection],e.jsx("span",{className:`text-xs ${o.protection==="public"?"text-green-400":"text-amber-400"}`,children:F[o.protection]})]}),e.jsxs("button",{onClick:f,className:"w-full py-2 px-4 bg-blue-600 hover:bg-blue-500 text-white text-sm font-medium rounded-lg transition-colors flex items-center justify-center gap-2",children:[o.external?"Open":"Go to"," ",o.label,o.external?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -bottom-2 w-4 h-4 bg-gray-900/95 border-b border-r border-white/20 transform rotate-45"})]})]}),e.jsx(D,{type:"source",position:E.Bottom,className:"!bg-white/20 !border-white/30 !pointer-events-none"})]})}const K=t.memo(I);export{Q as A,K as R,G as a,q as u};
