import{r,j as e}from"./react-vendor-D1NxaRNd.js";import{u as Q,a as x,A as P,m as j}from"./index-BRHeW3t7.js";import{G as $,a as d}from"./GlassSurface-BMiMerMg.js";import{G as p}from"./GlassButton-BwbchEMZ.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./apollo-vendor-D9c7jRvS.js";import"./reactflow-vendor-Dz2P_-Qa.js";import"./d3-vendor-mcDw60ct.js";import"./recharts-vendor-BziRPEEi.js";const l={Users:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),Trophy:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),Swords:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})}),Plus:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 4v16m8-8H4"})}),Search:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Crown:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 3l4 9-6 3 9 6 9-6-6-3 4-9-5 3-3-6-3 6-5-3z"})}),Shield:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),TrendingUp:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),TrendingDown:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"})}),Clock:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),X:({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})};function q({war:t,myCrew:a}){const h=t.challengerCrewId===a.id,m=h?t.defendingCrew:t.challengerCrew,n=h?t.challengerTU:t.defendingTU,o=h?t.defendingTU:t.challengerTU,f=n+o,w=f>0?n/f*100:50,i=n>o;return e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-red-400",children:e.jsx(l.Swords,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-white",children:["vs ",m?.name||"Unknown"]}),e.jsxs("div",{className:"flex items-center gap-1 text-white/50 text-sm",children:[e.jsx(l.Clock,{className:"w-3 h-3"}),e.jsxs("span",{children:[t.daysRemaining||0," days left"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i?e.jsx(l.TrendingUp,{className:"w-5 h-5 text-green-400"}):n<o?e.jsx(l.TrendingDown,{className:"w-5 h-5 text-red-400"}):null,e.jsxs("span",{className:`font-bold ${i?"text-green-400":n<o?"text-red-400":"text-white/50"}`,children:[n>o?"+":"",n-o," TU"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsxs("span",{className:"text-blue-400",children:[a.name,": ",n.toLocaleString()," TU"]}),e.jsxs("span",{className:"text-red-400",children:[m?.name||"Opponent",": ",o.toLocaleString()," TU"]})]}),e.jsxs("div",{className:"h-2 flex rounded-full overflow-hidden",children:[e.jsx("div",{className:"bg-blue-500 transition-all",style:{width:`${w}%`}}),e.jsx("div",{className:"bg-red-500 transition-all",style:{width:`${100-w}%`}})]})]})]})}function ae(){const{user:t}=Q(),[a,h]=r.useState(null),[m,n]=r.useState([]),[o,f]=r.useState(!0),[w,i]=r.useState(null),[E,v]=r.useState(!1),[G,b]=r.useState(!1),[N,L]=r.useState(""),[S,k]=r.useState([]),[T,U]=r.useState(!1),[g,M]=r.useState(""),[y,W]=r.useState(""),[B,z]=r.useState(""),[A,D]=r.useState(!1),u=r.useCallback(async()=>{try{i(null);const[s,c]=await Promise.all([x.get("/crews/my").catch(()=>({data:null})),x.get("/crews/leaderboard?limit=20")]),C=s.data?.data||s.data||null;h(C);const R=c.data?.data||c.data||[];n(Array.isArray(R)?R:[])}catch(s){i(s.message||"Failed to load crews data")}finally{f(!1)}},[]);r.useEffect(()=>{u()},[u]);const F=r.useCallback(async s=>{if(s.length<2){k([]);return}U(!0);try{const c=await x.get(`/crews/search?q=${encodeURIComponent(s)}`),C=c.data?.data||c.data||[];k(Array.isArray(C)?C:[])}catch{}finally{U(!1)}},[]);r.useEffect(()=>{const s=setTimeout(()=>{F(N)},300);return()=>clearTimeout(s)},[N,F]);const I=async()=>{if(!g.trim()||!y.trim()){i("Name and tag are required");return}D(!0);try{await x.post("/crews",{name:g.trim(),tag:y.trim().toUpperCase(),description:B.trim()||void 0}),v(!1),M(""),W(""),z(""),u()}catch(s){i(s.message||"Failed to create crew")}finally{D(!1)}},X=async()=>{if(window.confirm("Are you sure you want to leave this crew?"))try{await x.post("/crews/leave"),u()}catch(s){i(s.message||"Failed to leave crew")}},H=async s=>{try{await x.post(`/crews/${s}/join`),b(!1),L(""),k([]),u()}catch(c){i(c.message||"Failed to join crew")}},J=s=>{switch(s){case"owner":return e.jsx(l.Crown,{className:"w-4 h-4 text-yellow-400"});case"captain":return e.jsx(l.Shield,{className:"w-4 h-4 text-blue-400"});default:return null}};return o?e.jsx($,{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-2 border-violet-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white/60",children:"Loading crews..."})]})}):e.jsx($,{className:"min-h-screen p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Crews"}),e.jsx("p",{className:"text-white/60",children:"Team up and compete in Crew Wars"})]}),w&&e.jsxs("div",{className:"bg-red-500/20 border border-red-500/50 rounded-xl p-4 text-red-400 flex justify-between items-center",children:[e.jsx("span",{children:w}),e.jsx("button",{onClick:()=>i(null),className:"text-red-400 hover:text-red-300",children:e.jsx(l.X,{className:"w-5 h-5"})})]}),a?e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"p-6",style:{backgroundColor:`${a.crew?.color||"#6366f1"}20`},children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center text-white font-bold text-xl",style:{backgroundColor:a.crew?.color||"#6366f1"},children:a.crew?.tag||"??"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:a.crew?.name}),J(a.membership?.role)]}),e.jsxs("p",{className:"text-white/60",children:["[",a.crew?.tag,"] · ",a.crew?.memberCount||0," members"]})]})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:a.stats?.weeklyTU?.toLocaleString()||0}),e.jsx("div",{className:"text-white/50 text-sm",children:"Weekly TU"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:a.stats?.warsWon||0}),e.jsx("div",{className:"text-white/50 text-sm",children:"Wins"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:a.stats?.warsLost||0}),e.jsx("div",{className:"text-white/50 text-sm",children:"Losses"})]})]})]})}),a.wars?.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Active Wars"}),a.wars.map(s=>e.jsx(q,{war:s,myCrew:a.crew},s.id))]}),e.jsxs(d,{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Top Contributors"}),e.jsxs("div",{className:"space-y-3",children:[a.stats?.topContributors?.map((s,c)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-white/50 w-6",children:["#",c+1]}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-bold",children:s.username?.charAt(0).toUpperCase()||"?"})}),e.jsx("span",{className:"text-white",children:s.username})]}),e.jsxs("span",{className:"text-blue-400 font-bold",children:[s.weeklyTU?.toLocaleString()||0," TU"]})]},s.userId)),(!a.stats?.topContributors||a.stats.topContributors.length===0)&&e.jsx("p",{className:"text-white/50 text-center py-4",children:"No contributions this week yet"})]})]}),a.membership?.role!=="owner"&&e.jsx(p,{onClick:X,className:"w-full bg-red-500/20 hover:bg-red-500/30 border-red-500/50 text-red-400",children:"Leave Crew"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(d,{className:"p-8 text-center",children:[e.jsx(l.Users,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Join a Crew"}),e.jsx("p",{className:"text-white/60 mb-6",children:"Team up with others and compete in Crew Wars!"}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsxs(p,{onClick:()=>v(!0),className:"flex items-center gap-2",children:[e.jsx(l.Plus,{className:"w-4 h-4"}),"Create Crew"]}),e.jsxs(p,{onClick:()=>b(!0),variant:"outline",className:"flex items-center gap-2",children:[e.jsx(l.Search,{className:"w-4 h-4"}),"Find Crew"]})]})]}),e.jsx(P,{children:E&&e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>v(!1),children:e.jsx(j.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:s=>s.stopPropagation(),children:e.jsxs(d,{className:"p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Create Crew"}),e.jsx("button",{onClick:()=>v(!1),className:"text-white/50 hover:text-white",children:e.jsx(l.X,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/70 text-sm mb-1",children:"Crew Name"}),e.jsx("input",{type:"text",value:g,onChange:s=>M(s.target.value),placeholder:"Enter crew name",className:"w-full bg-white/10 text-white rounded-lg px-4 py-2 border border-white/10 focus:border-violet-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/70 text-sm mb-1",children:"Tag (3-5 characters)"}),e.jsx("input",{type:"text",value:y,onChange:s=>W(s.target.value.toUpperCase()),placeholder:"ABC",maxLength:5,className:"w-full bg-white/10 text-white rounded-lg px-4 py-2 border border-white/10 focus:border-violet-500 outline-none uppercase"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/70 text-sm mb-1",children:"Description (optional)"}),e.jsx("textarea",{value:B,onChange:s=>z(s.target.value),placeholder:"Tell others about your crew",rows:3,className:"w-full bg-white/10 text-white rounded-lg px-4 py-2 border border-white/10 focus:border-violet-500 outline-none resize-none"})]}),e.jsx(p,{onClick:I,disabled:A||!g.trim()||!y.trim(),className:"w-full",children:A?"Creating...":"Create Crew"})]})]})})})}),e.jsx(P,{children:G&&e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>b(!1),children:e.jsx(j.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:s=>s.stopPropagation(),children:e.jsxs(d,{className:"p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Find Crew"}),e.jsx("button",{onClick:()=>b(!1),className:"text-white/50 hover:text-white",children:e.jsx(l.X,{className:"w-5 h-5"})})]}),e.jsx("input",{type:"text",value:N,onChange:s=>L(s.target.value),placeholder:"Search by name or tag...",className:"w-full bg-white/10 text-white rounded-lg px-4 py-2 border border-white/10 focus:border-violet-500 outline-none mb-4"}),T&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"w-6 h-6 border-2 border-violet-500 border-t-transparent rounded-full animate-spin"})}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[S.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white/5 hover:bg-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white text-sm font-bold",style:{backgroundColor:s.color||"#6366f1"},children:s.tag}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:s.name}),e.jsxs("div",{className:"text-white/50 text-sm",children:[s.memberCount," members · ",s.weeklyTU?.toLocaleString()||0," TU"]})]})]}),e.jsx(p,{onClick:()=>H(s.id),size:"sm",children:"Join"})]},s.id)),N.length>=2&&S.length===0&&!T&&e.jsx("p",{className:"text-white/50 text-center py-4",children:"No crews found"})]})]})})})})]}),e.jsxs(d,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(l.Trophy,{className:"w-5 h-5 text-yellow-400"}),"Leaderboard"]})}),e.jsxs("div",{className:"space-y-2",children:[m.slice(0,10).map(s=>e.jsxs(j.div,{className:"flex items-center justify-between p-3 rounded-lg bg-white/5 hover:bg-white/10 transition-colors",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:`w-6 text-center font-bold ${s.rank<=3?"text-yellow-400":"text-white/50"}`,children:["#",s.rank]}),e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:s.crew?.color||"#6366f1"},children:s.crew?.tag||"??"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:s.crew?.name}),e.jsxs("div",{className:"text-white/50 text-xs",children:[s.crew?.memberCount||0," members"]})]})]}),e.jsx("span",{className:"text-blue-400 font-bold",children:s.crew?.weeklyTU?.toLocaleString()||0})]},s.crew?.id)),m.length===0&&e.jsx("p",{className:"text-white/50 text-center py-8",children:"No crews yet. Be the first to create one!"})]})]})]})})}export{ae as default};
