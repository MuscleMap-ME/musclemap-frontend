import{j as e,r as g}from"./react-vendor-D847gc3Q.js";import{m as r,dN as q,dO as U,A as S}from"./index-MC6c9alI.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./apollo-vendor-BNHFeEEc.js";import"./reactflow-vendor-5ig9bY2l.js";import"./d3-vendor-DkU_Wy0v.js";import"./recharts-vendor-d8oTApeF.js";const A={1:"Baby",2:"Adolescent",3:"Capable",4:"Armored",5:"Flying",6:"Magnificent"},$={1:"from-gray-400 to-gray-500",2:"from-green-400 to-green-500",3:"from-blue-400 to-blue-500",4:"from-purple-400 to-purple-500",5:"from-orange-400 to-orange-500",6:"from-yellow-400 to-yellow-500"};function L({state:o,className:i=""}){if(!o||!o.progression)return null;const{stage:c,progression:x}=o,{currentXp:h,prevStageXp:y,nextStageXp:p,progressPercent:b,isMaxStage:l}=x,n=A[c]||"Unknown",j=A[c+1]||"Max",m=$[c]||$[1];return e.jsxs("div",{className:`${i}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:`text-sm font-bold bg-gradient-to-r ${m} bg-clip-text text-transparent`,children:["Stage ",c,": ",n]})}),!l&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Next: ",j]})]}),e.jsxs("div",{className:"relative h-4 bg-gray-800 rounded-full overflow-hidden",children:[e.jsx(r.div,{className:`absolute inset-y-0 left-0 bg-gradient-to-r ${m} rounded-full`,initial:{width:0},animate:{width:`${b}%`},transition:{duration:.5,ease:"easeOut"}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-white drop-shadow-md",children:l?"MAX STAGE":`${h} / ${p} XP`})})]}),!l&&e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[y," XP"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[p," XP"]})]}),l&&e.jsx(r.div,{className:"mt-3 text-center",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:e.jsx("span",{className:"text-sm text-yellow-400 font-medium",children:"ðŸŒŸ Maximum Evolution Achieved! ðŸŒŸ"})})]})}const X=[{id:"overview",label:"Overview",icon:"ðŸ“Š"},{id:"upgrades",label:"Upgrades",icon:"ðŸ›ï¸"},{id:"customize",label:"Customize",icon:"âœ¨"},{id:"settings",label:"Settings",icon:"âš™ï¸"}],P={aura:"âœ¨ Auras",armor:"ðŸ›¡ï¸ Armor",wings:"ðŸ¦‹ Wings",tools:"ðŸ”§ Tools",badge:"ðŸ… Badges",ability:"ðŸ’« Abilities"},O={common:"border-gray-500 bg-gray-500/10",rare:"border-blue-500 bg-blue-500/10",epic:"border-purple-500 bg-purple-500/10",legendary:"border-yellow-500 bg-yellow-500/10"};function Y({onClose:o}){const{state:i,stageName:c,upgradesData:x,updateSettings:h,setNickname:y,purchaseUpgrade:p,equipCosmetic:b,reducedMotion:l}=q(),[n,j]=g.useState("overview"),[m,T]=g.useState(i?.nickname||""),[N,f]=g.useState(null),[v,w]=g.useState(null);if(!i)return null;const d=(s,t="success")=>{w({text:s,type:t}),setTimeout(()=>w(null),3e3)},E=async()=>{const s=await y(m);s.success?d("Nickname saved!"):d(s.error||"Failed to save","error")},M=async s=>{f(s);const t=await p(s);f(null),t.success?d(`Purchased ${t.upgrade.name}!`):d(t.error||"Purchase failed","error")},k=async(s,t)=>{const a=await b(s,t);a.success?d("Equipped!"):d(a.error||"Failed to equip","error")},_=x.upgrades.reduce((s,t)=>(s[t.category]||(s[t.category]=[]),s[t.category].push(t),s),{}),C=x.upgrades.filter(s=>s.isUnlocked).reduce((s,t)=>(s[t.category]||(s[t.category]=[]),s[t.category].push(t),s),{});return e.jsxs(e.Fragment,{children:[e.jsx(r.div,{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:o}),e.jsxs(r.div,{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-lg max-h-[90vh] bg-gray-900 rounded-xl shadow-2xl z-50 overflow-hidden border border-purple-500/20",initial:l?{}:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:l?{}:{opacity:0,scale:.9,y:20},role:"dialog","aria-modal":"true","aria-label":"Companion panel",children:[e.jsxs("div",{className:"relative h-32 bg-gradient-to-b from-purple-900/80 to-gray-900 flex items-center justify-center",children:[e.jsx("div",{className:"w-20 h-20",children:e.jsx(U,{stage:i.stage,equipped:i.equipped_cosmetics,reducedMotion:l})}),e.jsx("button",{onClick:o,className:"absolute top-3 right-3 w-8 h-8 rounded-full bg-black/30 hover:bg-black/50 text-white flex items-center justify-center transition-colors","aria-label":"Close",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"absolute bottom-3 right-3 flex items-center gap-1 px-2 py-1 bg-black/30 rounded-lg",children:[e.jsx("span",{className:"text-yellow-400",children:"ðŸª™"}),e.jsx("span",{className:"text-sm font-medium text-white",children:x.balance})]})]}),e.jsx("div",{className:"flex border-b border-gray-800",children:X.map(s=>e.jsxs("button",{onClick:()=>j(s.id),className:`flex-1 py-3 text-sm font-medium transition-colors ${n===s.id?"text-purple-400 border-b-2 border-purple-400":"text-gray-500 hover:text-gray-300"}`,children:[e.jsx("span",{className:"mr-1",children:s.icon}),s.label]},s.id))}),e.jsx("div",{className:"p-4 max-h-80 overflow-y-auto",children:e.jsxs(S,{mode:"wait",children:[n==="overview"&&e.jsxs(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-4",children:[e.jsx(L,{state:i}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Nickname"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:m,onChange:s=>T(s.target.value),placeholder:c,maxLength:30,className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-purple-500"}),e.jsx("button",{onClick:E,className:"px-4 py-2 bg-purple-600 hover:bg-purple-500 rounded-lg text-white text-sm font-medium transition-colors",children:"Save"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Current Stage"}),e.jsxs("div",{className:"text-lg font-bold text-white",children:[i.stage,"/6"]})]}),e.jsxs("div",{className:"p-3 bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Total XP"}),e.jsx("div",{className:"text-lg font-bold text-white",children:i.xp})]}),e.jsxs("div",{className:"p-3 bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Upgrades Owned"}),e.jsx("div",{className:"text-lg font-bold text-white",children:i.unlocked_upgrades.length})]}),e.jsxs("div",{className:"p-3 bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Abilities"}),e.jsx("div",{className:"text-lg font-bold text-white",children:i.abilities.length})]})]})]},"overview"),n==="upgrades"&&e.jsx(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-4",children:Object.entries(_).map(([s,t])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:P[s]||s}),e.jsx("div",{className:"space-y-2",children:t.map(a=>e.jsx("div",{className:`p-3 rounded-lg border ${O[a.rarity]||O.common}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:a.name}),e.jsx("div",{className:"text-xs text-gray-400",children:a.description})]}),a.isUnlocked?e.jsx("span",{className:"text-green-400 text-xs font-medium",children:"Owned"}):a.canPurchase?e.jsx("button",{onClick:()=>M(a.id),disabled:N===a.id,className:"px-3 py-1 bg-purple-600 hover:bg-purple-500 rounded text-xs font-medium text-white disabled:opacity-50",children:N===a.id?"...":`${a.cost_units} ðŸª™`}):e.jsx("span",{className:"text-xs text-gray-500",children:a.lockReason})]})},a.id))})]},s))},"upgrades"),n==="customize"&&e.jsx(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-4",children:Object.entries(C).length===0?e.jsx("div",{className:"text-center text-gray-500 py-8",children:"No upgrades owned yet. Visit the Upgrades tab to purchase some!"}):Object.entries(C).map(([s,t])=>{const a=i.equipped_cosmetics[s];return e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:P[s]||s}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>k(s,null),className:`px-3 py-2 rounded-lg text-sm transition-colors ${a?"bg-gray-800 text-gray-400 hover:bg-gray-700":"bg-purple-600 text-white"}`,children:"None"}),t.map(u=>e.jsx("button",{onClick:()=>k(s,u.id),className:`px-3 py-2 rounded-lg text-sm transition-colors ${a===u.id?"bg-purple-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:u.name},u.id))]})]},s)})},"customize"),n==="settings"&&e.jsx(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-4",children:[{key:"is_visible",label:"Show Companion",desc:"Display companion on screen"},{key:"sounds_enabled",label:"Sounds",desc:"Play companion sounds"},{key:"tips_enabled",label:"Tips",desc:"Show training tips (requires ability)"}].map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:s.label}),e.jsx("div",{className:"text-xs text-gray-400",children:s.desc})]}),e.jsx("button",{onClick:()=>h({[s.key]:!i[s.key]}),className:`w-12 h-6 rounded-full transition-colors ${i[s.key]?"bg-purple-600":"bg-gray-600"}`,children:e.jsx("div",{className:`w-5 h-5 rounded-full bg-white shadow-md transform transition-transform ${i[s.key]?"translate-x-6":"translate-x-0.5"}`})})]},s.key))},"settings")]})}),e.jsx(S,{children:v&&e.jsx(r.div,{className:`absolute bottom-4 left-1/2 -translate-x-1/2 px-4 py-2 rounded-lg text-sm font-medium ${v.type==="error"?"bg-red-500":"bg-green-500"} text-white shadow-lg`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},children:v.text})})]})]})}export{Y as default};
