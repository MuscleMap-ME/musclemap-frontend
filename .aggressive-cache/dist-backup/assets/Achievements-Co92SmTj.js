import{r,j as e,d as F,L as V}from"./react-vendor-D1NxaRNd.js";import{c as m}from"./recharts-vendor-BziRPEEi.js";import{y as G,m as b,A as I}from"./index-VPOrxyVC.js";import{C as z}from"./LevelUpEffect-JXYMdR_8.js";import"./LootDrop-VXQift-K.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./d3-vendor-mcDw60ct.js";import"./apollo-vendor-D9c7jRvS.js";import"./reactflow-vendor-Dz2P_-Qa.js";const K=({isOpen:c,onClose:p,newLevel:n,rewards:j=[],title:x="Level Up!"})=>{const[o,u]=r.useState(0);return r.useEffect(()=>{if(c){u(0);const h=setTimeout(()=>u(1),100),f=setTimeout(()=>u(2),500),k=setTimeout(()=>u(3),800);return()=>{clearTimeout(h),clearTimeout(f),clearTimeout(k)}}},[c]),c?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:`absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity duration-300 ${o>=1?"opacity-100":"opacity-0"}`,onClick:p}),e.jsxs("div",{className:`relative w-full max-w-sm bg-gradient-to-br from-purple-900 to-pink-900 rounded-3xl p-6 text-center transform transition-all duration-500 ${o>=1?"scale-100 opacity-100":"scale-75 opacity-0"}`,children:[e.jsx("div",{className:`text-6xl mb-4 transition-all duration-500 ${o>=2?"scale-100 opacity-100":"scale-50 opacity-0"}`,children:"ðŸŽ‰"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:x}),e.jsxs("p",{className:"text-slate-300 mb-6",children:["You've reached level ",n]}),e.jsx("div",{className:`w-24 h-24 mx-auto rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-4xl font-bold text-white mb-6 shadow-lg shadow-purple-500/50 transition-all duration-700 ${o>=2?"scale-100":"scale-0"}`,style:{animation:o>=2?"pulse 2s ease-in-out infinite":"none"},children:n}),j.length>0&&e.jsxs("div",{className:`space-y-2 mb-6 transition-all duration-500 delay-200 ${o>=3?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Rewards Unlocked"}),j.map((h,f)=>e.jsxs("div",{className:"py-2 px-4 rounded-xl bg-white/10 flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-xl",children:h.icon}),e.jsx("span",{className:"text-white font-medium",children:h.name})]},f))]}),e.jsx("button",{onClick:p,className:`w-full py-3 rounded-xl bg-white text-purple-900 font-bold hover:bg-white/90 transition-all duration-300 ${o>=3?"opacity-100":"opacity-0"}`,children:"Continue"})]}),e.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.05); }
        }
      `})]}):null},i={Back:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 19l-7-7 7-7"})}),Check:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),Lock:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),Trophy:()=>e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M5 3a1 1 0 011-1h12a1 1 0 011 1v2h2a1 1 0 011 1v3a4 4 0 01-4 4h-.535c-.578 1.74-2.032 3.034-3.798 3.465A3.99 3.99 0 0113 19.17V21h2a1 1 0 110 2H9a1 1 0 110-2h2v-1.83c-.796-.137-1.531-.471-2.167-.965C7.032 13.034 5.578 11.74 5 10H4.535A4 4 0 01.535 6V3a1 1 0 011-1h2V3zm14 3v3a2 2 0 002-2V6h-2zM4 6v3a2 2 0 002 2V6H4z"})}),Sparkle:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),Close:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})}),Shield:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),Video:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})},g={streak:{label:"Streak",icon:"ðŸ”¥",color:"from-orange-500 to-red-600"},volume:{label:"Volume",icon:"ðŸ‹ï¸",color:"from-blue-500 to-cyan-600"},pr:{label:"Personal Records",icon:"ðŸ†",color:"from-amber-400 to-orange-500"},consistency:{label:"Consistency",icon:"ðŸ“…",color:"from-green-500 to-emerald-600"},community:{label:"Community",icon:"ðŸ‘¥",color:"from-purple-500 to-violet-600"},special:{label:"Special",icon:"â­",color:"from-pink-500 to-rose-600"},workout:{label:"Workout",icon:"ðŸ’ª",color:"from-blue-500 to-indigo-600"},social:{label:"Social",icon:"ðŸ¤",color:"from-teal-500 to-cyan-600"},trainer:{label:"Trainer",icon:"ðŸ‹ï¸â€â™‚ï¸",color:"from-amber-500 to-yellow-600"},leaderboard:{label:"Leaderboard",icon:"ðŸ“Š",color:"from-violet-500 to-purple-600"},goal:{label:"Goals",icon:"ðŸŽ¯",color:"from-emerald-500 to-green-600"}},v={1:{label:"Bronze",color:"from-amber-700 to-amber-900",border:"border-amber-700/50"},2:{label:"Silver",color:"from-gray-400 to-gray-600",border:"border-gray-400/50"},3:{label:"Gold",color:"from-amber-400 to-yellow-600",border:"border-amber-400/50"},4:{label:"Platinum",color:"from-cyan-400 to-blue-600",border:"border-cyan-400/50"},5:{label:"Diamond",color:"from-violet-400 to-purple-600",border:"border-violet-400/50"}},q=c=>{try{return new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return c}};function le(){const{token:c}=G(),p=F(),[n,j]=r.useState([]),[x,o]=r.useState([]),[u,h]=r.useState(null),[f,k]=r.useState(!0),[C,E]=r.useState("all"),[s,y]=r.useState(null),[L,T]=r.useState("all"),[U,M]=r.useState(!1),[D,P]=r.useState(null);r.useEffect(()=>{B()},[]);const B=async()=>{try{const t={Authorization:`Bearer ${c}`},[a,d,S]=await Promise.all([fetch("/api/achievements/definitions",{headers:t}),fetch("/api/me/achievements",{headers:t}),fetch("/api/me/achievements/summary",{headers:t})]),[A,w,H]=await Promise.all([a.json(),d.json(),S.json()]);j(A.data||[]),o(w.data||[]),h(H.data)}catch{}finally{k(!1)}},l=new Set(x.map(t=>t.achievementKey||t.achievement_key)),_=x.reduce((t,a)=>(t[a.achievementKey||a.achievement_key]=a,t),{}),$=["all",...new Set(n.map(t=>t.category))],R=(()=>{let t=n;return C!=="all"&&(t=t.filter(a=>a.category===C)),L==="earned"?t=t.filter(a=>l.has(a.key)):L==="locked"&&(t=t.filter(a=>!l.has(a.key))),t})(),N=x.reduce((t,a)=>t+(a.creditsEarned||a.credits_earned||0),0),W=x.reduce((t,a)=>t+(a.xpEarned||a.xp_earned||0),0);return f?e.jsx("div",{className:"min-h-screen bg-[#0a0a0f] flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-violet-500 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"min-h-screen bg-[#0a0a0f] text-white pb-8",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-[#0a0a0f]/80 backdrop-blur-xl border-b border-white/5",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 h-16 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{to:"/dashboard",className:"p-2 -ml-2 rounded-xl hover:bg-white/5",children:e.jsx(i.Back,{})}),e.jsx("h1",{className:"text-xl font-semibold",children:"Achievements"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs(V,{to:"/achievements/my-verifications",className:"flex items-center gap-2 px-3 py-1 bg-white/5 hover:bg-white/10 rounded-full text-gray-300 transition-colors",children:[e.jsx(i.Video,{}),e.jsx("span",{className:"hidden sm:inline",children:"Verifications"})]}),e.jsxs("span",{className:"px-3 py-1 bg-violet-600/20 rounded-full text-violet-400 font-medium",children:[l.size,"/",n.length]})]})]})}),e.jsxs("main",{className:"max-w-5xl mx-auto px-4 py-6",children:[e.jsxs(b.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-violet-600 to-purple-700 rounded-2xl p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-white/20 flex items-center justify-center text-3xl",children:"ðŸ†"}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold",children:[l.size," Achievements"]}),e.jsxs("p",{className:"text-white/70",children:[(l.size/n.length*100).toFixed(0),"% Complete"]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"h-3 bg-black/30 rounded-full overflow-hidden",children:e.jsx(b.div,{initial:{width:0},animate:{width:`${l.size/n.length*100}%`},className:"h-full bg-white/80 rounded-full"})})}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-black/20 rounded-xl p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:l.size}),e.jsx("div",{className:"text-xs text-white/70",children:"Earned"})]}),e.jsxs("div",{className:"bg-black/20 rounded-xl p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:N.toLocaleString()}),e.jsx("div",{className:"text-xs text-white/70",children:"Credits"})]}),e.jsxs("div",{className:"bg-black/20 rounded-xl p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:W.toLocaleString()}),e.jsx("div",{className:"text-xs text-white/70",children:"XP"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Active Challenges"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(z,{challenge:{id:"achievement-hunter",type:{id:"achievement_hunter",title:"Achievement Hunter",icon:"ðŸ†"},difficulty:"medium",description:"Unlock 5 achievements this week",currentProgress:l.size%5,target:5,isComplete:l.size%5>=5,isClaimed:!1,percentage:l.size%5/5*100,rewards:{xp:250,credits:100}}}),e.jsx(z,{challenge:{id:"consistency-king",type:{id:"consistency_king",title:"Consistency King",icon:"ðŸ”¥"},difficulty:"easy",description:"Log workouts 5 days in a row",currentProgress:3,target:5,isComplete:!1,isClaimed:!1,percentage:3/5*100,rewards:{xp:150,credits:50}}}),e.jsx(z,{challenge:{id:"master-collector",type:{id:"master_collector",title:"Master Collector",icon:"ðŸ’Ž"},difficulty:"hard",description:"Earn 1,000 credits from achievements",currentProgress:Math.min(N,1e3),target:1e3,isComplete:N>=1e3,isClaimed:!1,percentage:Math.min(N/1e3*100,100),rewards:{xp:500,credits:250}}})]})]}),e.jsx("div",{className:"flex gap-1 p-1 bg-white/5 rounded-xl mb-4",children:["all","earned","locked"].map(t=>e.jsxs("button",{onClick:()=>T(t),className:m("flex-1 py-2.5 text-sm font-medium rounded-lg transition-all capitalize",L===t?"bg-white/10 text-white":"text-gray-400 hover:text-white"),children:[t,t==="earned"&&e.jsxs("span",{className:"ml-1 text-xs text-violet-400",children:["(",l.size,")"]}),t==="locked"&&e.jsxs("span",{className:"ml-1 text-xs text-gray-500",children:["(",n.length-l.size,")"]})]},t))}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 mb-6 scrollbar-hide",children:$.map(t=>{const a=g[t]||{label:t,icon:"ðŸ“‹"};return e.jsxs("button",{onClick:()=>E(t),className:m("flex items-center gap-2 px-4 py-2 rounded-xl whitespace-nowrap transition-all capitalize",C===t?"bg-violet-600 text-white":"bg-white/5 text-gray-400 hover:text-white hover:bg-white/10"),children:[e.jsx("span",{children:t==="all"?"ðŸ†":a.icon}),e.jsx("span",{className:"text-sm font-medium",children:t==="all"?"All":a.label})]},t)})}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:R.map((t,a)=>{const d=l.has(t.key),S=_[t.key],A=g[t.category]||g.special,w=v[t.tier]||v[1];return e.jsx(b.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:a*.03},onClick:()=>y({...t,earned:d,earnedData:S}),className:m("relative overflow-hidden rounded-2xl border cursor-pointer transition-all hover:scale-[1.02]",d?`bg-gradient-to-br ${w.color} ${w.border}`:"bg-white/5 border-white/10 opacity-60"),children:e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("div",{className:m("w-16 h-16 mx-auto rounded-full flex items-center justify-center text-3xl mb-3",d?"bg-black/30":"bg-white/5"),children:d?A.icon:e.jsx(i.Lock,{className:"w-6 h-6 text-gray-500"})}),e.jsx("h3",{className:"font-semibold text-sm mb-1 line-clamp-1",children:t.name}),d?e.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs",children:[e.jsx(i.Check,{className:"w-3 h-3"}),e.jsx("span",{children:"Earned"})]}):e.jsx("div",{className:"text-xs text-gray-500",children:"Locked"}),t.creditsReward>0&&e.jsxs("div",{className:"mt-2 flex items-center justify-center gap-1 text-xs",children:[e.jsx(i.Sparkle,{className:"w-3 h-3 text-amber-400"}),e.jsx("span",{className:"text-amber-400",children:t.creditsReward})]})]})},t.key)})}),R.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx(i.Trophy,{className:"w-12 h-12 mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No achievements found"})]})]}),e.jsx(I,{children:s&&e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>y(null),children:e.jsxs(b.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:t=>t.stopPropagation(),className:"bg-[#12121a] border border-white/10 rounded-2xl w-full max-w-md overflow-hidden",children:[e.jsx("div",{className:m("h-32 bg-gradient-to-br flex items-center justify-center relative",s.earned?v[s.tier]?.color||"from-amber-700 to-amber-900":"from-gray-700 to-gray-900"),children:e.jsx("div",{className:"text-6xl",children:s.earned?g[s.category]?.icon||"ðŸ†":"ðŸ”’"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:m("px-2 py-0.5 text-xs font-medium rounded-full",s.earned?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"),children:s.earned?"Earned":"Locked"}),e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-white/10",children:g[s.category]?.label||s.category}),s.tier>1&&e.jsx("span",{className:m("px-2 py-0.5 text-xs font-medium rounded-full bg-gradient-to-r text-white",v[s.tier]?.color),children:v[s.tier]?.label})]}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:s.name}),e.jsx("p",{className:"text-gray-400 mb-6",children:s.description}),(s.creditsReward>0||s.xpReward>0)&&e.jsxs("div",{className:"p-4 bg-white/5 rounded-xl mb-4",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-2",children:"Rewards"}),e.jsxs("div",{className:"flex items-center gap-4",children:[s.creditsReward>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i.Sparkle,{className:"text-amber-400"}),e.jsxs("span",{className:"font-bold text-amber-400",children:[s.creditsReward," credits"]})]}),s.xpReward>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-violet-400",children:"XP"}),e.jsxs("span",{className:"font-bold text-violet-400",children:["+",s.xpReward]})]})]})]}),s.earned&&s.earnedData&&e.jsxs("div",{className:"p-4 bg-green-500/10 border border-green-500/30 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-400 mb-2",children:[e.jsx(i.Check,{}),e.jsx("span",{className:"font-medium",children:"Achievement Unlocked!"}),s.earnedData.isVerified&&e.jsxs("span",{className:"flex items-center gap-1 ml-2 px-2 py-0.5 bg-violet-500/20 rounded-full text-xs text-violet-400",children:[e.jsx(i.Shield,{})," Verified"]})]}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Earned on ",q(s.earnedData.earnedAt||s.earnedData.earned_at)]}),s.earnedData.witnessUsername&&e.jsxs("p",{className:"text-sm text-violet-400 mt-1",children:["Witnessed by @",s.earnedData.witnessUsername]})]}),!s.earned&&e.jsxs("div",{className:"space-y-4",children:[s.requiresVerification&&e.jsxs("div",{className:"p-4 bg-violet-500/10 border border-violet-500/30 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-violet-400 mb-2",children:[e.jsx(i.Shield,{}),e.jsx("span",{className:"font-medium",children:"Verification Required"})]}),e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"This elite achievement requires video proof and a witness to verify you've completed it."}),e.jsx("button",{onClick:()=>{y(null),p(`/achievements/verify/${s.id}`)},className:"w-full py-2 bg-violet-600 hover:bg-violet-500 rounded-lg text-sm font-medium transition-colors",children:"Submit Verification"})]}),e.jsxs("div",{className:"p-4 bg-white/5 rounded-xl",children:[e.jsx("h4",{className:"text-sm text-gray-400 mb-2",children:"How to Unlock"}),e.jsx("p",{className:"text-sm",children:s.unlockHint||s.description||"Keep training to unlock this achievement!"})]})]})]}),e.jsx("button",{onClick:()=>y(null),className:"absolute top-4 right-4 p-2 rounded-xl bg-black/20 hover:bg-black/40 transition-all",children:e.jsx(i.Close,{})})]})})}),e.jsx(K,{isOpen:U,onClose:()=>M(!1),level:D?.level||1,rewards:D?.rewards||[],onContinue:()=>{M(!1),P(null)}})]})}export{le as default};
