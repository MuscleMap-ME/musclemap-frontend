const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MuscleViewer3D-DdXje5d6.js","assets/react-vendor-D1NxaRNd.js","assets/react-three-fiber.esm-D1eZaWCs.js","assets/registry-BJzQzt3L.js","assets/index-CcFWR5Kg.js","assets/leaflet-vendor-CIGW-MKW.css","assets/reactflow-vendor-B5DZHykP.css","assets/index-C0Iv8zkE.css"])))=>i.map(i=>d[i]);
import{aj as E,A as P,m as y,b1 as $,_ as B}from"./index-CcFWR5Kg.js";import{r as i,j as t}from"./react-vendor-D1NxaRNd.js";import{c as w}from"./recharts-vendor-BziRPEEi.js";const k="musclemap:visualization-preference";function R(){if(typeof window>"u")return!1;try{const e=document.createElement("canvas");return!!(e.getContext("webgl2")||e.getContext("webgl"))}catch{return!1}}function W(){if(typeof window>"u")return null;try{const e=document.createElement("canvas"),r=e.getContext("webgl2")||e.getContext("webgl");if(!r)return null;const a=r.getExtension("WEBGL_debug_renderer_info");return a?{renderer:r.getParameter(a.UNMASKED_RENDERER_WEBGL)||"unknown",vendor:r.getParameter(a.UNMASKED_VENDOR_WEBGL)||"unknown"}:{renderer:"unknown",vendor:"unknown"}}catch{return null}}function U(e){if(!e)return"low";const r=e.renderer.toLowerCase();return r.includes("nvidia")||r.includes("radeon")||r.includes("apple m")||r.includes("apple gpu")?"high":r.includes("intel")||r.includes("adreno")||r.includes("mali")?"medium":r.includes("swiftshader")||r.includes("llvmpipe")||r.includes("software")?"low":"medium"}function Z(e,r,a){return e==="low"||r<4||a==="2g"||a==="slow-2g"?"low":a==="3g"?"medium":e==="high"&&r>=8?"high":"medium"}function V(){const[e,r]=i.useState(()=>{if(typeof window>"u")return"auto";const n=localStorage.getItem(k);return n==="always-3d"||n==="always-2d"||n==="auto"?n:"auto"}),[a]=i.useState(()=>{const n=R(),o=W(),c=U(o),d=typeof navigator<"u"&&navigator.deviceMemory||4;return{supportsWebGL:n,gpuInfo:o,gpuTier:c,deviceMemory:d}}),[s,f]=i.useState(()=>typeof navigator>"u"?void 0:navigator.connection?.effectiveType);i.useEffect(()=>{if(typeof navigator>"u")return;const n=navigator.connection;if(!n)return;const o=()=>{f(n.effectiveType)};return n.addEventListener("change",o),()=>n.removeEventListener("change",o)},[]);const L=i.useCallback(n=>{r(n),typeof window<"u"&&localStorage.setItem(k,n)},[]);return{...i.useMemo(()=>{const{supportsWebGL:n,gpuTier:o,deviceMemory:c}=a;return e==="always-2d"?{use3D:!1,lod:"low",preference:e,supportsWebGL:n,reason:"User preference set to 2D"}:e==="always-3d"?n?{use3D:!0,lod:Z(o,c,s),preference:e,supportsWebGL:n,reason:"User preference set to 3D"}:{use3D:!1,lod:"low",preference:e,supportsWebGL:n,reason:"Device does not support WebGL"}:n?c<4?{use3D:!1,lod:"low",preference:e,supportsWebGL:n,reason:"Low device memory (<4GB)"}:s==="2g"||s==="slow-2g"?{use3D:!1,lod:"low",preference:e,supportsWebGL:n,reason:"Slow network connection"}:o==="low"?{use3D:!1,lod:"low",preference:e,supportsWebGL:n,reason:"Low GPU capability"}:{use3D:!0,lod:Z(o,c,s),preference:e,supportsWebGL:n,reason:`Auto-detected ${o} GPU, ${c}GB memory`}:{use3D:!1,lod:"low",preference:e,supportsWebGL:n,reason:"WebGL not supported"}},[a,e,s]),setPreference:L}}const q={compact:{width:120,height:160},card:{width:200,height:280},fullscreen:{width:"100%",height:"100%"},inline:{width:80,height:100}};function F({mode:e="card",className:r}){const a=q[e],s=e==="fullscreen";return t.jsxs("div",{className:w("relative overflow-hidden rounded-xl","bg-gradient-to-b from-[var(--void-deep,#0a0f1a)] to-[var(--void-deeper,#050810)]",s&&"w-full h-full min-h-[400px]",r),style:{width:s?"100%":a.width,height:s?"100%":a.height},children:[t.jsx("div",{className:"absolute inset-0 -translate-x-full animate-[shimmer_2s_infinite]",style:{background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.04), transparent)"}}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:t.jsxs("svg",{viewBox:"0 0 100 200",className:"w-full h-full max-w-[60%] max-h-[80%] opacity-20",preserveAspectRatio:"xMidYMid meet",children:[t.jsx("ellipse",{cx:"50",cy:"20",rx:"12",ry:"15",fill:"currentColor",className:"text-[var(--text-quaternary,#475569)]"}),t.jsx("rect",{x:"45",y:"33",width:"10",height:"8",rx:"2",fill:"currentColor",className:"text-[var(--text-quaternary,#475569)]"}),t.jsx("path",{d:"M30 45 L70 45 L68 120 L32 120 Z",fill:"currentColor",className:"text-[var(--text-quaternary,#475569)]"}),t.jsx("path",{d:"M30 45 L20 48 L15 90 L20 92 L28 55",fill:"currentColor",className:"text-[var(--text-quaternary,#475569)]"}),t.jsx("path",{d:"M70 45 L80 48 L85 90 L80 92 L72 55",fill:"currentColor",className:"text-[var(--text-quaternary,#475569)]"}),t.jsx("path",{d:"M35 120 L30 180 L38 182 L45 125",fill:"currentColor",className:"text-[var(--text-quaternary,#475569)]"}),t.jsx("path",{d:"M65 120 L70 180 L62 182 L55 125",fill:"currentColor",className:"text-[var(--text-quaternary,#475569)]"})]})}),e!=="inline"&&t.jsxs("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 flex items-center gap-2",children:[t.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-[var(--electric-blue,#0066ff)] animate-pulse"}),t.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-[var(--electric-blue,#0066ff)] animate-pulse animation-delay-150"}),t.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-[var(--electric-blue,#0066ff)] animate-pulse animation-delay-300"})]})]})}const O={front:{chest:{path:"M35 55 Q40 50 50 52 Q60 50 65 55 L63 70 Q50 75 37 70 Z",center:[50,62]},abs:{path:"M40 72 L60 72 L58 110 L42 110 Z",center:[50,90]},obliques:{path:"M35 70 L40 72 L42 110 L35 108 Z M60 72 L65 70 L65 108 L58 110 Z",center:[50,90]},front_delts:{path:"M30 52 L35 55 L35 65 L28 63 Z M65 55 L70 52 L72 63 L65 65 Z",center:[50,58]},biceps:{path:"M25 65 L30 63 L28 85 L22 83 Z M70 63 L75 65 L78 83 L72 85 Z",center:[50,74]},forearms:{path:"M22 85 L28 87 L25 115 L18 112 Z M72 87 L78 85 L82 112 L75 115 Z",center:[50,100]},quads:{path:"M38 115 L48 113 L47 160 L35 158 Z M52 113 L62 115 L65 158 L53 160 Z",center:[50,136]},hip_flexors:{path:"M42 110 L50 112 L58 110 L55 118 L50 120 L45 118 Z",center:[50,115]},adductors:{path:"M45 120 L50 118 L55 120 L53 145 L50 148 L47 145 Z",center:[50,133]}},back:{upper_back:{path:"M38 52 L50 50 L62 52 L60 70 L50 72 L40 70 Z",center:[50,60]},lats:{path:"M32 65 L40 70 L40 95 L35 90 Z M60 70 L68 65 L65 90 L60 95 Z",center:[50,80]},lower_back:{path:"M40 92 L60 92 L58 112 L42 112 Z",center:[50,102]},rear_delts:{path:"M28 52 L35 55 L35 62 L27 58 Z M65 55 L72 52 L73 58 L65 62 Z",center:[50,56]},traps:{path:"M40 42 L50 38 L60 42 L58 52 L50 50 L42 52 Z",center:[50,46]},triceps:{path:"M25 63 L32 65 L30 88 L23 85 Z M68 65 L75 63 L77 85 L70 88 Z",center:[50,75]},glutes:{path:"M38 110 L50 108 L62 110 L60 130 L50 132 L40 130 Z",center:[50,120]},hamstrings:{path:"M38 132 L48 130 L47 165 L35 163 Z M52 130 L62 132 L65 163 L53 165 Z",center:[50,148]},calves:{path:"M36 165 L45 163 L43 190 L34 188 Z M55 163 L64 165 L66 188 L57 190 Z",center:[50,177]}}};function T(e){if(e<=0)return"rgba(100, 80, 80, 0.4)";if(e<.25){const r=e*4;return`rgba(${Math.round(50)}, ${Math.round(50+r*130)}, ${Math.round(200)}, 0.7)`}else if(e<.5){const r=(e-.25)*4;return`rgba(${Math.round(r*255)}, ${Math.round(180)}, ${Math.round(200-r*200)}, 0.8)`}else if(e<.75){const r=(e-.5)*4;return`rgba(${Math.round(255)}, ${Math.round(180-r*80)}, ${Math.round(0)}, 0.85)`}else{const r=(e-.75)*4;return`rgba(${Math.round(255)}, ${Math.round(100-r*100)}, ${Math.round(0)}, 0.9)`}}function z({muscleId:e,path:r,center:a,intensity:s,isHovered:f,isSelected:L,showLabel:x,onClick:n,onHover:o}){const c=E(),d=T(s),h=e.replace(/_/g," ").replace(/\b\w/g,u=>u.toUpperCase());return t.jsxs("g",{onClick:()=>n(e),onMouseEnter:()=>o(e),onMouseLeave:()=>o(null),style:{cursor:"pointer"},children:[s>.5&&t.jsx(y.path,{d:r,fill:d,filter:"blur(4px)",opacity:s*.5,initial:!1,animate:{opacity:s*.5}}),t.jsx(y.path,{d:r,fill:d,stroke:L?"#0066ff":f?"#88aaff":"rgba(255,255,255,0.2)",strokeWidth:L||f?1.5:.5,initial:!1,animate:{fill:d,strokeWidth:L||f?1.5:.5},transition:{duration:c?.2:0}}),x&&f&&t.jsxs("g",{children:[t.jsx("rect",{x:a[0]-20,y:a[1]-8,width:40,height:12,rx:2,fill:"rgba(0,0,0,0.8)"}),t.jsx("text",{x:a[0],y:a[1]+1,textAnchor:"middle",fontSize:"5",fill:"white",fontFamily:"Inter, system-ui, sans-serif",children:h})]})]})}function K({view:e}){const r="M50 15 Q35 20 30 35 L25 50 Q20 55 18 70 L20 90 Q22 100 25 115 L35 115 L35 160 Q33 175 34 190 L38 195 L45 195 L47 190 Q48 175 47 160 L50 155 L53 160 Q52 175 53 190 L55 195 L62 195 L66 190 Q67 175 65 160 L65 115 L75 115 Q78 100 80 90 L82 70 Q80 55 75 50 L70 35 Q65 20 50 15";return t.jsxs(t.Fragment,{children:[t.jsx("path",{d:r,fill:"rgba(71, 85, 105, 0.08)",stroke:"none"}),t.jsx("path",{d:r,fill:"none",stroke:"rgba(148, 163, 184, 0.25)",strokeWidth:"0.8",strokeLinecap:"round",strokeLinejoin:"round"})]})}function N({muscles:e,mode:r="card",interactive:a=!0,showLabels:s=!0,autoRotate:f=!1,initialView:L="front",colorScheme:x="heatmap",onMuscleClick:n,onMuscleHover:o,className:c,style:d}){const h=E(),[u,g]=i.useState(L==="back"?"back":"front"),[v,M]=i.useState(null),[j,m]=i.useState(null),_=i.useMemo(()=>{const l={};return e.forEach(({id:p,intensity:b,isPrimary:G})=>{const A=G!==!1?b:b*.5;l[p]=Math.max(l[p]||0,A)}),l},[e]),C=i.useCallback(l=>{a&&(m(p=>p===l?null:l),n?.(l))},[a,n]),D=i.useCallback(l=>{a&&(M(l),o?.(l))},[a,o]),S={compact:{width:120,height:160},card:{width:200,height:280},fullscreen:{width:"100%",height:"100%",minHeight:400},inline:{width:80,height:100}},Q=O[u];return t.jsxs("div",{className:w("relative rounded-xl overflow-hidden","bg-gradient-to-b from-[var(--void-deep,#0a0f1a)] to-[var(--void-deeper,#050810)]",c),style:{...S[r],...d},children:[t.jsx("div",{className:"absolute top-2 left-1/2 -translate-x-1/2 z-10",children:t.jsx("span",{className:"px-2 py-0.5 text-[10px] font-medium text-white/50 bg-white/5 rounded-full",children:u==="front"?"Front":"Back"})}),t.jsx(P,{mode:"wait",children:t.jsxs(y.svg,{viewBox:"0 0 100 200",className:"w-full h-full",preserveAspectRatio:"xMidYMid meet",initial:h?{opacity:0,x:u==="front"?-20:20}:!1,animate:{opacity:1,x:0},exit:h?{opacity:0,x:u==="front"?20:-20}:void 0,transition:{duration:.3},children:[t.jsx("defs",{children:t.jsxs("filter",{id:"muscle-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"2",result:"blur"}),t.jsx("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]})}),t.jsx(K,{view:u}),t.jsx("ellipse",{cx:"50",cy:"22",rx:"10",ry:"12",fill:"rgba(71, 85, 105, 0.2)",stroke:"rgba(148, 163, 184, 0.3)",strokeWidth:"0.8"}),Object.entries(Q).map(([l,{path:p,center:b}])=>t.jsx(z,{muscleId:l,path:p,center:b,intensity:_[l]||0,isHovered:v===l,isSelected:j===l,showLabel:s,onClick:C,onHover:D},l))]},u)}),(r==="card"||r==="fullscreen")&&a&&t.jsxs("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1",children:[t.jsx("button",{onClick:()=>g("front"),className:w("px-2 py-1 text-xs rounded transition-colors",u==="front"?"bg-[var(--electric-blue,#0066ff)] text-white":"bg-white/10 text-white/70 hover:bg-white/20"),children:"Front"}),t.jsx("button",{onClick:()=>g("back"),className:w("px-2 py-1 text-xs rounded transition-colors",u==="back"?"bg-[var(--electric-blue,#0066ff)] text-white":"bg-white/10 text-white/70 hover:bg-white/20"),children:"Back"})]})]})}const Y=i.lazy(()=>B(()=>import("./MuscleViewer3D-DdXje5d6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])));function H({muscles:e,mode:r,className:a,...s}){return t.jsxs("div",{className:w("relative",a),children:[t.jsx(N,{muscles:e,mode:r,...s}),t.jsx("div",{className:"absolute top-2 right-2 px-2 py-1 text-[10px] bg-yellow-500/20 text-yellow-300 rounded",children:"2D Fallback"})]})}function ee({muscles:e,mode:r="card",interactive:a=!0,showLabels:s=!0,autoRotate:f=!1,initialView:L="front",colorScheme:x="heatmap",forceLod:n,forceMode:o,onMuscleClick:c,onMuscleHover:d,className:h,style:u}){const{use3D:g,lod:v}=V(),M=i.useMemo(()=>o==="2d"?!1:o==="3d"?!0:g,[o,g]),j=n||v,m={muscles:e,mode:r,interactive:a,showLabels:s,autoRotate:f,initialView:L,colorScheme:x,onMuscleClick:c,onMuscleHover:d,className:h,style:u};return M?t.jsx($,{name:"MuscleViewer3D",fallback:t.jsx(H,{...m}),children:t.jsx(i.Suspense,{fallback:t.jsx(F,{mode:r,className:h}),children:t.jsx(Y,{...m,lod:j})})}):t.jsx(N,{...m})}export{ee as M,F as a};
