const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ReadinessTrendChart-B3nF8KzO.js","assets/react-vendor-D847gc3Q.js","assets/index-Ii7_m7xX.js","assets/trending-down-BBi7oAx1.js","assets/minus-DwFahz13.js","assets/leaflet-vendor-CIGW-MKW.css","assets/reactflow-vendor-B5DZHykP.css","assets/index-B4enjUNU.css"])))=>i.map(i=>d[i]);
import{e as z,i as x,m as j,_ as Y,A as J}from"./index-Ii7_m7xX.js";import{l as K,u as Q,r as l,j as e,L as p}from"./react-vendor-D847gc3Q.js";import{G as d}from"./GlassSurface-DZwHl8aR.js";import{G as m}from"./GlassButton-DjCB8_4V.js";import{G as b,d as f}from"./GlassNav-JV0Z4HsU.js";import{M as N}from"./MeshBackground-BqbFOsCF.js";import{S as X,C as Z}from"./SkeletonStats-nm85TlGY.js";import"./apollo-vendor-BNHFeEEc.js";import"./reactflow-vendor-5ig9bY2l.js";import"./d3-vendor-DkU_Wy0v.js";import"./recharts-vendor-d8oTApeF.js";import"./leaflet-vendor-DZbo3Ov0.js";const ee=l.lazy(()=>Y(()=>import("./ReadinessTrendChart-B3nF8KzO.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])).catch(()=>({default:()=>null}))),i={Target:({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),Plus:({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),ChevronLeft:({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),AlertTriangle:({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),Dumbbell:({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 7h16M4 17h16M6 12h12M7 7v10m10-10v10"})}),Refresh:({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),Trash:({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Home:({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),Clipboard:({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),User:({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})},y={military:{color:"#556B2F",icon:null,label:"Military"},firefighter:{color:"#B22222",icon:null,label:"Firefighter"},law_enforcement:{color:"#191970",icon:null,label:"Law Enforcement"},special_operations:{color:"#4B0082",icon:null,label:"Special Operations"},civil_service:{color:"#2F4F4F",icon:null,label:"Civil Service"},general:{color:"#6366f1",icon:null,label:"General Fitness"}},u={ready:{bg:"bg-emerald-500/20",text:"text-emerald-400",label:"Ready",color:"#10b981"},at_risk:{bg:"bg-amber-500/20",text:"text-amber-400",label:"At Risk",color:"#f59e0b"},not_ready:{bg:"bg-red-500/20",text:"text-red-400",label:"Not Ready",color:"#ef4444"},no_data:{bg:"bg-gray-500/20",text:"text-gray-400",label:"No Data",color:"#6b7280"}};function se({score:s,status:o,size:n=180}){const a=(n-16)/2,c=2*Math.PI*a,r=s!==null?s/100*c:0,h=u[o]||u.no_data;return e.jsxs("div",{className:"relative",style:{width:n,height:n},children:[e.jsxs("svg",{className:"transform -rotate-90",width:n,height:n,children:[e.jsx("circle",{cx:n/2,cy:n/2,r:a,fill:"none",stroke:"currentColor",strokeWidth:"12",className:"text-white/10"}),e.jsx(j.circle,{cx:n/2,cy:n/2,r:a,fill:"none",stroke:h.color,strokeWidth:"12",strokeLinecap:"round",strokeDasharray:c,strokeDashoffset:c-r,initial:{strokeDashoffset:c},animate:{strokeDashoffset:c-r},transition:{duration:1,ease:"easeOut"}})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-4xl font-black text-[var(--text-primary)]",children:s!==null?`${s}%`:"-"}),e.jsx("span",{className:`text-sm font-semibold ${h.text}`,children:h.label})]})]})}function te({event:s,percentage:o,isPassing:n}){return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-[var(--text-secondary)]",children:s.name}),e.jsxs("span",{className:n?"text-emerald-400":"text-red-400",children:[s.currentValue||"-"," / ",s.passingValue," ",s.unit]})]}),e.jsx("div",{className:"h-2 bg-[var(--glass-white-10)] rounded-full overflow-hidden",children:e.jsx(j.div,{initial:{width:0},animate:{width:`${Math.min(o,100)}%`},transition:{duration:.5,delay:.1},className:`h-full rounded-full ${n?"bg-emerald-500":"bg-red-500"}`})})]})}function ae({isOpen:s,onClose:o,onConfirm:n,goalName:a,loading:c}){return s?e.jsx(J,{children:e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:o,children:e.jsxs(j.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"w-full max-w-md bg-[var(--void-base)] border border-[var(--border-subtle)] rounded-2xl p-6",onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-500/20 flex items-center justify-center",children:e.jsx(i.Trash,{className:"w-6 h-6 text-red-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-[var(--text-primary)]",children:"Delete Goal?"}),e.jsx("p",{className:"text-sm text-[var(--text-tertiary)]",children:"This action cannot be undone"})]})]}),e.jsxs("p",{className:"text-[var(--text-secondary)] mb-6",children:["Are you sure you want to delete ",e.jsx("span",{className:"font-semibold",children:a}),"? All progress tracking data will be lost."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(m,{variant:"ghost",className:"flex-1",onClick:o,children:"Cancel"}),e.jsx(m,{variant:"primary",className:"flex-1 !bg-red-500 hover:!bg-red-600",onClick:n,disabled:c,children:c?"Deleting...":"Delete Goal"})]})]})})}):null}const k=[{to:"/dashboard",icon:e.jsx(i.Home,{className:"w-5 h-5"}),label:"Home"},{to:"/career",icon:e.jsx(i.Target,{className:"w-5 h-5"}),label:"Career"},{to:"/pt-tests",icon:e.jsx(i.Clipboard,{className:"w-5 h-5"}),label:"PT Tests"},{to:"/profile",icon:e.jsx(i.User,{className:"w-5 h-5"}),label:"Profile"}];function je(){const{goalId:s}=K(),o=Q(),{user:n}=z(),[a,c]=l.useState(null),[r,h]=l.useState(null),[w,G]=l.useState([]),[C,$]=l.useState([]),[M,W]=l.useState([]),[H,L]=l.useState(!0),[S,D]=l.useState(!1),[V,T]=l.useState(!1),[F,A]=l.useState(!1),_=l.useCallback(async()=>{try{const t=await x.get(`/career/goals/${s}`);c(t.data?.goal||null)}catch{}},[s]),g=l.useCallback(async()=>{try{const t=await x.get(`/career/readiness/${s}`);h(t.data?.readiness||null),$(t.data?.events||[])}catch{}},[s]),R=l.useCallback(async()=>{try{const t=await x.get(`/career/goals/${s}/exercises`);G(t.data?.exercises||[])}catch{}},[s]),B=l.useCallback(async()=>{try{const t=await x.get(`/career/goals/${s}/trend`);W(t.data?.trend||[])}catch{}},[s]);l.useEffect(()=>{(async()=>{L(!0),await Promise.all([_(),g(),R(),B()]),L(!1)})()},[_,g,R,B]);const I=async()=>{D(!0);try{await x.post(`/career/readiness/${s}/refresh`),await g()}catch{}finally{D(!1)}},O=async()=>{A(!0);try{await x.delete(`/career/goals/${s}`),o("/career")}catch{}finally{A(!1)}},U=()=>{o(`/pt-tests?test=${a?.ptTestId}`)},E=a&&y[a.category]||y.general;r&&u[r.status]||u.no_data;const v=a?.targetDate?Math.ceil((new Date(a.targetDate)-new Date)/(1e3*60*60*24)):null;return H?e.jsxs("div",{className:"min-h-screen relative",children:[e.jsx(N,{intensity:"subtle"}),e.jsx(b,{brandSlot:e.jsxs(p,{to:"/dashboard",className:"flex items-center gap-3",children:[e.jsx("img",{src:"/logo.png",alt:"MuscleMap",className:"w-8 h-8 rounded-lg"}),e.jsx("span",{className:"font-bold text-lg text-[var(--text-primary)] hidden sm:block",children:"MuscleMap"})]})}),e.jsxs("main",{className:"pt-20 px-4 lg:px-8 pb-24 lg:pb-8 max-w-4xl mx-auto",children:[e.jsx(X,{count:4}),e.jsx("div",{className:"mt-8",children:e.jsx(Z,{hasHeader:!0,lines:5})})]}),e.jsx(f,{items:k})]}):a?e.jsxs("div",{className:"min-h-screen relative",children:[e.jsx(N,{intensity:"subtle"}),e.jsx(b,{brandSlot:e.jsxs(p,{to:"/dashboard",className:"flex items-center gap-3",children:[e.jsx("img",{src:"/logo.png",alt:"MuscleMap",className:"w-8 h-8 rounded-lg"}),e.jsx("span",{className:"font-bold text-lg text-[var(--text-primary)] hidden sm:block",children:"MuscleMap"})]})}),e.jsxs("main",{className:"pt-20 px-4 lg:px-8 pb-24 lg:pb-8 max-w-4xl mx-auto",children:[e.jsxs(p,{to:"/career",className:"inline-flex items-center gap-2 text-[var(--text-tertiary)] hover:text-[var(--text-primary)] mb-6 transition-colors",children:[e.jsx(i.ChevronLeft,{className:"w-5 h-5"}),"Back to Career"]}),e.jsx(d,{className:"p-6 mb-6",depth:"medium",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center text-3xl flex-shrink-0",style:{backgroundColor:`${E.color}20`},children:a.icon||(a.category==="military"?"ðŸŽ–ï¸":a.category==="firefighter"?"ðŸ”¥":a.category==="law_enforcement"?"ðŸ›¡ï¸":"ðŸ‹ï¸")}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h1",{className:"text-2xl font-black text-[var(--text-primary)]",children:a.testName}),a.priority==="primary"&&e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-[var(--brand-blue-500)]/20 text-[var(--brand-blue-400)]",children:"Primary"})]}),e.jsx("p",{className:"text-[var(--text-secondary)]",children:a.institution||E.label}),a.agencyName&&e.jsx("p",{className:"text-sm text-[var(--text-tertiary)]",children:a.agencyName})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:I,disabled:S,children:e.jsx(i.Refresh,{className:`w-4 h-4 ${S?"animate-spin":""}`})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>T(!0),children:e.jsx(i.Trash,{className:"w-4 h-4 text-red-400"})}),e.jsxs(m,{variant:"primary",onClick:U,children:[e.jsx(i.Plus,{className:"w-5 h-5 mr-2"}),"Log Result"]})]})]})}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(d,{className:"p-6",depth:"subtle",children:[e.jsx("h2",{className:"text-lg font-bold text-[var(--text-primary)] mb-6 text-center",children:"Readiness Score"}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx(se,{score:r?.readinessScore,status:r?.status||"no_data",size:180})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-xl bg-[var(--glass-white-5)] text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-[var(--text-primary)]",children:[r?.eventsPassed||0,"/",r?.eventsTotal||0]}),e.jsx("div",{className:"text-xs text-[var(--text-tertiary)]",children:"Events Passed"})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-[var(--glass-white-5)] text-center",children:[e.jsx("div",{className:"text-xl font-bold text-[var(--text-primary)]",children:v!==null?v>=0?v:0:"-"}),e.jsx("div",{className:"text-xs text-[var(--text-tertiary)]",children:"Days Left"})]})]}),e.jsx("div",{className:"mt-4 p-3 rounded-xl bg-[var(--glass-white-5)]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-[var(--text-tertiary)]",children:"Last Assessment"}),e.jsx("span",{className:"text-sm font-semibold text-[var(--text-primary)]",children:r?.lastAssessmentAt?new Date(r.lastAssessmentAt).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"None"})]})})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(d,{className:"p-6",depth:"subtle",children:[e.jsx("h2",{className:"text-lg font-bold text-[var(--text-primary)] mb-4",children:"Event Breakdown"}),C.length>0?e.jsx("div",{className:"space-y-4",children:C.map(t=>{const P=t.passingValue?t.currentValue/t.passingValue*100:0,q=P>=100;return e.jsx(te,{event:t,percentage:P,isPassing:q},t.id)})}):e.jsx("p",{className:"text-[var(--text-tertiary)] text-center py-4",children:"No event data available. Log a PT test result to see your progress."})]}),r?.weakEvents&&r.weakEvents.length>0&&e.jsxs(d,{className:"p-6",depth:"subtle",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(i.AlertTriangle,{className:"w-5 h-5 text-amber-400"}),e.jsx("h2",{className:"text-lg font-bold text-[var(--text-primary)]",children:"Weak Events"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.weakEvents.map(t=>e.jsx("span",{className:"px-3 py-1.5 rounded-lg text-sm bg-amber-500/20 text-amber-400",children:t},t))}),e.jsx("p",{className:"text-sm text-[var(--text-tertiary)] mt-3",children:"Focus on these events to improve your overall readiness score."})]}),M.length>0&&e.jsxs(d,{className:"p-6",depth:"subtle",children:[e.jsx("h2",{className:"text-lg font-bold text-[var(--text-primary)] mb-4",children:"Progress Trend"}),e.jsx(l.Suspense,{fallback:e.jsx("div",{className:"h-48 flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-[var(--brand-blue-500)] border-t-transparent rounded-full animate-spin"})}),children:e.jsx(ee,{data:M})})]}),w.length>0&&e.jsxs(d,{className:"p-6",depth:"subtle",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(i.Dumbbell,{className:"w-5 h-5 text-[var(--brand-blue-400)]"}),e.jsx("h2",{className:"text-lg font-bold text-[var(--text-primary)]",children:"Recommended Exercises"})]}),e.jsx("div",{className:"space-y-3",children:w.slice(0,5).map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-[var(--glass-white-5)]",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-[var(--text-primary)]",children:t.exerciseName}),e.jsxs("div",{className:"text-xs text-[var(--text-tertiary)]",children:["Targets: ",t.targetEvents?.join(", ")||"General fitness"]})]}),e.jsx(p,{to:`/exercises?search=${encodeURIComponent(t.exerciseName)}`,className:"text-[var(--brand-blue-400)] hover:underline text-sm",children:"View"})]},t.exerciseId))})]}),a.notes&&e.jsxs(d,{className:"p-6",depth:"subtle",children:[e.jsx("h2",{className:"text-lg font-bold text-[var(--text-primary)] mb-3",children:"Notes"}),e.jsx("p",{className:"text-[var(--text-secondary)]",children:a.notes})]})]})]})]}),e.jsx(f,{items:k}),e.jsx(ae,{isOpen:V,onClose:()=>T(!1),onConfirm:O,goalName:a.testName,loading:F})]}):e.jsxs("div",{className:"min-h-screen relative",children:[e.jsx(N,{intensity:"subtle"}),e.jsx(b,{brandSlot:e.jsxs(p,{to:"/dashboard",className:"flex items-center gap-3",children:[e.jsx("img",{src:"/logo.png",alt:"MuscleMap",className:"w-8 h-8 rounded-lg"}),e.jsx("span",{className:"font-bold text-lg text-[var(--text-primary)] hidden sm:block",children:"MuscleMap"})]})}),e.jsx("main",{className:"pt-20 px-4 lg:px-8 pb-24 lg:pb-8 max-w-4xl mx-auto",children:e.jsxs(d,{className:"p-12 text-center",depth:"medium",children:[e.jsx(i.Target,{className:"w-16 h-16 mx-auto mb-4 text-[var(--text-quaternary)]"}),e.jsx("h2",{className:"text-2xl font-bold text-[var(--text-primary)] mb-2",children:"Goal Not Found"}),e.jsx("p",{className:"text-[var(--text-tertiary)] mb-6",children:"This career goal may have been deleted or doesn't exist."}),e.jsx(m,{variant:"primary",onClick:()=>o("/career"),children:"Back to Career"})]})}),e.jsx(f,{items:k})]})}export{je as default};
