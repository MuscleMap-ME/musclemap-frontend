const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Cq0y1rKR.js","assets/react-vendor-D1NxaRNd.js","assets/illustrations-CFkZtwGd.js","assets/index-D_LgOQCi.js","assets/leaflet-vendor-CIGW-MKW.css","assets/reactflow-vendor-B5DZHykP.css","assets/index-D_B2na1a.css"])))=>i.map(i=>d[i]);
import{D as De,E as vs,R as js,G as Ns,H as ws,I as Ss,J as ks,K as Cs,N as Ms,O as Es,Q as Rs,V as Ts,Y as _s,$ as Is,h as Je,o as Ps,a0 as As,P as Se,m as z,a1 as Ee,A as Me,j as Os,Z as Ls,a2 as Xe,a3 as Ws,a4 as Ds,X as $s,a5 as Us,y as Fs,_ as Bs}from"./index-D_LgOQCi.js";import{r as a,j as e,a as Gs,d as qs,L as zs}from"./react-vendor-D1NxaRNd.js";import{T as Ze}from"./TipCard-CnU15s4-.js";import{h as Vs}from"./illustrations-CFkZtwGd.js";import{M as qe}from"./MuscleViewer-Dvj76euP.js";import{M as Ys}from"./MuscleActivationBadge-30IQIKdN.js";import"./GlassSurface-BMiMerMg.js";import"./GlassButton-g-1Onhf3.js";import{FloatingRestTimer as Hs}from"./FloatingRestTimer-Cq0KRWkT.js";import{u as ze,b as Ve,c as le,g as es}from"./apollo-vendor-BMQ75Ycx.js";import{C as Re}from"./circle-alert-DIiFeQ7r.js";import{M as ke}from"./minus-0JfKg0TN.js";import{L as fe}from"./loader-circle-CCc4coOu.js";import{A as Ye}from"./award-C-5F1zQL.js";import{R as $e}from"./refresh-cw-3d7SH3Au.js";import{I as Ks}from"./info-C-lmdlM0.js";import{C as ss}from"./chevron-down-pb_2tqF_.js";import{T as Qs}from"./timer-BHLpv73c.js";import{C as Js}from"./check-BJvRTxQa.js";import{C as ts}from"./chevron-right-CAFoEmmn.js";import{T as Xs}from"./trash-2-rVRkL8q8.js";import"./reactflow-vendor-Dz2P_-Qa.js";import"./d3-vendor-mcDw60ct.js";import"./recharts-vendor-BziRPEEi.js";import"./leaflet-vendor-DZbo3Ov0.js";import"./use-drag-controls-WaZx8KTo.js";import"./minimize-2-BaMfZKhw.js";import"./skip-forward-BpJeu-Gb.js";import"./volume-x-D_9hUgH7.js";const Zs="musclemap-sessions",et=1,Te="active_session";let Ce=null;function st(){return Ce||(Ce=new Promise((r,y)=>{const o=indexedDB.open(Zs,et);o.onerror=()=>{y(o.error)},o.onsuccess=()=>{r(o.result)},o.onupgradeneeded=h=>{const C=h.target.result;C.objectStoreNames.contains(Te)||C.createObjectStore(Te,{keyPath:"id"})}}),Ce)}async function tt(){try{const o=(await st()).transaction(Te,"readwrite").objectStore(Te);await new Promise((h,C)=>{const x=o.delete("current");x.onsuccess=()=>h(),x.onerror=()=>C(x.error)})}catch{}}let Z=null;const at=5e3,rt=3e4;let Oe=0;async function lt(r,y=!1){if(!localStorage.getItem("token"))return;const h=Date.now();if(y||h-Oe>rt){Z&&(clearTimeout(Z),Z=null);try{await De.post("/sessions",He(r)),Oe=h}catch{}return}Z&&clearTimeout(Z),Z=setTimeout(async()=>{try{await De.post("/sessions",He(r)),Oe=Date.now()}catch{}Z=null},at)}async function nt(r,y){if(localStorage.getItem("token"))try{await De.delete("/sessions/active",{data:{reason:r,workoutId:y}})}catch{}}function He(r){return{sessionId:r.sessionId,startedAt:r.startTime,pausedAt:r.pausedAt,totalPausedTime:r.totalPausedTime,workoutPlan:r.workoutPlan||{exercises:r.exercises},currentExerciseIndex:r.currentExerciseIndex,currentSetIndex:r.currentSetIndex,sets:r.sets,totalVolume:r.totalVolume,totalReps:r.totalReps,estimatedCalories:r.estimatedCalories,musclesWorked:r.musclesWorked,sessionPRs:r.sessionPRs,restTimer:r.restTimer,exerciseGroups:r.exerciseGroups,activeGroup:r.activeGroup,activeGroupExerciseIndex:r.activeGroupExerciseIndex,activeGroupRound:r.activeGroupRound,groupSets:r.groupSets,clientVersion:r.clientVersion}}async function Ke(r="completed",y){Z&&(clearTimeout(Z),Z=null),await tt(),await nt(r,y)}function _e(){const r=a.useRef(null),y=a.useRef(null),o=a.useRef(null),{data:h,loading:C,refetch:x,error:I}=ze(vs,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,errorPolicy:"all"}),{data:P,loading:p,refetch:w}=ze(js,{fetchPolicy:"network-only",errorPolicy:"all"}),[R,{data:S,loading:A}]=Ve(Ns,{errorPolicy:"all"}),[$,{loading:k}]=Ve(ws,{errorPolicy:"all"}),[b,{loading:m}]=le(Ss),[d,{loading:O}]=le(ks),[V,{loading:Y}]=le(Cs),[H,{loading:ne}]=le(Ms),[U,{loading:M}]=le(Es),[D,{loading:xe}]=le(Rs),[K,{loading:F}]=le(Ts),[ie,{loading:ee}]=le(_s),[Q,{loading:oe}]=le(Is),g=a.useMemo(()=>h?.activeWorkoutSession||null,[h]),_=a.useMemo(()=>(P?.recoverableSessions||[]).map(c=>({...c,exerciseCount:c.musclesWorked?.length||0,setCount:c.setsLogged,lastActivityAt:c.archivedAt})),[P]),q=a.useMemo(()=>{const u={};if(S?.exerciseHistory)for(const c of S.exerciseHistory)u[c.exerciseId]=c;return u},[S]),B=!!g,ce=!!g?.pausedAt,J=a.useCallback(async(u,c)=>{try{const{data:v,errors:W}=await b({variables:{input:u?{workoutPlan:u,clientId:c}:void 0}});return W?.length?{success:!1,error:W[0]?.message||"Failed to start session"}:v?.startWorkoutSession?.session?(await x(),{success:!0,sessionId:v.startWorkoutSession.session.id}):{success:!1,error:"Failed to start session"}}catch(v){return{success:!1,error:v instanceof Error?v.message:"Unknown error"}}},[b,x]),se=a.useCallback(async u=>{try{const{data:c,errors:v}=await d({variables:{input:u}});if(v?.length)return{success:!1,error:v[0]?.message||"Failed to log set"};if(c?.logSet){const W=c.logSet,G=W.prsAchieved||[];for(const Pe of G)r.current&&r.current(Pe);return await x(),{success:!0,set:W.setLogged,prs:G}}return{success:!1,error:"Failed to log set"}}catch(c){return{success:!1,error:c instanceof Error?c.message:"Unknown error"}}},[d,x]),te=a.useCallback(async(u,c)=>{try{const{data:v,errors:W}=await V({variables:{input:{setId:u,...c}}});return W?.length?{success:!1,error:W[0]?.message||"Failed to update set"}:v?.updateSet?(await x(),{success:!0,set:v.updateSet}):{success:!1,error:"Failed to update set"}}catch(v){return{success:!1,error:v instanceof Error?v.message:"Unknown error"}}},[V,x]),E=a.useCallback(async u=>{try{const{data:c,errors:v}=await H({variables:{setId:u}});return v?.length?{success:!1,error:v[0]?.message||"Failed to delete set"}:c?.deleteSet!==void 0?(await x(),{success:!0}):{success:!1,error:"Failed to delete set"}}catch(c){return{success:!1,error:c instanceof Error?c.message:"Unknown error"}}},[H,x]),ae=a.useCallback(async()=>{if(!g)return{success:!1,error:"No active session"};try{const{data:u,errors:c}=await U({variables:{sessionId:g.id}});return c?.length?{success:!1,error:c[0]?.message||"Failed to pause session"}:u?.pauseWorkoutSession?(await x(),{success:!0}):{success:!1,error:"Failed to pause session"}}catch(u){return{success:!1,error:u instanceof Error?u.message:"Unknown error"}}},[g,U,x]),de=a.useCallback(async()=>{if(!g)return{success:!1,error:"No active session"};try{const{data:u,errors:c}=await D({variables:{sessionId:g.id}});return c?.length?{success:!1,error:c[0]?.message||"Failed to resume session"}:u?.resumeWorkoutSession?(await x(),{success:!0}):{success:!1,error:"Failed to resume session"}}catch(u){return{success:!1,error:u instanceof Error?u.message:"Unknown error"}}},[g,D,x]),n=a.useCallback(async(u,c)=>{if(!g)return{success:!1,error:"No active session"};try{const{data:v,errors:W}=await K({variables:{input:{sessionId:g.id,notes:u,isPublic:c}}});if(W?.length)return{success:!1,error:W[0]?.message||"Failed to complete session"};const G=v?.completeWorkoutSession;return G?(G.levelUp&&y.current&&y.current(Math.floor(G.xpEarned/1e3)+1),o.current&&o.current(G),await x(),{success:!0,result:G}):{success:!1,error:"Failed to complete session"}}catch(v){return{success:!1,error:v instanceof Error?v.message:"Unknown error"}}},[g,K,x]),N=a.useCallback(async u=>{if(!g)return{success:!1,error:"No active session"};try{const{data:c,errors:v}=await ie({variables:{sessionId:g.id,reason:u}});return v?.length?{success:!1,error:v[0]?.message||"Failed to abandon session"}:c?.abandonWorkoutSession!==void 0?(await x(),{success:!0}):{success:!1,error:"Failed to abandon session"}}catch(c){return{success:!1,error:c instanceof Error?c.message:"Unknown error"}}},[g,ie,x]),L=a.useCallback(async u=>{try{const{data:c,errors:v}=await Q({variables:{archivedSessionId:u}});return v?.length?{success:!1,error:v[0]?.message||"Failed to recover session"}:c?.recoverWorkoutSession?(await x(),await w(),{success:!0,session:c.recoverWorkoutSession}):{success:!1,error:"Failed to recover session"}}catch(c){return{success:!1,error:c instanceof Error?c.message:"Unknown error"}}},[Q,x,w]),ue=a.useCallback(async u=>{u.length!==0&&await R({variables:{exerciseIds:u}})},[R]),Ie=a.useCallback(async(u,c,v)=>{try{const{data:W}=await $({variables:{exerciseId:u,equipment:c,maxResults:v||5}});return W?.exerciseSubstitutions||[]}catch{return[]}},[$]),ge=a.useCallback(u=>{u.onPRAchieved&&(r.current=u.onPRAchieved),u.onLevelUp&&(y.current=u.onLevelUp),u.onWorkoutComplete&&(o.current=u.onWorkoutComplete)},[]),pe=a.useMemo(()=>{if(!g)return 0;const u=new Date(g.startedAt).getTime(),v=Date.now()-u;return Math.floor((v-g.totalPausedTime*1e3)/1e3)},[g]),ye=a.useMemo(()=>{if(!g?.sets||g.sets.length===0)return[];const u=g.sets[g.sets.length-1];return u?g.sets.filter(c=>c.exerciseId===u.exerciseId):[]},[g]),ve=a.useCallback(u=>g?.sets?g.sets.filter(c=>c.exerciseId===u):[],[g]),je=g?.sets?.length||0;return{activeSession:g,isSessionActive:B,isPaused:ce,recoverableSessions:_,exerciseHistory:q,sessionDuration:pe,currentExerciseSets:ye,getSetsForExercise:ve,totalSets:je,errors:{activeSession:I},loading:{activeSession:C,recoverableSessions:p,exerciseHistory:A,substitutions:k,startingSession:m,loggingSet:O,updatingSet:Y,deletingSet:ne,pausingSession:M,resumingSession:xe,completingSession:F,abandoningSession:ee,recoveringSession:oe},startSession:J,logSet:se,updateSet:te,deleteSet:E,pauseSession:ae,resumeSession:de,completeSession:n,abandonSession:N,recoverSession:L,loadExerciseHistory:ue,findSubstitutes:Ie,registerCallbacks:ge,refetchActiveSession:x,refetchRecoverableSessions:w}}function it({exerciseId:r,delay:y=2e3}){const[o,h]=a.useState(null),[C,x]=a.useState(!1),[I,P]=a.useState(!1);return a.useEffect(()=>{if(!r)return;h(null),x(!1),P(!1),(async()=>{try{const w=await Je(`/tips/exercise/${r}`);w?.data&&(h(w.data),setTimeout(()=>x(!0),y))}catch{}})()},[r,y]),!o||!C||I?null:e.jsx("div",{className:"animate-fadeIn",children:e.jsx(Ze,{tip:o,onDismiss:()=>P(!0),compact:!0})})}const ot={first_workout:"ðŸŽ‰",workouts_10:"ðŸ”¥",workouts_50:"âš¡",workouts_100:"ðŸ†",streak_7:"ðŸ“…",streak_30:"ðŸ—“ï¸",exercises_100:"ðŸ’¯",reps_1000:"ðŸŽ¯",reps_10000:"ðŸš€",hours_10:"â±ï¸"};function ct({milestone:r,onContinue:y}){if(!r)return null;const o=ot[r.id]||"ðŸ…";return e.jsxs("div",{className:"bg-gradient-to-b from-yellow-500/20 via-amber-500/10 to-transparent rounded-2xl p-6 border border-yellow-500/30 text-center",children:[e.jsxs("div",{className:"relative inline-block mb-4",children:[e.jsx("div",{className:"text-6xl animate-bounce",children:o}),e.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-black",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),e.jsx("h3",{className:"text-xl font-bold text-yellow-400 mb-1",children:"Milestone Achieved!"}),e.jsx("p",{className:"text-2xl font-bold text-white mb-2",children:r.name}),r.description&&e.jsx("p",{className:"text-gray-300 text-sm mb-4",children:r.description}),y&&e.jsx("button",{onClick:y,className:"mt-4 px-6 py-2 bg-yellow-500 hover:bg-yellow-400 text-black font-medium rounded-lg transition-colors",children:"Awesome!"})]})}function dt({workout:r,onClose:y}){const[o,h]=a.useState(null),[C,x]=a.useState(null),[I,P]=a.useState(!0),[p,w]=a.useState(!0);a.useEffect(()=>{(async()=>{try{const A=await Je("/tips/completion",{method:"POST",body:{goals:r?.goals||[]}});h(A?.data?.tip),x(A?.data?.milestone)}catch{}finally{P(!1)}})()},[r?.goals]);const R=[{icon:"â±ï¸",value:r?.duration||"-",label:"minutes",color:"text-blue-400"},{icon:"ðŸ‹ï¸",value:r?.exerciseCount||r?.exercises?.length||"-",label:"exercises",color:"text-yellow-400"},{icon:"ðŸ”¥",value:r?.totalSets||"-",label:"sets",color:"text-orange-400"},{icon:"ðŸ’ª",value:r?.totalTU?Math.round(r.totalTU):"-",label:"TU earned",color:"text-purple-400"}];return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-gray-900 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"relative pt-8 pb-4 px-6 text-center overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 left-1/4 w-2 h-2 bg-yellow-400 rounded-full animate-ping",style:{animationDelay:"0s"}}),e.jsx("div",{className:"absolute top-4 right-1/4 w-2 h-2 bg-purple-400 rounded-full animate-ping",style:{animationDelay:"0.2s"}}),e.jsx("div",{className:"absolute top-2 left-1/2 w-2 h-2 bg-pink-400 rounded-full animate-ping",style:{animationDelay:"0.4s"}})]}),e.jsx("div",{className:"text-6xl mb-3",children:"ðŸŽ‰"}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Workout Complete!"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Great job staying consistent"})]}),e.jsx("div",{className:"px-6 pb-4",children:e.jsx("div",{className:"grid grid-cols-4 gap-2",children:R.map((S,A)=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg mb-1",children:S.icon}),e.jsx("div",{className:`text-lg font-bold ${S.color}`,children:S.value}),e.jsx("div",{className:"text-xs text-gray-500",children:S.label})]},A))})}),C&&p&&e.jsx("div",{className:"px-6 pb-4",children:e.jsx(ct,{milestone:C,onContinue:()=>w(!1)})}),!I&&o&&(!C||!p)&&e.jsx("div",{className:"px-6 pb-4",children:e.jsx(Ze,{tip:o})}),I&&e.jsx("div",{className:"px-6 pb-4",children:e.jsx("div",{className:"bg-gray-800 rounded-xl p-4 animate-pulse",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-700 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-700 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-700 rounded w-1/2"})]})]})})}),e.jsx("div",{className:"px-6 pb-6",children:e.jsx("button",{onClick:y,className:"w-full py-3 bg-purple-600 hover:bg-purple-500 text-white font-medium rounded-xl transition-colors",children:"Done"})})]})})}function ut({content:r,children:y}){const[o,h]=Gs.useState(!1);return e.jsxs("div",{className:"relative inline-block",onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),onTouchStart:()=>h(!0),onTouchEnd:()=>setTimeout(()=>h(!1),2e3),children:[y,e.jsx(Me,{children:o&&e.jsxs(z.div,{initial:{opacity:0,y:4,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:4,scale:.95},transition:{duration:.15},className:"absolute z-50 bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 text-xs text-gray-200 bg-gray-900 border border-gray-700 rounded-lg shadow-xl whitespace-nowrap max-w-[200px] text-center",style:{whiteSpace:"normal"},children:[r,e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 border-4 border-transparent border-t-gray-900"})]})})]})}const mt={warmup:{label:"Warmup",color:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",icon:Ws,tooltip:"Light weight to prepare muscles and joints before working sets"},working:{label:"Working",color:"bg-blue-500/20 text-blue-400 border-blue-500/30",icon:Xe,tooltip:"Main sets at your target weight for building strength/muscle"},failure:{label:"Failure",color:"bg-red-500/20 text-red-400 border-red-500/30",icon:Ls,tooltip:"Pushed until you cannot complete another rep with good form"},drop:{label:"Drop",color:"bg-purple-500/20 text-purple-400 border-purple-500/30",icon:ss,tooltip:"Reduced weight immediately after a set with no rest"},amrap:{label:"AMRAP",color:"bg-orange-500/20 text-orange-400 border-orange-500/30",icon:Os,tooltip:"As Many Reps As Possible - max effort set"}},xt=[{value:0,label:"0 RIR",description:"Total failure"},{value:1,label:"1 RIR",description:"Could do 1 more"},{value:2,label:"2 RIR",description:"Could do 2 more"},{value:3,label:"3 RIR",description:"Could do 3 more"},{value:4,label:"4+ RIR",description:"Easy"}];function gt({exerciseId:r,exerciseName:y,suggestedSets:o=3,suggestedReps:h=10,onSetLogged:C,onAllSetsComplete:x,compact:I=!1}){const{error:P}=Ps(),p=As(),[w,R]=a.useState(""),[S,A]=a.useState(h.toString()),[$,k]=a.useState("working"),[b,m]=a.useState(null),[d,O]=a.useState(null),[V,Y]=a.useState(""),[H,ne]=a.useState(!1),[U,M]=a.useState(null),[D,xe]=a.useState([]),{logSet:K,loadExerciseHistory:F,exerciseHistory:ie,getSetsForExercise:ee,activeSession:Q,loading:oe}=_e(),g=oe.loggingSet;a.useEffect(()=>{F([r])},[r,F]);const _=ie[r],q=ee(r),B=q.length+1,ce=a.useMemo(()=>_?.bestWeight?Math.round(_.bestWeight*.85/5)*5:null,[_]);a.useEffect(()=>{ce&&!w&&R(ce.toString())},[ce,w]);const J=a.useCallback(async()=>{const n=parseFloat(w),N=parseInt(S);if(isNaN(n)||n<0){P("Please enter a valid weight (0 or greater)");return}if(!N||N<=0){P("Please enter reps greater than 0");return}if(!Q){P("No active workout session. Please start a new workout from the beginning.");return}const L=await K({sessionId:Q.id,exerciseId:r,setNumber:B,reps:N,weightKg:n/2.205,rpe:b||void 0,rir:d||void 0,tag:$||void 0,notes:V.trim()||void 0});if(L?.set){if(xe(L.set.muscleActivations||[]),L.set.isPRWeight||L.set.isPR1RM||L.set.isPRReps){const ue=L.set.isPR1RM?"1rm":L.set.isPRWeight?"weight":"reps";M({type:ue,value:Math.round(ue==="1rm"?L.set.weightKg*2.205/(1.0278-.0278*N):L.set.weightKg*2.205)}),setTimeout(()=>M(null),4e3)}A(h.toString()),m(null),O(null),Y(""),C?.(L.set),B>=o&&x?.()}},[w,S,$,b,d,V,r,Q,K,h,o,B,C,x,P]),se=n=>{const N=parseFloat(w)||0;R(Math.max(0,N+n).toString())},te=n=>{const N=parseFloat(n);n===""||n==="-"?R(""):isNaN(N)||R(Math.max(0,N).toString())},E=n=>{const N=parseInt(S)||0;A(Math.max(0,N+n).toString())},ae=a.useMemo(()=>{const n=parseFloat(w),N=parseInt(S);return n>0&&N>0&&N<=15?Math.round(n/(1.0278-.0278*N)):null},[w,S]),de=ae&&_?.best1RM&&ae>_.best1RM;return Q?I?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs text-gray-400 mb-1 block",children:"Weight (lbs)"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>se(-5),className:"p-1.5 rounded bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(ke,{className:"w-4 h-4"})}),e.jsx("input",{type:"number",min:"0",value:w,onChange:n=>te(n.target.value),placeholder:"0",className:"flex-1 bg-gray-800/50 border border-gray-700 rounded px-2 py-2 text-center text-lg font-bold focus:border-blue-500 focus:outline-none w-20"}),e.jsx("button",{onClick:()=>se(5),className:"p-1.5 rounded bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(Se,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs text-gray-400 mb-1 block",children:"Reps"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>E(-1),className:"p-1.5 rounded bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(ke,{className:"w-4 h-4"})}),e.jsx("input",{type:"number",value:S,onChange:n=>A(n.target.value),placeholder:"0",className:"flex-1 bg-gray-800/50 border border-gray-700 rounded px-2 py-2 text-center text-lg font-bold focus:border-blue-500 focus:outline-none w-16"}),e.jsx("button",{onClick:()=>E(1),className:"p-1.5 rounded bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(Se,{className:"w-4 h-4"})})]})]})]}),e.jsx(z.button,{whileTap:{scale:.98},onClick:J,disabled:!w||!S||g,className:`w-full py-3 rounded-xl font-bold text-base transition-all flex items-center justify-center gap-2 ${w&&S&&!g?"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:g?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 animate-spin"}),"Logging..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"w-4 h-4"}),"Log Set ",B,"/",o]})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(Me,{children:U&&e.jsxs(z.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},className:"bg-gradient-to-r from-yellow-500/20 to-orange-500/20 border border-yellow-500/30 rounded-lg p-4 flex items-center gap-3",children:[e.jsx(Ye,{className:"w-8 h-8 text-yellow-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-yellow-400",children:"NEW PR!"}),e.jsxs("p",{className:"text-sm text-gray-300",children:[U.type==="1rm"&&`Estimated 1RM: ${U.value} lbs`,U.type==="weight"&&`Max weight: ${U.value} lbs`,U.type==="volume"&&`Set volume: ${U.value} lbs`]})]})]})}),_&&e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3 flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx($e,{className:"w-4 h-4"}),e.jsxs("span",{children:["Last: ",_.totalSessions," sessions"]})]}),e.jsxs("div",{className:"flex gap-4",children:[_.bestWeight&&e.jsxs("span",{className:"text-blue-400",children:["Best: ",Math.round(_.bestWeight*2.205)," lbs"]}),_.best1RM&&e.jsxs("span",{className:"text-purple-400",children:["1RM: ",Math.round(_.best1RM*2.205)," lbs"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Set Progress:"}),e.jsx("div",{className:"flex gap-1",children:Array.from({length:o}).map((n,N)=>e.jsx("div",{className:`w-8 h-2 rounded-full transition-colors ${N<q.length?"bg-green-500":N===q.length?"bg-blue-500 animate-pulse":"bg-gray-700"}`},N))}),e.jsxs("span",{className:"text-sm font-medium",children:[q.length,"/",o]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(Ks,{className:"w-3 h-3"}),e.jsx("span",{children:"Tap and hold for info"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(mt).map(([n,N])=>{const L=N.icon;return e.jsx(ut,{content:N.tooltip,children:e.jsxs("button",{onClick:()=>k(n),className:`px-3 py-1.5 rounded-full text-sm font-medium border transition-all flex items-center gap-1.5 ${$===n?N.color:"bg-gray-800/50 text-gray-400 border-gray-700 hover:border-gray-600"}`,children:[e.jsx(L,{className:"w-4 h-4"}),N.label]})},n)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Weight (lbs)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>se(-5),className:"p-2 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(ke,{className:"w-5 h-5"})}),e.jsx("input",{type:"number",min:"0",value:w,onChange:n=>te(n.target.value),placeholder:"0",className:"flex-1 bg-gray-800/50 border border-gray-700 rounded-lg px-4 py-3 text-center text-2xl font-bold focus:border-blue-500 focus:outline-none"}),e.jsx("button",{onClick:()=>se(5),className:"p-2 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(Se,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Reps"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>E(-1),className:"p-2 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(ke,{className:"w-5 h-5"})}),e.jsx("input",{type:"number",value:S,onChange:n=>A(n.target.value),placeholder:"0",className:"flex-1 bg-gray-800/50 border border-gray-700 rounded-lg px-4 py-3 text-center text-2xl font-bold focus:border-blue-500 focus:outline-none"}),e.jsx("button",{onClick:()=>E(1),className:"p-2 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx(Se,{className:"w-5 h-5"})})]})]}),ae&&e.jsxs("div",{className:`p-3 rounded-lg border ${de?"bg-yellow-500/10 border-yellow-500/30":"bg-gray-800/50 border-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Estimated 1RM"}),e.jsxs("span",{className:`font-bold ${de?"text-yellow-400":"text-white"}`,children:[ae," lbs",de&&e.jsx("span",{className:"ml-2 text-xs",children:"NEW PR!"})]})]}),_?.best1RM&&e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Previous Best"}),e.jsxs("span",{className:"text-xs text-gray-400",children:[Math.round(_.best1RM*2.205)," lbs"]})]})]}),D.length>0&&e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Last Set - Muscle Activation"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:D.map(n=>e.jsxs("span",{className:"bg-purple-500/30 text-purple-200 px-2 py-0.5 rounded text-xs",children:[n.muscleName," (",Math.round(n.activation*100),"%)"]},n.muscleId))})]}),e.jsxs("button",{onClick:()=>ne(!H),className:"w-full py-2 text-sm text-gray-400 hover:text-gray-300 flex items-center justify-center gap-2",children:[e.jsxs("span",{children:[H?"Hide":"Show"," Advanced Options"]}),e.jsx(ss,{className:`w-4 h-4 transition-transform ${H?"rotate-180":""}`})]}),e.jsx(Me,{children:H&&e.jsxs(z.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"space-y-4 overflow-hidden",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"RPE (1-10)"}),e.jsx("span",{className:"text-sm font-medium",children:b||"-"})]}),e.jsx("input",{type:"range",min:"1",max:"10",value:b||5,onChange:n=>m(parseInt(n.target.value)),className:"w-full accent-blue-500"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsx("span",{children:"Easy"}),e.jsx("span",{children:"Max Effort"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Reps in Reserve"}),e.jsx("div",{className:"flex gap-2",children:xt.map(n=>e.jsx("button",{onClick:()=>O(d===n.value?null:n.value),className:`flex-1 py-2 px-2 rounded-lg text-xs font-medium border transition-all ${d===n.value?"bg-blue-500/20 text-blue-400 border-blue-500/30":"bg-gray-800/50 text-gray-400 border-gray-700 hover:border-gray-600"}`,children:n.label},n.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Notes"}),e.jsx("input",{type:"text",value:V,onChange:n=>Y(n.target.value),placeholder:"Optional notes...",className:"w-full bg-gray-800/50 border border-gray-700 rounded-lg px-4 py-2 text-sm focus:border-blue-500 focus:outline-none"})]})]})}),q.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Logged Sets"}),e.jsx("div",{className:"space-y-1",children:q.map((n,N)=>e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-400",children:["Set ",N+1]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"font-medium",children:[Math.round((n.weightKg||0)*2.205)," lbs x ",n.reps]}),e.jsxs("span",{className:"text-purple-400",children:[n.tu," TU"]}),n.isPRWeight&&e.jsx(Ye,{className:"w-4 h-4 text-yellow-400"})]})]},n.id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-400 flex items-center gap-1.5",children:[e.jsx(Qs,{className:"w-4 h-4"}),"Rest Timer"]}),p.isActive&&e.jsx("button",{onClick:p.stop,className:"text-xs text-red-400 hover:text-red-300",children:"Stop"})]}),e.jsx(Me,{children:p.isActive&&e.jsx(z.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:e.jsxs("div",{className:`p-4 rounded-xl border ${p.time<=10?"bg-red-500/10 border-red-500/30":p.time<=30?"bg-yellow-500/10 border-yellow-500/30":"bg-gray-800/50 border-gray-700"}`,children:[e.jsx("div",{className:"h-1.5 bg-gray-700 rounded-full overflow-hidden mb-3",children:e.jsx(z.div,{className:`h-full ${p.time<=10?"bg-red-500":p.time<=30?"bg-yellow-500":"bg-blue-500"}`,initial:{width:"0%"},animate:{width:`${p.progress}%`},transition:{duration:.3}})}),e.jsx("div",{className:"text-center mb-3",children:e.jsx("span",{className:`text-3xl font-mono font-bold ${p.time<=10?"text-red-400":p.time<=30?"text-yellow-400":"text-white"}`,children:p.formatted})}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>p.adjust(-30),className:"px-3 py-1.5 rounded-lg bg-gray-700 hover:bg-gray-600 text-gray-300 text-sm font-medium",children:"-30s"}),e.jsx("button",{onClick:()=>p.adjust(30),className:"px-3 py-1.5 rounded-lg bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 text-sm font-medium",children:"+30s"})]})]})})}),!p.isActive&&e.jsx("div",{className:"flex flex-wrap gap-2",children:p.presets.slice(0,4).map(n=>e.jsxs("button",{onClick:()=>p.start(n.seconds),className:"flex-1 min-w-[60px] py-2 px-3 rounded-lg bg-gray-800/50 hover:bg-gray-700/50 border border-gray-700 hover:border-gray-600 text-gray-300 text-sm font-medium flex items-center justify-center gap-1.5 transition-all",children:[e.jsx(Ds,{className:"w-3 h-3"}),n.label]},n.seconds))})]}),e.jsx(z.button,{whileTap:{scale:.98},onClick:J,disabled:!w||!S||g,className:`w-full py-4 rounded-xl font-bold text-lg transition-all flex items-center justify-center gap-2 ${w&&S&&!g?"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:g?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-5 h-5 animate-spin"}),"Logging Set..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"w-5 h-5"}),"Log Set ",B]})})]}):e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(Re,{className:"w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-yellow-200 font-medium",children:"No Active Session"}),e.jsx("p",{className:"text-xs text-yellow-400/80 mt-1",children:'Please start a new workout to log your sets. Use the "Generate Workout" button or go back and start fresh.'})]})]})})}function ht({exerciseId:r,exerciseName:y,availableEquipment:o,onSelect:h,onCancel:C}){const[x,I]=a.useState([]),[P,p]=a.useState(!0),[w,R]=a.useState(null),[S,A]=a.useState(null),{findSubstitutes:$}=_e();a.useEffect(()=>{(async()=>{p(!0),R(null);const O=await $(r,o,8);O&&O.length>0?I(O):R("No alternative exercises found for your equipment."),p(!1)})()},[r,o,$]);const k=a.useCallback(d=>{A(d.exercise.id),setTimeout(()=>{h(d.exercise)},200)},[h]),b=d=>d>=.8?"text-green-400":d>=.6?"text-yellow-400":"text-orange-400",m=d=>d>=.8?"Excellent match":d>=.6?"Good match":"Partial match";return e.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-end sm:items-center justify-center",onClick:C,children:e.jsxs(z.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},onClick:d=>d.stopPropagation(),className:"bg-gray-900 rounded-t-3xl sm:rounded-3xl w-full max-w-lg max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-800 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold",children:"Swap Exercise"}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Find alternatives for ",y]})]}),e.jsx("button",{onClick:C,className:"p-2 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-400",children:e.jsx($s,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:P?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(fe,{className:"w-8 h-8 text-blue-400 animate-spin mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Finding similar exercises..."})]}):w?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Re,{className:"w-8 h-8 text-orange-400 mb-4"}),e.jsx("p",{className:"text-gray-400 text-center",children:w}),e.jsx("button",{onClick:C,className:"mt-4 px-4 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-sm",children:"Keep Current Exercise"})]}):e.jsx("div",{className:"space-y-3",children:x.map(d=>e.jsx(z.button,{whileTap:{scale:.98},onClick:()=>k(d),className:`w-full text-left p-4 rounded-xl border transition-all ${S===d.exercise.id?"bg-green-500/20 border-green-500/50":"bg-gray-800/50 border-gray-700 hover:border-gray-600"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ee,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"font-medium",children:d.exercise.name})]}),d.exercise.equipment&&d.exercise.equipment.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:d.exercise.equipment.slice(0,3).map(O=>e.jsx("span",{className:"text-xs bg-gray-700/50 text-gray-300 px-2 py-0.5 rounded",children:O},O))}),d.matchedMuscles&&d.matchedMuscles.length>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400 mb-1",children:[e.jsx(Xe,{className:"w-3 h-3"}),e.jsxs("span",{children:["Targets: ",d.matchedMuscles.join(", ")]})]}),d.missingMuscles&&d.missingMuscles.length>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-orange-400",children:[e.jsx(Re,{className:"w-3 h-3"}),e.jsxs("span",{children:["Missing: ",d.missingMuscles.join(", ")]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs("div",{className:`text-sm font-medium ${b(d.similarityScore)}`,children:[Math.round(d.similarityScore*100),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:m(d.similarityScore)}),S===d.exercise.id?e.jsx(Js,{className:"w-5 h-5 text-green-400 mt-2"}):e.jsx(ts,{className:"w-5 h-5 text-gray-600 mt-2"})]})]})},d.exercise.id))})}),!P&&!w&&e.jsx("div",{className:"p-4 border-t border-gray-800",children:e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx($e,{className:"w-3 h-3"}),e.jsx("span",{children:"Alternatives sorted by muscle similarity"})]})})]})})}function pt({sessions:r,onRecover:y,onDiscard:o,onDismiss:h}){const[C,x]=a.useState(null),[I,P]=a.useState(!1),[p,w]=a.useState(!1),{recoverSession:R}=_e(),S=b=>{const m=new Date(b),O=new Date().getTime()-m.getTime(),V=Math.round(O/6e4),Y=Math.round(O/36e5),H=Math.round(O/864e5);return V<60?`${V} min ago`:Y<24?`${Y} hours ago`:`${H} days ago`},A=b=>b>=1e3?`${(b/1e3).toFixed(1)}k lbs`:`${Math.round(b)} lbs`,$=async b=>{x(b),P(!0),(await R(b)).success?y(b):(P(!1),x(null))},k=async b=>{x(b),w(!0),o(b),w(!1),x(null)};return r.length===0?null:e.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(z.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-gray-900 rounded-2xl w-full max-w-md overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-800",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-xl bg-orange-500/20",children:e.jsx(Re,{className:"w-6 h-6 text-orange-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold",children:"Unfinished Workout"}),e.jsx("p",{className:"text-sm text-gray-400",children:r.length===1?"You have an incomplete session":`You have ${r.length} incomplete sessions`})]})]})}),e.jsx("div",{className:"p-4 max-h-[400px] overflow-y-auto space-y-3",children:r.map(b=>e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mb-1",children:[e.jsx(Us,{className:"w-4 h-4"}),e.jsx("span",{children:S(b.archivedAt||b.startedAt)})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ee,{className:"w-4 h-4 text-blue-400"}),e.jsxs("span",{className:"font-medium",children:[b.musclesWorked?.length||0," muscles"]})]}),e.jsxs("span",{className:"text-gray-400",children:[b.setsLogged||0," sets"]}),e.jsx("span",{className:"text-purple-400",children:A(b.totalVolume||0)})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>$(b.id),disabled:I||p,className:"flex-1 flex items-center justify-center gap-2 py-2.5 rounded-lg bg-green-600 hover:bg-green-500 text-white font-medium transition-colors disabled:opacity-50",children:I&&C===b.id?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 animate-spin"}),"Resuming..."]}):e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"w-4 h-4"}),"Resume"]})}),e.jsx("button",{onClick:()=>k(b.id),disabled:I||p,className:"flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg bg-gray-700 hover:bg-gray-600 text-gray-300 font-medium transition-colors disabled:opacity-50",children:p&&C===b.id?e.jsx(fe,{className:"w-4 h-4 animate-spin"}):e.jsx(Xs,{className:"w-4 h-4"})})]})]},b.id))}),e.jsx("div",{className:"p-4 border-t border-gray-800",children:e.jsxs("button",{onClick:h,disabled:I||p,className:"w-full py-3 rounded-xl bg-gray-800 hover:bg-gray-700 text-gray-300 font-medium transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:[e.jsx("span",{children:"Start Fresh Instead"}),e.jsx(ts,{className:"w-4 h-4"})]})})]})})}es`
  query GetRPETrends($exerciseId: ID!, $days: Int) {
    rpeTrends(exerciseId: $exerciseId, days: $days) {
      exerciseId
      exerciseName
      trends {
        date
        avgRpe
        avgRir
        setCount
        avgWeight
        maxWeight
        avgReps
      }
      summary {
        avgRpe
        totalSets
        daysWithData
        trend
      }
    }
  }
`;es`
  query GetFatigue {
    rpeFatigue {
      fatigueScore
      classification
      indicators
      recommendation
      suggestedIntensity
      recentRpeTrend
    }
  }
`;const bt=a.lazy(()=>Bs(()=>import("./index-Cq0y1rKR.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(r=>({default:r.ExerciseIllustration}))),ft={"chest-upper":"chest","chest-mid":"chest","chest-lower":"chest",pectoralis:"chest",pec:"chest","back-upper":"upper_back","back-mid":"lats","back-lower":"lower_back",latissimus:"lats",rhomboids:"upper_back",trapezius:"traps",traps:"traps","rear-delts":"rear_delts","front-delts":"front_delts","side-delts":"side_delts",shoulders:"front_delts",deltoid:"front_delts",biceps:"biceps",triceps:"triceps",forearms:"forearms",quadriceps:"quads",quads:"quads",hamstrings:"hamstrings",glutes:"glutes",calves:"calves",abs:"abs",obliques:"obliques",core:"abs","hip-flexors":"hip_flexors",adductors:"adductors",erector:"lower_back"};function he(r){const y=r.toLowerCase().replace(/[_\s]/g,"-");return ft[y]||y.replace(/-/g,"_")}const yt=[{value:15,label:"15 min",description:"Quick session"},{value:30,label:"30 min",description:"Standard"},{value:45,label:"45 min",description:"Extended"},{value:60,label:"60 min",description:"Full workout"}],Le=[{value:"gym",label:"Gym",icon:"ðŸ‹ï¸"},{value:"home",label:"Home",icon:"ðŸ "},{value:"park",label:"Park",icon:"ðŸŒ³"},{value:"hotel",label:"Hotel",icon:"ðŸ¨"},{value:"office",label:"Office",icon:"ðŸ¢"}],vt={gym:[{value:"barbell",label:"Barbell",icon:"ðŸ‹ï¸"},{value:"dumbbells",label:"Dumbbells",icon:"ðŸ”©"},{value:"cable_machine",label:"Cable Machine",icon:"âš™ï¸"},{value:"leg_press",label:"Leg Press",icon:"ðŸ¦µ"},{value:"lat_pulldown",label:"Lat Pulldown",icon:"ðŸ“"},{value:"bench",label:"Bench",icon:"ðŸª‘"},{value:"squat_rack",label:"Squat Rack",icon:"ðŸ—ï¸"},{value:"smith_machine",label:"Smith Machine",icon:"ðŸ”§"},{value:"rowing_machine",label:"Row Machine",icon:"ðŸš£"},{value:"treadmill",label:"Treadmill",icon:"ðŸƒ"},{value:"elliptical",label:"Elliptical",icon:"â­•"},{value:"kettlebell",label:"Kettlebell",icon:"ðŸ””"}],home:[{value:"dumbbells",label:"Dumbbells",icon:"ðŸ”©"},{value:"pullup_bar",label:"Pull-up Bar",icon:"ðŸ”²"},{value:"kettlebell",label:"Kettlebell",icon:"ðŸ””"},{value:"bands",label:"Resistance Bands",icon:"âž°"},{value:"yoga_mat",label:"Yoga Mat",icon:"ðŸ§˜"},{value:"foam_roller",label:"Foam Roller",icon:"ðŸ›¼"},{value:"jump_rope",label:"Jump Rope",icon:"ðŸª¢"},{value:"stability_ball",label:"Stability Ball",icon:"âšª"}],park:[{value:"pullup_bar",label:"Pull-up Bar",icon:"ðŸ”²"},{value:"parallel_bars",label:"Parallel Bars",icon:"â¸ï¸"},{value:"bench",label:"Park Bench",icon:"ðŸª‘"},{value:"bands",label:"Resistance Bands",icon:"âž°"},{value:"jump_rope",label:"Jump Rope",icon:"ðŸª¢"},{value:"stairs",label:"Stairs",icon:"ðŸ“¶"}],hotel:[{value:"bands",label:"Resistance Bands",icon:"âž°"},{value:"dumbbells",label:"Hotel Dumbbells",icon:"ðŸ”©"},{value:"yoga_mat",label:"Yoga Mat",icon:"ðŸ§˜"},{value:"chair",label:"Chair",icon:"ðŸ’º"},{value:"treadmill",label:"Treadmill",icon:"ðŸƒ"}],office:[{value:"bands",label:"Resistance Bands",icon:"âž°"},{value:"chair",label:"Office Chair",icon:"ðŸ’º"},{value:"desk",label:"Desk",icon:"ðŸ–¥ï¸"},{value:"stairs",label:"Stairs",icon:"ðŸ“¶"}]},jt=[{value:"dumbbells",label:"Dumbbells",icon:"ðŸ”©"},{value:"pullup_bar",label:"Pull-up Bar",icon:"ðŸ”²"},{value:"kettlebell",label:"Kettlebell",icon:"ðŸ””"},{value:"bands",label:"Resistance Bands",icon:"âž°"},{value:"barbell",label:"Barbell",icon:"ðŸ‹ï¸"}],Nt=[{value:"strength",label:"Strength",icon:"ðŸ’ª"},{value:"hypertrophy",label:"Muscle Growth",icon:"ðŸ“ˆ"},{value:"endurance",label:"Endurance",icon:"ðŸƒ"},{value:"fat_loss",label:"Fat Loss",icon:"ðŸ”¥"}],as=[{id:"chest",name:"Chest",icon:"ðŸª¶",match:["ch_","pec","chest"]},{id:"back",name:"Back",icon:"ðŸ”§",match:["bk_","lat","romboid","trap","back"]},{id:"shoulders",name:"Shoulders",icon:"ðŸ’ª",match:["sh_","delt","shoulder"]},{id:"arms",name:"Arms",icon:"ðŸ’ª",match:["ar_","bicep","tricep","forearm"]},{id:"legs",name:"Legs",icon:"ðŸ¦µ",match:["lg_","quad","hamstring","calf","leg"]},{id:"glutes",name:"Glutes",icon:"ðŸ‘",match:["glute"]},{id:"core",name:"Core",icon:"ðŸ¤³",match:["core","ab","oblique"]}];function We(r){if(!r||!r.length)return null;const y=(r[0]||"").toLowerCase();for(const o of as)if(o.match.some(h=>y.includes(h)))return o;return null}const Qe={barbell:{c:"from-red-500 to-orange-500"},dumbbell:{c:"from-blue-500 to-purple-500"},bodyweight:{c:"from-green-500 to-teal-500"},kettlebell:{c:"from-yellow-500 to-orange-500"},machine:{c:"from-gray-500 to-gray-700"},cable:{c:"from-purple-500 to-pink-500"},default:{c:"from-gray-600 to-gray-700"}};function Xt(){const{token:r}=Fs(),y=qs(),[o,h]=a.useState("select"),[C,x]=a.useState(!0),[I,P]=a.useState(30),[p,w]=a.useState("gym"),[R,S]=a.useState([]),[A,$]=a.useState(["strength"]),[k,b]=a.useState(null),[m,d]=a.useState(0),[O,V]=a.useState([]),[Y,H]=a.useState(""),[ne,U]=a.useState(null),[M,D]=a.useState([]),[xe,K]=a.useState(!1),[F,ie]=a.useState(null),[ee,Q]=a.useState(3),[oe,g]=a.useState(!1),[_,q]=a.useState(null),[B,ce]=a.useState(10),[J,se]=a.useState(0),[te,E]=a.useState(null),[ae,de]=a.useState(null),n=a.useRef(null),N=a.useRef(null),[L,ue]=a.useState(!1),[Ie,ge]=a.useState(!1),[pe,ye]=a.useState([]),{activeSession:ve,isSessionActive:je,startSession:u,completeSession:c,recoverSession:v,abandonSession:W,recoverableSessions:G,totalSets:Pe,registerCallbacks:Ue}=_e();a.useEffect(()=>{Ue({onPR:s=>{E(`NEW ${s.prType.toUpperCase()} PR! ${s.exerciseName}`),setTimeout(()=>E(null),3e3)},onLevelUp:s=>{E(`LEVEL UP! You're now level ${s}!`),setTimeout(()=>E(null),4e3)}})},[Ue]),a.useEffect(()=>{G&&G.length>0&&(ye(G),ge(!0))},[G]),a.useEffect(()=>{(o==="workout"||o==="manual")&&!n.current&&(n.current=`session-${Date.now()}-${Math.random().toString(36).slice(2)}`,N.current=Date.now())},[o]);const Fe=a.useCallback(async s=>{if(!r||!n.current||s.length===0)return;const t={sessionId:n.current,isActive:!0,startTime:N.current||Date.now(),pausedAt:null,totalPausedTime:0,exercises:s.map(i=>({id:i.id,name:i.name,primaryMuscles:i.primaryMuscles||i.primary_muscles||[],secondaryMuscles:i.secondaryMuscles||i.secondary_muscles||[]})),currentExercise:s[s.length-1]||null,currentExerciseIndex:s.length-1,currentSetIndex:0,sets:s.map((i,l)=>({id:`set-${l}`,exerciseId:i.id,exerciseName:i.name,weight:i.weight||0,reps:i.reps||0,tag:"working",timestamp:Date.now()})),totalVolume:s.reduce((i,l)=>i+(l.weight||0)*(l.reps||0)*(l.sets||1),0),totalReps:s.reduce((i,l)=>i+(l.reps||0)*(l.sets||1),0),estimatedCalories:s.length*50,musclesWorked:[...new Set(s.flatMap(i=>i.primaryMuscles||i.primary_muscles||[]))],sessionPRs:[],exerciseGroups:[],activeGroupExerciseIndex:0,activeGroupRound:1,groupSets:[],clientVersion:1};try{await lt(t,!1)}catch{}},[r]);a.useEffect(()=>{M.length>0&&(o==="workout"||o==="manual")&&Fe(M)},[M,o,Fe]),a.useEffect(()=>{S([])},[p]);const rs=vt[p]||jt,X=()=>{if(!k)return[];const s=[];return k.warmup&&s.push(...k.warmup.map(t=>({...t,phase:"warmup"}))),k.exercises&&s.push(...k.exercises.map(t=>({...t,phase:"main"}))),k.cooldown&&s.push(...k.cooldown.map(t=>({...t,phase:"cooldown"}))),s},Ne=a.useMemo(()=>{const s={};return M.forEach(t=>{const i=t.primaryMuscles||t.primary_muscles||[],l=t.secondaryMuscles||t.secondary_muscles||[],f=t.sets||3,j=t.reps||10,T=Math.min(1,f*j/50);i.forEach(re=>{const me=he(re),be=s[me]||{intensity:0};s[me]={intensity:Math.min(1,be.intensity+T*.4),isPrimary:!0}}),l.forEach(re=>{const me=he(re),be=s[me]||{intensity:0,isPrimary:!1};be.isPrimary?s[me].intensity=Math.min(1,be.intensity+T*.2):s[me]={intensity:Math.min(1,be.intensity+T*.2),isPrimary:!1}})}),Object.entries(s).map(([t,{intensity:i,isPrimary:l}])=>({id:t,intensity:i,isPrimary:l}))},[M]),ls=a.useMemo(()=>{if(!k)return[];const t=X()[m];if(!t)return[];const i=[],l=t.primaryMuscles||t.primary_muscles||[],f=t.secondaryMuscles||t.secondary_muscles||[];return l.forEach(j=>{i.push({id:he(j),intensity:1,isPrimary:!0})}),f.forEach(j=>{i.push({id:he(j),intensity:.5,isPrimary:!1})}),i},[k,m]);a.useEffect(()=>{o==="manual"&&O.length===0&&(K(!0),fetch("/api/exercises").then(s=>s.json()).then(s=>{const i=(s.data||s.exercises||[]).map(l=>({...l,primary_muscles:typeof l.primaryMuscles=="string"?l.primaryMuscles.split(",").map(f=>f.trim()).filter(Boolean):l.primaryMuscles||[]}));V(i),K(!1)}).catch(()=>K(!1)))},[o,O.length]);const ns=async()=>{K(!0),de(null);try{const s=await fetch("/api/prescription/generate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({timeAvailable:I,location:p,equipment:R,goals:A})}),t=await s.json();if(!s.ok)throw new Error(t.error?.message||"Failed to generate workout");const i=t.data;b(i),d(0),h("workout");const l=[...i.warmup||[],...i.exercises||[],...i.cooldown||[]].filter(f=>f.id||f.exerciseId).map(f=>({exerciseId:f.id||f.exerciseId,name:f.name,plannedSets:f.sets||3,plannedReps:typeof f.reps=="number"?f.reps:10}));l.length>0&&await u(l)}catch(s){de(s.message||"Failed to generate workout. Try different constraints.")}finally{K(!1)}},is=s=>{S(t=>t.includes(s)?t.filter(i=>i!==s):[...t,s])},os=s=>{$(t=>t.includes(s)?t.length>1?t.filter(i=>i!==s):t:[...t,s])},we=a.useRef(!1),Be=async()=>{if(we.current||M.length===0)return;we.current=!0,g(!0);const s=[...M];try{if(je&&ve){const t=await c();t?(n.current&&(await Ke("completed",t.workout?.id),n.current=null,N.current=null),q({tuEarned:t.tuEarned||0,xpEarned:t.xpEarned||0,characterStats:t.characterStats,exerciseCount:t.sessionSummary?.exerciseCount||s.length,totalSets:t.sessionSummary?.totalSets||Pe,exercises:s,levelUp:t.levelUp,newLevel:t.newLevel,achievements:t.achievements,sessionSummary:t.sessionSummary}),D([])):alert("Failed to complete workout. Please try again.")}else{const t=s.filter(j=>{const T=j.id&&typeof j.id=="string"&&!j.id.startsWith("activity-"),re=!j.isActivity;return T&&re}).map(j=>({exerciseId:j.id,sets:j.sets||3,reps:typeof j.reps=="number"?j.reps:10,weight:j.weight||void 0}));if(t.length===0){alert("No exercises to log. Complete at least one exercise (not just warmup/cooldown) to save your workout."),we.current=!1,g(!1);return}const i=`workout-${Date.now()}-${Math.random().toString(36).slice(2)}`,l=await fetch("/api/workouts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+r},body:JSON.stringify({exercises:t,idempotencyKey:i,notes:`${M.length} exercises completed`})}),f=await l.json();if(l.ok&&f.data){n.current&&(await Ke("completed",f.data.id),n.current=null,N.current=null);const j=s.length,T=s.reduce((re,me)=>re+(me.sets||0),0);q({tuEarned:f.data.totalTU,characterStats:f.data.characterStats,exerciseCount:j,totalSets:T,exercises:s}),D([])}else alert(f.error?.message||f.error||"Failed to complete workout")}}catch{alert("Error completing workout. Please try again.")}finally{we.current=!1,g(!1)}},cs=O.filter(s=>{const t=!Y||s.name.toLowerCase().includes(Y.toLowerCase()),i=We(s.primary_muscles),l=!ne||i&&i.id===ne;return t&&l}).slice(0,24);async function ds(){if(F)try{await fetch("/api/workouts/exercise",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+r},body:JSON.stringify({exerciseId:F.id,sets:ee,reps:B,weight:J})}),D([...M,{...F,sets:ee,reps:B,weight:J}]),E(F.name),setTimeout(()=>E(null),2e3),ie(null)}catch{}}const us=s=>Qe[s.type]||Qe.default,Ae=s=>{const t=We(s.primary_muscles||s.primaryMuscles);return t?t.icon:"ðŸ’ª"},Ge=s=>{const t=We(s.primary_muscles||s.primaryMuscles);return t?t.name:""},ms=async s=>{const t=s.id||s.exerciseId;if(s.isActivity||!t){const l=`activity-${m}`;M.some(T=>T.id===l)||D(T=>[...T,{id:l,name:s.name||s.description||"Activity",sets:s.sets||1,reps:s.reps||1,weight:0,isActivity:!0}]),E(s.name||s.description),setTimeout(()=>E(null),2e3);const j=X();m<j.length-1&&d(m+1);return}try{await fetch("/api/workouts/exercise",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+r},body:JSON.stringify({exerciseId:t,sets:s.sets,reps:typeof s.reps=="number"?s.reps:10,weight:0})}),D([...M,{id:t,name:s.name,sets:s.sets,reps:s.reps,weight:0,primaryMuscles:s.primaryMuscles}]),E(s.name),setTimeout(()=>E(null),2e3);const l=X();m<l.length-1&&d(m+1)}catch{}},xs=()=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 text-white pb-24",children:[e.jsx("header",{className:"bg-gray-900/80 backdrop-blur-lg p-4 sticky top-0 z-10 border-b border-gray-700/30",children:e.jsxs("div",{className:"max-w-5xl mx-auto flex items-center justify-between",children:[e.jsxs(zs,{to:"/dashboard",className:"flex items-center gap-2 text-blue-400 hover:text-blue-300 transition-colors",children:[e.jsx("span",{children:"â†"}),e.jsx("img",{src:"/logo.png",alt:"MuscleMap",className:"w-6 h-6 rounded-md"})]}),e.jsx("h1",{className:"text-xl font-bold",children:"Start Workout"}),e.jsx("div",{})]})}),e.jsxs("main",{className:"max-w-lg mx-auto p-4 space-y-6",children:[ae&&e.jsx("div",{className:"bg-red-500/20 border border-red-500 rounded-xl p-4 text-red-200",children:ae}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm text-gray-400 uppercase mb-3",children:"How long do you have?"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:yt.map(s=>e.jsxs("button",{onClick:()=>P(s.value),className:`p-3 rounded-xl text-center transition-all ${I===s.value?"bg-purple-600 ring-2 ring-purple-400":"bg-gray-800 hover:bg-gray-700"}`,children:[e.jsx("div",{className:"font-bold",children:s.label}),e.jsx("div",{className:"text-xs text-gray-400",children:s.description})]},s.value))})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm text-gray-400 uppercase mb-3",children:"Where are you?"}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:Le.map(s=>e.jsxs("button",{onClick:()=>w(s.value),className:`p-3 rounded-xl text-center transition-all ${p===s.value?"bg-purple-600 ring-2 ring-purple-400":"bg-gray-800 hover:bg-gray-700"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:s.icon}),e.jsx("div",{className:"text-xs",children:s.label})]},s.value))})]}),e.jsxs("section",{children:[e.jsxs("h2",{className:"text-sm text-gray-400 uppercase mb-3",children:["Available at ",Le.find(s=>s.value===p)?.label||"Location"," (optional)"]}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-2 max-h-48 overflow-y-auto",children:rs.map(s=>e.jsxs("button",{onClick:()=>is(s.value),className:`p-3 rounded-xl text-center transition-all ${R.includes(s.value)?"bg-green-600 ring-2 ring-green-400":"bg-gray-800 hover:bg-gray-700"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:s.icon}),e.jsx("div",{className:"text-xs leading-tight",children:s.label})]},s.value))}),R.length===0&&e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"No equipment selected = bodyweight exercises"}),R.length>0&&e.jsxs("p",{className:"text-xs text-green-400 mt-2",children:[R.length," item",R.length>1?"s":""," selected"]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm text-gray-400 uppercase mb-3",children:"Your Goal"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Nt.map(s=>e.jsxs("button",{onClick:()=>os(s.value),className:`p-3 rounded-xl text-left transition-all ${A.includes(s.value)?"bg-blue-600 ring-2 ring-blue-400":"bg-gray-800 hover:bg-gray-700"}`,children:[e.jsx("span",{className:"text-xl mr-2",children:s.icon}),e.jsx("span",{className:"font-medium",children:s.label})]},s.value))})]}),e.jsx("button",{onClick:ns,disabled:xe,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 py-4 rounded-2xl font-bold text-lg transition-all disabled:opacity-50",children:xe?"Generating...":"Generate Workout"}),e.jsx("button",{onClick:()=>h("manual"),className:"w-full bg-gray-800 hover:bg-gray-700 py-3 rounded-xl text-gray-400 text-sm",children:"Or browse all exercises manually"})]})]}),gs=()=>{const s=X(),t=s[m],i=s.length>0?(m+1)/s.length*100:0;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 text-white pb-24",children:[te&&e.jsxs("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-50 bg-green-500 px-8 py-4 rounded-2xl font-bold animate-bounce",children:["Done: ",te]}),e.jsx("header",{className:"bg-gray-900/80 backdrop-blur-lg p-4 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("button",{onClick:()=>{h("select"),b(null)},className:"text-blue-400",children:"â† Exit"}),e.jsx("h1",{className:"text-xl font-bold",children:"Your Workout"}),e.jsxs("div",{className:"bg-green-600 px-3 py-1 rounded-full text-sm font-bold",children:[M.length,"/",s.length]})]}),e.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-emerald-400 transition-all duration-300",style:{width:`${i}%`}})})]})}),e.jsxs("main",{className:"max-w-lg mx-auto p-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl overflow-hidden mb-6 border border-white/5",children:[e.jsxs("button",{onClick:()=>x(!C),className:"w-full p-3 flex items-center justify-between text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:"ðŸ”¥"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:"Muscle Activation"}),e.jsxs("div",{className:"text-xs text-gray-400",children:[Ne.length," muscle groups worked"]})]})]}),e.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform ${C?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),C&&e.jsx("div",{className:"p-4 pt-0",children:e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase mb-2",children:"Current Exercise"}),e.jsx(qe,{muscles:ls,mode:"compact",interactive:!1,showLabels:!1,autoRotate:!1,className:"w-full",style:{height:140}}),t&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2 justify-center",children:t.primaryMuscles?.slice(0,3).map(l=>e.jsx("span",{className:"bg-purple-500/30 text-purple-200 px-2 py-0.5 rounded text-xs",children:l},l))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase mb-2",children:"Workout Total"}),e.jsx(qe,{muscles:Ne,mode:"compact",interactive:!1,showLabels:!1,autoRotate:!1,className:"w-full",style:{height:140}}),Ne.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2 justify-center",children:Ne.slice(0,3).map(l=>e.jsx("span",{className:"bg-green-500/30 text-green-200 px-2 py-0.5 rounded text-xs",children:l.id.replace(/_/g," ")},l.id))})]})]})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-400 mb-2",children:[e.jsxs("span",{children:[k?.actualDuration||I," min"]}),e.jsxs("span",{children:[Le.find(l=>l.value===p)?.icon," ",p]}),e.jsxs("span",{children:[s.length," exercises"]})]}),k?.muscleCoverage&&e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.keys(k.muscleCoverage).slice(0,6).map(l=>e.jsx("span",{className:"bg-gray-700 px-2 py-1 rounded text-xs",children:l},l))})]}),t&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-blue-600 rounded-3xl overflow-hidden mb-6 shadow-2xl",children:[t.id&&Vs(t.id)&&e.jsx("div",{className:"h-40 bg-black/20",children:e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-white/5 to-white/10 animate-pulse"}),children:e.jsx(bt,{exerciseId:t.id,exerciseName:t.name,primaryMuscles:t.primaryMuscles,size:"md",showMuscleLabels:!1,interactive:!1,className:"w-full h-full"})})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide opacity-70 mb-2",children:t.phase==="warmup"?"Warm-up":t.phase==="cooldown"?"Cool-down":`Exercise ${m+1-(k?.warmup?.length||0)}`}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:t.name}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:t.sets}),e.jsx("div",{className:"text-xs opacity-80",children:"Sets"})]}),e.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:t.reps}),e.jsx("div",{className:"text-xs opacity-80",children:"Reps"})]}),e.jsxs("div",{className:"bg-white/20 rounded-xl p-3 text-center",children:[e.jsxs("div",{className:"text-3xl font-bold",children:[t.restSeconds,"s"]}),e.jsx("div",{className:"text-xs opacity-80",children:"Rest"})]})]}),t.notes&&e.jsx("p",{className:"text-sm opacity-80 mb-4",children:t.notes}),e.jsx("div",{className:"flex gap-2 text-xs opacity-70 flex-wrap",children:t.primaryMuscles?.map(l=>e.jsx("span",{className:"bg-white/10 px-2 py-1 rounded",children:l},l))})]})]}),t&&e.jsx("div",{className:"mb-6",children:e.jsx(it,{exerciseId:t.exerciseId,delay:1500})}),t&&t.id&&!t.isActivity&&e.jsxs("div",{className:"mb-6 bg-gray-800/50 rounded-2xl p-4 border border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"Log Your Sets"}),e.jsx("button",{onClick:()=>ue(!0),className:"text-xs text-blue-400 hover:text-blue-300",children:"Swap Exercise"})]}),e.jsx(gt,{exerciseId:t.id,exerciseName:t.name,suggestedSets:t.sets||3,suggestedReps:typeof t.reps=="number"?t.reps:10,onSetLogged:l=>{D(f=>f.find(T=>T.id===t.id)?f.map(T=>T.id===t.id?{...T,sets:(T.sets||0)+1,tu:(T.tu||0)+(l.tu||0)}:T):[...f,{id:t.id,name:t.name,sets:1,reps:l.reps,weight:Math.round((l.weightKg||0)*2.205),tu:l.tu||0,primaryMuscles:t.primaryMuscles}])},onAllSetsComplete:()=>{const l=X();m<l.length-1&&d(m+1),E(`${t.name} completed!`),setTimeout(()=>E(null),2e3)},compact:!1})]}),t&&(t.isActivity||!t.id)&&e.jsxs("div",{className:"flex gap-3 mb-6",children:[e.jsx("button",{onClick:()=>m>0&&d(m-1),disabled:m===0,className:"flex-1 bg-gray-700 hover:bg-gray-600 disabled:opacity-50 py-4 rounded-xl font-bold",children:"Previous"}),e.jsx("button",{onClick:()=>ms(t),className:"flex-[2] bg-green-600 hover:bg-green-500 py-4 rounded-xl font-bold text-lg",children:"Done"}),e.jsx("button",{onClick:()=>m<s.length-1&&d(m+1),disabled:m===s.length-1,className:"flex-1 bg-gray-700 hover:bg-gray-600 disabled:opacity-50 py-4 rounded-xl font-bold",children:"Skip"})]}),t&&t.id&&!t.isActivity&&e.jsxs("div",{className:"flex gap-3 mb-6",children:[e.jsx("button",{onClick:()=>m>0&&d(m-1),disabled:m===0,className:"flex-1 bg-gray-700 hover:bg-gray-600 disabled:opacity-50 py-3 rounded-xl font-medium",children:"Previous"}),e.jsx("button",{onClick:()=>{M.some(j=>j.id===t.id)||D(j=>[...j,{id:t.id,name:t.name,sets:t.sets||3,reps:typeof t.reps=="number"?t.reps:10,weight:0,primaryMuscles:t.primaryMuscles}]),E(`${t.name} completed!`),setTimeout(()=>E(null),2e3);const f=X();m<f.length-1&&d(m+1)},className:"flex-[2] bg-green-600 hover:bg-green-500 py-3 rounded-xl font-bold",children:"Done"}),e.jsx("button",{onClick:()=>{const l=X();m<l.length-1&&d(m+1)},disabled:m===s.length-1,className:"flex-1 bg-gray-700 hover:bg-gray-600 disabled:opacity-50 py-3 rounded-xl font-medium",children:"Skip"})]}),M.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm text-gray-400 uppercase mb-3",children:"Completed"}),e.jsx("div",{className:"space-y-2",children:M.map((l,f)=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-3 flex items-center gap-3",children:[e.jsx("div",{className:"bg-green-600 w-8 h-8 rounded-full flex items-center justify-center text-sm",children:"âœ“"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:l.name}),e.jsxs("div",{className:"text-xs text-gray-400",children:[l.sets," x ",l.reps]})]})]},f))})]}),M.length>0&&e.jsx("button",{onClick:Be,disabled:oe,className:"w-full bg-gradient-to-r from-green-600 to-emerald-500 hover:from-green-500 hover:to-emerald-400 py-4 rounded-2xl font-bold text-lg transition-all",children:oe?"Completing...":`Complete Workout (${M.length} exercises)`}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-sm text-gray-400 uppercase mb-3",children:"All Exercises"}),e.jsx("div",{className:"space-y-2",children:s.map((l,f)=>{const j=M.some(re=>re.name===l.name),T=f===m;return e.jsxs("button",{onClick:()=>d(f),className:`w-full text-left rounded-xl p-3 flex items-center gap-3 transition-all ${T?"bg-purple-600":j?"bg-gray-800 opacity-60":"bg-gray-800 hover:bg-gray-700"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm ${j?"bg-green-600":T?"bg-white/20":"bg-gray-700"}`,children:j?"âœ“":f+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:l.name}),e.jsxs("div",{className:"text-xs text-gray-400",children:[l.sets," x ",l.reps," | ",l.phase]})]})]},f)})})]})]})]})},hs=()=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-gray-800 to-gray-900 text-white pb-24",children:[te&&e.jsxs("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-50 bg-green-500 px-8 py-4 rounded-2xl font-bold animate-bounce",children:[te,"!"]}),F&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-end justify-center",onClick:()=>ie(null),children:e.jsxs("div",{className:"bg-gray-800 rounded-t-3xl p-6 w-full max-w-lg",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("span",{className:"text-5xl",children:Ae(F)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:F.name}),e.jsx("p",{className:"text-gray-400",children:Ge(F)})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Sets"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[e.jsx("button",{onClick:()=>Q(Math.max(1,ee-1)),className:"bg-gray-700 w-10 h-10 rounded-full text-xl",children:"-"}),e.jsx("span",{className:"text-3xl font-bold w-12 text-center",children:ee}),e.jsx("button",{onClick:()=>Q(ee+1),className:"bg-gray-700 w-10 h-10 rounded-full text-xl",children:"+"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"Reps"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[e.jsx("button",{onClick:()=>ce(Math.max(1,B-1)),className:"bg-gray-700 w-10 h-10 rounded-full text-xl",children:"-"}),e.jsx("span",{className:"text-3xl font-bold w-12 text-center",children:B}),e.jsx("button",{onClick:()=>ce(B+1),className:"bg-gray-700 w-10 h-10 rounded-full text-xl",children:"+"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"text-sm text-gray-400",children:"lbs"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[e.jsx("button",{onClick:()=>se(Math.max(0,J-5)),className:"bg-gray-700 w-10 h-10 rounded-full text-xl",children:"-"}),e.jsx("span",{className:"text-3xl font-bold w-12 text-center",children:J}),e.jsx("button",{onClick:()=>se(J+5),className:"bg-gray-700 w-10 h-10 rounded-full text-xl",children:"+"})]})]})]}),e.jsx("button",{onClick:ds,className:"w-full bg-green-600 hover:bg-green-700 py-4 rounded-2xl font-bold text-lg",children:"Log Exercise"})]})}),e.jsx("header",{className:"bg-gray-900/80 backdrop-blur-lg p-4 sticky top-0 z-10 border-b border-gray-700/30",children:e.jsxs("div",{className:"max-w-5xl mx-auto flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>h("select"),className:"flex items-center gap-2 text-blue-400 hover:text-blue-300 transition-colors",children:[e.jsx("span",{children:"â†"}),e.jsx("img",{src:"/logo.png",alt:"MuscleMap",className:"w-6 h-6 rounded-md"})]}),e.jsx("h1",{className:"text-xl font-bold",children:"Browse Exercises"}),e.jsxs("div",{className:"bg-green-600 px-3 py-1 rounded-full text-sm font-bold",children:[M.length," logged"]})]})}),e.jsxs("main",{className:"max-w-5xl mx-auto p-4",children:[M.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-sm text-gray-400 mb-2 uppercase",children:"Today's Workout"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:M.map((s,t)=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:Ae(s)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-sm truncate",children:s.name}),e.jsxs("div",{className:"text-xs text-gray-400",children:[s.sets,"x",s.reps," ",s.weight>0?`${s.weight}lb`:""]})]})]},t))}),e.jsx("button",{onClick:Be,disabled:oe,className:"w-full bg-green-600 hover:bg-green-500 py-4 rounded-2xl font-bold text-lg mt-4 transition-all",children:oe?"Completing...":"Complete Workout"})]}),e.jsx("input",{type:"text",placeholder:"Search exercises...",value:Y,onChange:s=>H(s.target.value),className:"w-full bg-gray-800 rounded-2xl p-4 mb-4 text-lg"}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-4 mb-4",children:[e.jsx("button",{onClick:()=>U(null),className:`px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap ${ne?"bg-gray-700":"bg-purple-600"}`,children:"All"}),as.map(s=>e.jsxs("button",{onClick:()=>U(s.id),className:`px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap ${ne===s.id?"bg-purple-600":"bg-gray-700"}`,children:[s.icon," ",s.name]},s.id))]}),xe?e.jsx("div",{className:"text-center py-12 text-gray-400",children:"Loading exercises..."}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:cs.map(s=>{const t=[...(s.primary_muscles||[]).map(i=>({id:he(i),intensity:1,isPrimary:!0})),...(s.secondary_muscles||[]).slice(0,2).map(i=>({id:he(i),intensity:.5,isPrimary:!1}))];return e.jsxs("button",{onClick:()=>ie(s),className:`bg-gradient-to-br ${us(s).c} rounded-2xl p-3 text-left hover:scale-105 active:scale-95 transition-all shadow-lg relative`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("div",{className:"text-3xl",children:Ae(s)}),t.length>0&&e.jsx(Ys,{muscles:t,size:"xs",className:"opacity-90"})]}),e.jsx("div",{className:"font-bold text-sm truncate mt-1",children:s.name}),e.jsx("div",{className:"text-xs opacity-80",children:Ge(s)})]},s.id)})})]})]}),ps=()=>_&&e.jsx(dt,{workout:{duration:I,exerciseCount:_.exerciseCount||0,totalSets:_.totalSets||0,totalTU:_.tuEarned||0,exercises:_.exercises||[],goals:A},onClose:()=>{q(null),h("select"),b(null),D([]),y("/dashboard")}}),bs=async s=>{await v(s)&&ve&&(h("workout"),ge(!1))},fs=async s=>{await W(s),ye(t=>t.filter(i=>i.id!==s)),pe.length<=1&&ge(!1)},ys=s=>{const i=X()[m];if(k&&i){const l=f=>f.map(j=>j.id===i.id||j.exerciseId===i.exerciseId?{...j,id:s.id,exerciseId:s.id,name:s.name,primaryMuscles:s.primaryMuscles}:j);b({...k,warmup:k.warmup?l(k.warmup):void 0,exercises:k.exercises?l(k.exercises):void 0,cooldown:k.cooldown?l(k.cooldown):void 0})}ue(!1),E(`Switched to ${s.name}`),setTimeout(()=>E(null),2e3)};return e.jsxs(e.Fragment,{children:[ps(),o==="select"&&xs(),o==="workout"&&gs(),o==="manual"&&hs(),(o==="workout"||o==="manual")&&je&&e.jsx(Hs,{}),L&&m>=0&&e.jsx(ht,{exerciseId:X()[m]?.id||"",exerciseName:X()[m]?.name||"",availableEquipment:R,onSelect:ys,onCancel:()=>ue(!1)}),Ie&&pe.length>0&&e.jsx(pt,{sessions:pe,onRecover:bs,onDiscard:fs,onDismiss:()=>ge(!1)})]})}export{Xt as default};
