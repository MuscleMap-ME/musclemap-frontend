#!/bin/sh
# Pre-push hook for MuscleMap
#
# Runs more comprehensive checks before pushing to remote.
# These checks take longer but catch more issues.

# Skip in CI environments
if [ "$CI" = "true" ]; then
    exit 0
fi

echo "ðŸš€ Running pre-push checks..."

# Full TypeScript check
echo ""
echo "ðŸ“˜ Full TypeScript check..."
pnpm typecheck

# Run tests
echo ""
echo "ðŸ§ª Running tests..."
pnpm test:frontend 2>/dev/null || echo "Frontend tests skipped"

# Check for GraphQL breaking changes
echo ""
echo "ðŸ“¡ Checking GraphQL schema..."
if [ -f ./scripts/deployment/graphql-contract-check.ts ]; then
    npx tsx ./scripts/deployment/graphql-contract-check.ts 2>/dev/null || echo "GraphQL check skipped"
fi

echo ""
echo "âœ… Pre-push checks passed!"
